!function(a,b){function c(a,b){b||(b=a,a=null);var c=function(){return this.initialize&&this.initialize.apply(this,arguments)};if(a){var d=function(){};d.prototype=a.prototype,c.prototype=new d,c.prototype.superclass=a.prototype,c.prototype.constructor=c,c.prototype.super=function(b,c){if(!this.superclass.superclass||!this.superclass.superclass[b])return this.superclass[b].apply(this,c);var d=this.superclass;this.superclass=this.superclass.superclass;var e=d[b].apply(this,c);return this.superclass=a.prototype,e}}return Z(c.prototype,b),c}function d(a,b,c,d){c<0&&(c=-c,a-=c),d<0&&(d=-d,b-=d),this.x=this.x1=a,this.y=this.y1=b,this.w=this.width=c,this.h=this.height=d,this.x2=a+c,this.y2=b+d,this.cx=a+c/2,this.cy=b+d/2}function e(a){return function(b){return this.argument(a,b)}}function f(a,b){var c=a[b];return a=U.call(a,b+1),function(){this[c].apply(this,a)}}function g(a){return"[object Object]"===T.call(a)}function h(a){return Array.isArray(a)||a in R.corners}function i(a){return+a===a||a+""===a&&X.test(a)}function j(a){return a instanceof Image||g(a)&&V(a,"image")||a+""===a&&!(a.indexOf("http://")&&a.indexOf("https://")&&a.indexOf("./")&&a.indexOf("../")&&a.indexOf("data:image/")&&a.indexOf("<svg"))}function k(a){return+a===a?(a=R.distance(a),[a,a]):[R.distance(a[0]),R.distance(a[1])]}function l(a,c){if(a!==b){if(!a)return 0;if(R.snapToPixels&&!c)return Math.round(R.distance(a,!0)/R.snapToPixels)*R.snapToPixels;if(+a===a)return"px"!==R.unit?R.distance(a+""+R.unit):a;if(a+="",a.indexOf("px")===a.length-2)return parseInt(a);if(!R.units)if(S){var d=S.createElement("div");S.body.appendChild(d),R.units={},aa.forEach(function(a){d.style.width="1"+a,R.units[a]=parseFloat(getComputedStyle(d).width)}),S.body.removeChild(d)}else R.units=ba;var e=a.replace(/[\d\.]+?/g,"");return a=a.replace(/[^\d\.]+?/g,""),""===e?a:1===R.snapToPixels?Math.round(R.units[e]*a):R.units[e]*a}}function m(a,b){return ca||(ca=S.createElement("canvas")),ca.width=a,ca.height=b,ca}function n(a){Z(this,a)}function o(a){Z(this,a)}function p(a){var b=new o({});return a.forEach(function(a,c){b[a]={get:function(){return this.attrs.args[c]},set:function(a){this.attrs.args[c]=a,this.update()}}}),b}function q(a,b,c,d,e,f,g,h,i){var j=[c,d,a,b,g,h,e,f];return[j[2],j[3],j[2]+(j[4]-j[0])/(6*i),j[3]+(j[5]-j[1])/(6*i),j[4]-(j[6]-j[2])/(6*i),j[5]-(j[7]-j[3])/(6*i),j[4],j[5]]}function r(a){if(a<=1)return 1;a++;for(var b=1;--a;)b*=a;return b}function s(a,b){return r(b)/(r(a)*r(b-a))}function t(a,b){for(var c=a.length,d=c-1,e=0,f=1-b,g=0;e<c;e++)g+=s(e,d)*Math.pow(b,e)*Math.pow(f,d-e)*a[e];return g}function u(a,b,c,d){var e=b.x-a.x,f=b.y-a.y,g=Math.sqrt(e*e+f*f),h=f/g,i=e/g,j=h*c,k=i*c;return[{x:b.x+j,y:b.y+k*d},{x:b.x-j,y:b.y-k*d}]}function v(a){return["mozImageSmoothingEnabled","webkitImageSmoothingEnabled","msImageSmoothingEnabled","imageSmoothingEnabled"].forEach(function(b){b in a&&(ia=b)}),v=function(){return ia},ia}function w(a){if(this._dragging={downCoords:[a.contextX,a.contextY],downTime:Date.now(),bounds:this.bounds(),nativeBounds:this.bounds(!1),context:this.context},this._draggingOptions.cursor&&(this._dragging.oldCursor=this.context.canvas.style.cursor,this.context.canvas.style.cursor=this._draggingOptions.cursor),(this._draggingOptions.zIndex||0===this._draggingOptions.zIndex)&&(this._dragging.zIndexOld=this.attr("z"),this.attr("z",this._draggingOptions.zIndex)),this._draggingOptions.helper){if("clone"===this._draggingOptions.helper)this._dragging.helper=this.clone();else if(this._dragging.helper=this._draggingOptions.helper.clone(),this._draggingOptions.helperFixPosition){var b=this._dragging.helper.bounds();this._dragging.helperTranslation=[this._dragging.bounds.x-b.x,this._dragging.bounds.y-b.y]}this._draggingOptions.helperAttrs&&this._dragging.helper.attr(this._draggingOptions.helperAttrs),this._dragging.helper._meta=!0}this.fire("dragstart",a)}function x(a){this._dragging&&(this._dragging.oldCursor!==b&&(this.context.canvas.style.cursor=this._dragging.oldCursor,this._dragging.oldCursor=null),this._dragging.zIndexOld!==b&&this._draggingOptions.zIndexReturn&&(this.attr("z",this._dragging.zIndexOld),this._dragging.zIndexOld=null),this._dragging.helper&&(this.attr("translate",this._dragging.helper.attr("translate")),this._dragging.helper.remove(),this._dragging.helper=null,this._dragging.helperTranslation=null)),this._dragging=null,this.fire("dragend",a)}function y(a){var b=this._dragging;if(b){var c=b.context.contextCoords(a.clientX,a.clientY);event.contextX=c[0],event.contextY=c[1],c[0]-=b.nativeBounds.x,c[1]-=b.nativeBounds.y,this._draggingOptions.mods.forEach(function(b){c=oa[b].call(this,c[0],c[1],a)}.bind(this)),this.attr("translate",c),this.fire("drag",a)}}function z(a,b,c){for(var d=!1,e=0,f=c.length-1;e<c.length;f=e,e++)c[e][1]>b!=c[f][1]>b&&a<(c[f][0]-c[e][0])*(b-c[e][1])/(c[f][1]-c[e][1])+c[e][0]&&(d=!d);return d}function A(a,b,c,d,e,f,g,h){var i=(a-c)*(f-h)-(b-d)*(e-g);return 0===i?[]:[[((a*d-b*c)*(e-g)-(a-c)*(e*h-f*g))/i|0,((a*d-b*c)*(f-h)-(b-d)*(e*h-f*g))/i|0]]}function B(a,b,c,d,e,f,g,h){var i=(c-a)*(f-h)-(d-b)*(e-g);if(0===i)return[];var j=(e-a)*(f-h)-(f-b)*(e-g),k=(c-a)*(f-b)-(e-a)*(d-b);return j/=i,k/=i,j<0||j>1||k<0||k>1?[]:[[a+(c-a)*j,b+(d-b)*j,j,k]]}function C(a,b,c,d,e,f,g,h,i,j){Math.atan2(j-h,i-g)}function D(a,b,c,d,e,f){return a>c&&b>d&&a<e&&b<f}function E(a,b,c,d,e,f,g,h){return D(a,b,e,f,g,h)||D(a,d,e,f,g,h)||D(c,b,e,f,g,h)||D(c,d,e,f,g,h)||D(e,f,a,b,c,d)||D(g,f,a,b,c,d)||D(e,h,a,b,c,d)||D(g,h,a,b,c,d)}function F(a,b){var c;return a.reduce(function(d,e,f){return 0===f?d:(b.forEach(function(g,h){0!==h&&(c=B(a[f-1][0],a[f-1][1],e[0],e[1],b[h-1][0],b[h-1][1],g[0],g[1]),0!==c.length&&d.push(c))}),d)},[])}var G,H,I,J,K,L,M,N,O,P,Q,R={},S=a.document,T=Object.prototype.toString,U=Array.prototype.slice,V=Function.prototype.call.bind(Object.prototype.hasOwnProperty),W=/^\d*\.\d+$/,X=/^(\d+|(\d+)?\.\d+)(em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|px|pt|pc)?$/,Y=a.URL||a.webkitURL||a,Z=Object.assign?Object.assign:function(a,b){for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a},$=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","mousewheel","blur","focus","keypress","keydown","keyup","touchstart","touchmove","touchend","touchcancel","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture"],_=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){return a.setTimeout(b,1e3/60)};a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.mozCancelAnimationFrame||a.oCancelAnimationFrame||a.msCancelAnimationFrame||a.cancelRequestAnimationFrame||a.webkitCancelRequestAnimationFrame||a.mozCancelRequestAnimationFrame||a.oCancelRequestAnimationFrame||a.msCancelRequestAnimationFrame||a.clearTimeout;R.renderers={},c.attr=function(a,c){if(Array.isArray(a))return a.map(function(a){return this.attr(a)},this);if(a+""!==a)return Object.keys(a).forEach(function(b){this.attr(b,a[b])},this),this;if(1===arguments.length)return this.attrHooks[a]&&this.attrHooks[a].get?this.attrHooks[a].get.call(this):this.attrs[a];if(this.attrHooks[a]&&this.attrHooks[a].set){var d=this.attrHooks[a].set.call(this,c);null!==d&&(this.attrs[a]=d===b?c:d)}else this.attrs[a]=c;return this},R.bounds=function(a,b,c,e){return new d(a,b,c,e)},R.class=c,R.Bounds=d,R.extend=Z,R.argument=e,R.wrap=f,R.isObject=g,R.isNumberLike=i,R.isPatternLike=j,R.dashes={shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},R.fileTypes={jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",webp:"image/webp"},R.corners={left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],center:[.5,.5],"left top":[0,0],"top left":[0,0],"left bottom":[0,1],"bottom left":[0,1],"right top":[1,0],"top right":[1,0],"right bottom":[1,1],"bottom right":[1,1],lt:[0,0],tl:[0,0],lb:[0,1],bl:[0,1],rt:[1,0],tr:[1,0],rb:[1,1],br:[1,1]},R.colors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",chucknorris:"c00000",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R.coordsOfElement=function(b){var c=b.getBoundingClientRect(),d=a.getComputedStyle(b);return{x:c.left+parseInt(d.borderLeftWidth||0)+parseInt(d.paddingLeft||0),y:c.top+parseInt(d.borderTopWidth||0)+parseInt(d.paddingTop||0)}},R.clone=function(a){var b=new a.constructor;for(var c in a)V(a,c)&&("object"!=typeof a[c]||a[c]instanceof G||a[c]instanceof Image?b[c]=a[c]:b[c]=R.clone(a[c]));return b},R.transform=function(a,b){return[a[0]*b[0]+a[2]*b[1],a[1]*b[0]+a[3]*b[1],a[0]*b[2]+a[2]*b[3],a[1]*b[2]+a[3]*b[3],a[0]*b[4]+a[2]*b[5]+a[4],a[1]*b[4]+a[3]*b[5]+a[5]]},R.transformPoint=function(a,b){return[a[0]*b[0]+a[2]*b[1]+a[4],a[1]*b[0]+a[3]*b[1]+a[5]]},R.inverseTransform=function(a){var b=a[0]*a[3]-a[2]*a[1];return 0===b?null:[a[3]/b,-a[1]/b,-a[2]/b,a[0]/b,-(a[3]*a[4]-a[2]*a[5])/b,(a[1]*a[4]-a[0]*a[5])/b]},R.color=function(a){if(a!==b){if(Array.isArray(a))return a.slice(0,4);if(a+""!==a)throw"Not a color: "+a.toString();if(0===a.indexOf("rgb")){a=a.substring(a.indexOf("(")+1,a.length-1).replace(/\s/g,"").split(",");var c=a[3];return a=a.slice(0,3).map(function(a,b){return a.indexOf("%")>0?Math.round(2.55*parseInt(a)):parseInt(a)}),c===b&&(c=1),a.push(Number(c)),a}return"#"===a[0]?(a=a.substring(1),3===a.length&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16),1]):a in R.colors?R.color("#"+R.colors[a]):"rand"===a?[Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random()),1]:[0,0,0,0]}},R.angleUnit="grad",R.unit="px";var aa="pt em in cm mm pc ex ch rem v wvh vmin vmax".split(" "),ba={px:1,ch:8,cm:37.78125,em:16,ex:7.15625,in:96,mm:3.765625,pc:16,pt:1.328125,rem:16,v:16,vmax:13.65625,vmin:4.78125,wvh:16};R.snapToPixels=1,R.distance=l,R.renderers["2d"]={init:function(a,b){a.context=b.getContext("2d"),a._cache={}},preRedraw:function(a,b){a.save(),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,a.canvas.width,a.canvas.height),b.matrix&&a.setTransform.apply(a,b.matrix)},preDraw:function(a,b){a.save(),a.setTransform(1,0,0,1,0,0),b.matrix&&a.setTransform.apply(a,b.matrix)},postDraw:function(a){a.restore()},drawCircle:function(a,b,c,d,e){this.pre(b,c,d,e),b.beginPath(),b.arc(a[0],a[1],Math.abs(a[2]),0,2*Math.PI,!0),this.post(b,c)},drawRect:function(a,b,c,d,e){this.pre(b,c,d,e),c.fillStyle&&b.fillRect(a[0],a[1],a[2],a[3]),c.strokeStyle&&b.strokeRect(a[0],a[1],a[2],a[3]),b.restore()},drawPath:function(a,b,c,d,e){this.pre(b,c,d,e),(a[1]||a[2])&&b.translate(a[1]||0,a[2]||0),b.beginPath(),a[0].forEach(function(a){a.process(b)}),this.post(b,c)},drawImage:function(a,b,c,d,e){switch(this.pre(b,c,d,e),a.length){case 5:b.drawImage(a[0],a[1],a[2],a[3],a[4]);break;case 9:b.drawImage(a[0],a[5],a[6],a[7],a[8],a[1],a[2],a[3],a[4]);break;default:b.drawImage(a[0],a[1],a[2])}b.restore()},drawData:function(a,b,c,d,e){b.putImageData(a[0],a[1],a[2])},drawTextLines:function(a,b,c,d,e){this.pre(b,c,d,e);var f;f=c.fillStyle&&!c.strokeStyle?function(c){b.fillText(c.text,a[1],a[2]+c.y)}:c.fillStyle?function(c){b.fillText(c.text,a[1],a[2]+c.y),b.strokeText(c.text,a[1],a[2]+c.y)}:function(c){b.strokeText(c.text,a[1],a[2]+c.y)},a[0].forEach(f),b.restore()},drawText:function(a,b,c,d,e){this.pre(b,c,d,e),c.fillStyle&&!c.strokeStyle?b.fillText(a[0],a[1],a[2],a[3]):c.fillStyle?(b.fillText(a[0],a[1],a[2]),b.strokeText(a[0],a[1],a[2])):b.strokeText(a[0],a[1],a[2]),b.restore()},makeGradient:function(a,b,c,d,e){var f;if(a.useCache&&(f=this.hashGradient(b,c,d,e),a._cache[f]))return a._cache[f];var g;return g="linear"===b?a.context.createLinearGradient(c[0],c[1],d[0],d[1]):a.context.createRadialGradient(c[0],c[1],c[2],d[0],d[1],d[2]),Object.keys(e).forEach(function(a){g.addColorStop(a,e[a])}),a.useCache&&(a._cache[f]=g),g},hashGradient:function(a,b,c,d){var e;return d=JSON.stringify(d),e="linear"===a?b[0]===c[0]?["ver",b[1],c[1],d]:b[1]===c[1]?["hor",b[0],c[0],d]:[b[0],b[1],c[0],c[1],d]:[b[0],b[1],b[2],c[0],c[1],c[2],d],e.join(";")},pre:function(a,b,c,d){a.save(),Object.keys(b).forEach(function(c){a[c]=b[c]}),b.fillStyle&&b.fillStyle.toCanvasStyle&&(a.fillStyle=b.fillStyle.toCanvasStyle(a,d)),b.strokeStyle&&b.strokeStyle.toCanvasStyle&&(a.strokeStyle=b.strokeStyle.toCanvasStyle(a,d)),b.lineDash&&(a.setLineDash?a.setLineDash(b.lineDash):a.mozDash=b.lineDash),d.attrs.clip&&(d.attrs.clip.matrix?(a.save(),a.transform.apply(a,d.attrs.clip.matrix),d.attrs.clip.processPath(a),a.restore()):d.attrs.clip.processPath(a),a.clip()),c&&a.transform(c[0],c[1],c[2],c[3],c[4],c[5])},post:function(a,b){b.fillStyle&&a.fill(),b.strokeStyle&&a.stroke(),a.restore()},_currentMeasureContext:null,preMeasure:function(a){this._currentMeasureContext=m(1,1).getContext("2d"),this._currentMeasureContext.save(),this._currentMeasureContext.font=a},measure:function(a){return this._currentMeasureContext.measureText(a).width},postMeasure:function(){this._currentMeasureContext.restore(),this._currentMeasureContext=null}};var G;G=function(a){this.canvas=a,this.context=a.getContext("2d"),this.elements=[],this.listeners={},this._cache={},this.renderer=R.renderers["2d"],this.updateNowBounded=this.updateNow.bind(this)},G.prototype={object:function(a){return this.push(Z(new H,a))},rect:function(){return this.push(new J(arguments,this))},circle:function(){return this.push(new K(arguments,this))},path:function(){return this.push(new M(arguments,this))},image:function(){return this.push(new N(arguments,this))},text:function(){return this.push(new O(arguments,this))},line:function(a,b,c,d,e){return this.path([[a,b],[c,d]],null,e)},quadratic:function(a,b,c,d,e,f,g){return this.path([[a,b],[c,d,e,f]],null,g)},bezier:function(a,b,c,d,e,f,g,h,i){return this.path([[a,b],[c,d,e,f,g,h]],null,i)},arcTo:function(a,b,c,d,e,f,g){return this.path([[a,b],["arcTo",a,b,c,d,e,f]],null,g)},useCache:!1,gradient:function(a,b,c,d){return new P(a,b,c,d,this)},pattern:function(a,b){return new Q(a,b,this)},push:function(a){if(a.context=this,this.elements.push(a),a.draw){var b=this.context;b.save(),this.matrix?b.setTransform(this.matrix[0],this.matrix[1],this.matrix[2],this.matrix[3],this.matrix[4],this.matrix[5]):b.setTransform(1,0,0,1,0,0),a.draw(b),b.restore()}return a.update=a.updateFunction,a},update:function(){this._willUpdate||(this._willUpdate=!0,_(this.updateNowBounded))},updateNow:function(){var a=this.context;a.save(),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,a.canvas.width,a.canvas.height),this.matrix&&a.setTransform(this.matrix[0],this.matrix[1],this.matrix[2],this.matrix[3],this.matrix[4],this.matrix[5]),this.elements.forEach(function(b){b.draw(a)}),a.restore(),this._willUpdate=!1},getObjectInPoint:function(a,b,c){for(var d=this.elements,e=d.length;e--;)if(d[e].isPointIn&&(d[e].attrs.interaction||!c)&&d[e].isPointIn(a,b))return d[e];return null},each:function(a){if(a+""===a){var b=U.call(arguments,1),c=a;a=function(a){a[c].apply(a,b)}}return this.elements.slice().forEach(a,this),this},hoverElement:null,focusElement:null,listener:function(a){return this.listeners[a]?this.listeners[a]:(this.listeners[a]=[],this.eventsHooks[a]&&(this.eventsHooks[a].setup||this.eventsHooks[a]).call(this,a),this.listeners[a])},eventsInteract:$,eventsHooks:{mouseover:function(){this.listeners.mouseout||(this.listenerSpecial("mouseover","mouseout","hover","mousemove"),this.listener("mouseout"))},mouseout:function(){this.listeners.mouseover||(this.listenerSpecial("mouseover","mouseout","hover","mousemove"),this.listener("mouseover"))},focus:function(){this.listeners.blur||(this.listenerSpecial("focus","blur","focus","mousedown"),this.listener("blur"))},blur:function(){this.listeners.focus||(this.listenerSpecial("focus","blur","focus","mousedown"),this.listener("focus"))}},listenerSpecial:function(a,b,c,d){return c+="Element",this.on(d,function(d){var e=d.targetObject,f=this[c];f!=e&&(f&&f.fire&&(d.targetObject=f,f.fire(b,d)),e&&e.fire&&(d.targetObject=e,e.fire(a,d)),this[c]=e)}),this},listenerCanvas:function(a){this.canvas.addEventListener(a,function(b){var c=!0;if(b.cancelContextPropagation=function(){c=!1},"mouseout"===a){b.targetObject=this.hoverElement,this.hoverElement=null;var d=this.contextCoords(b.clientX,b.clientY);b.contextX=d[0],b.contextY=d[1],b.targetObject&&b.targetObject.fire&&(b.targetObject.fire("mouseout",b)||(b.stopPropagation(),b.preventDefault()))}else+b.clientX===b.clientX&&this._processPointParams(b,a,b),["touches","changedTouches","targetTouches"].forEach(function(c){b[c]&&Array.prototype.forEach.call(b[c],function(c){this._processPointParams(c,a,b)},this)},this);c&&!this.fire(a,b)&&(b.stopPropagation(),b.preventDefault())}.bind(this))},_processPointParams:function(a,b,c){var d=this.contextCoords(a.clientX,a.clientY);a.contextX=d[0],a.contextY=d[1],a.targetObject=this.getObjectInPoint(a.contextX,a.contextY,!0),a.targetObject&&a.targetObject.fire&&(a.targetObject.fire(b,c)||(c.stopPropagation(),c.preventDefault()))},on:function(a,b,c){return a+""!==a?(Object.keys(a).forEach(function(b){this.on(b,a[b])}),this):(c||(c=b,b=null),c.options=b,(this.listeners[a]||this.listener(a)).push(c),this)},off:function(a,b){return b||(this.listeners[a]=[]),this.listeners[a].splice(this.listeners[a].indexOf(b),1),this},fire:function(a,b){return this.listeners[a]?(this.listeners[a].forEach(function(a){a.call(this,b)},this),this):this},contextCoords:function(a,b){var c=R.coordsOfElement(this.canvas);return[a-c.x,b-c.y]},attr:c.attr,attrHooks:{transform:{get:function(){return this.attrs.transform,this.attrs.transform||[1,0,0,1,0,0]},set:function(a){this.update()}}},matrix:null,transform:function(a,b,c,d,e,f,g){return null===a?(this.matrix=null,this.update()):(g&&(g+""===g&&(g=R.corners[g],g=[g[0]*this.canvas.width,g[1]*this.canvas.height]),e=e-a*g[0]+g[0]-c*g[1],f=f-b*g[0]-d*g[1]+g[1]),this.matrix=R.transform(this.matrix||[1,0,0,1,0,0],[a,b,c,d,e,f]),this.update())},translate:function(a,b){return this.transform(1,0,0,1,a,b)},rotate:function(a,b){return a=a/180*Math.PI,this.transform(Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a),0,0,b)},scale:function(a,c,d){return(c===b||h(c))&&(d=c,c=a),this.transform(a,0,0,c,0,0,d)},skew:function(a,c,d){return(c===b||h(c))&&(d=c,c=a),this.transform(1,Math.tan(c*Math.PI/180),Math.tan(a*Math.PI/180),1,0,0,d)}},$.forEach(function(a){G.prototype.eventsHooks[a]=function(){this.listenerCanvas(a)},G.prototype[a]=function(b){return this["function"==typeof b||b+""===b?"on":"fire"].apply(this,[a].concat(U.call(arguments)))}}),R.Context=G,R.contexts={"2d":G},R.Math={};var ca;H=new c({initialize:function(a){this.listeners={},this.styles={},this.attrs={interaction:!0,visible:!0}},updateFunction:function(){return this.context&&this.context.update(),this},update:function(){return this},clone:function(a,b,c){var d=new this.constructor([],this.context);return d.attrs=!1===a?this.attrs:Z({},this.attrs),!1===b?(d.styles=this.styles,d.matrix=this.matrix):(d.styles=Z({},this.styles),this.matrix&&(d.matrix=this.matrix.slice())),d.listeners=!1===c?this.listeners:Z({},this.listeners),this.context.push(d)},remove:function(){return this.context.elements.splice(this.context.elements.indexOf(this),1),this.update(),this.context=null,this},attr:c.attr,attrHooks:n.prototype={z:{get:function(){return this.context.elements.indexOf(this)},set:function(a){var b=this.context.elements;"top"===a&&(a=b.length),b.splice(this.context.elements.indexOf(this),1),b.splice(a,0,this),this.update()}},visible:{set:function(){this.update()}},fill:{get:function(){return this.styles.fillStyle},set:function(a){this.styles.fillStyle=a,this.update()}},stroke:{set:function(a){H.processStroke(a,this.styles),this.update()}},shadow:{set:function(a){H.processShadow(a,this.styles),this.update()}},opacity:{get:function(){return this.styles.globalAlpha!==b?this.styles.globalAlpha:1},set:function(a){this.styles.globalAlpha=+a,this.update()}},composite:{get:function(){return this.styles.globalCompositeOperation},set:function(a){this.styles.globalCompositeOperation=a,this.update()}},clip:{set:function(a){a.context=this.context,this.attrs.clip=a,this.update()}},cursor:{set:function(a){}},transform:{get:function(){return this.attrs.transform||[1,0,0,1,0,0]},set:function(){this.update()}},translate:{get:function(){return this.attrs.translate||[0,0]},set:function(a){return a=k(a),this.attrs.translate=a,this.genMatrix(),this.update(),a}},rotate:{get:function(){return this.attrs.rotate||0},set:function(a){this.attrs.rotate=a,this.genMatrix(),this.update()}},skew:{get:function(){return this.attrs.skew||[0,0]},set:function(a){return a=k(a),this.attrs.skew=a,this.genMatrix(),this.update(),a}},scale:{get:function(){return this.attrs.scale||[1,1]},set:function(a){return a=k(a),this.attrs.scale=a,this.genMatrix(),this.update(),a}}},genMatrix:function(){},processObject:function(a,b){return V(a,"opacity")&&(this.styles.globalAlpha=a.opacity),V(a,"composite")&&(this.styles.globalCompositeOperation=a.composite),V(a,"clip")&&(a.clip.context=this.context,this.attrs.clip=a.clip),V(a,"visible")&&(a.attrs.visible=a.visible),V(a,"interaction")&&(a.attrs.interaction=a.interaction),b.map(function(b){return a[b]})},isPointIn:function(a,b){if(this.matrix){var c=R.inverseTransform(this.matrix);return R.transformPoint(c,[a,b])}return[a,b]},bounds:function(a,b,c){if(("fill"===c||!c)&&this.styles.strokeStyle){var e=(this.styles.lineWidth||1)/2;"strokeExclude"===c&&(e=-e),a[0]-=e,a[1]-=e,a[2]+=2*e,a[3]+=2*e}if(!1!==b&&this.matrix){var f=[R.transformPoint(this.matrix,[a[0],a[1]]),R.transformPoint(this.matrix,[a[0]+a[2],a[1]]),R.transformPoint(this.matrix,[a[0],a[1]+a[3]]),R.transformPoint(this.matrix,[a[0]+a[2],a[1]+a[3]])];if("tight"===b)return f;a[0]=Math.min(f[0][0],f[1][0],f[2][0],f[3][0]),a[1]=Math.min(f[0][1],f[1][1],f[2][1],f[3][1]),a[2]=Math.max(f[0][0],f[1][0],f[2][0],f[3][0])-a[0],a[3]=Math.max(f[0][1],f[1][1],f[2][1],f[3][1])-a[1]}return new d(a[0],a[1],a[2],a[3])},corner:function(a,b){return Array.isArray(a)?a:(b=b instanceof d?b:this.bounds(b),[b.x+b.w*R.corners[a][0],b.y+b.h*R.corners[a][1]])},on:function(a,b){if(a+""!==a)for(var c in a)V(a,c)&&this.on(c,a[c]);return b+""===b&&(b=f(arguments)),this.context.listener(a),(this.listeners[a]||(this.listeners[a]=[])).push(b),this},off:function(a,b){return a?b?(this.listeners[a].splice(this.listeners[a].indexOf(b),1),this):(this.listeners[a]=null,this):(this.listeners={},this)},fire:function(a,b){return(this.listeners[a]||[]).forEach(function(a){a.call(this,b)},this),this},preDraw:function(a){a.save();var b=this.styles;Object.keys(b).forEach(function(c){a[c]=b[c]}),b.fillStyle&&b.fillStyle.toCanvasStyle&&(a.fillStyle=b.fillStyle.toCanvasStyle(a,object)),b.strokeStyle&&b.strokeStyle.toCanvasStyle&&(a.strokeStyle=b.strokeStyle.toCanvasStyle(a,object)),b.lineDash&&(a.setLineDash?a.setLineDash(b.lineDash):a.mozDash=b.lineDash),this.attrs.clip&&(this.attrs.clip.matrix?(a.save(),a.transform.apply(a,this.attrs.clip.matrix),this.attrs.clip.processPath(a),a.restore()):this.attrs.clip.processPath(a),a.clip()),this.matrix&&a.transform(this.matrix[0],this.matrix[1],this.matrix[2],this.matrix[3],this.matrix[4],this.matrix[5])},postDraw:function(a){var b=this.styles;b.fillStyle&&a.fill(),b.strokeStyle&&a.stroke(),a.restore()},transform:function(a,b,c,d,e,f,g){return null===a?this.matrix=null:(g&&(g=this.corner(g,{transform:"ignore"}),e=g[0]+e-a*g[0]-c*g[1],f=g[1]+f-b*g[0]-d*g[1]),this.matrix=R.transform(this.matrix||[1,0,0,1,0,0],[a,b,c,d,e,f])),this.update()},translate:function(a,b){return this.transform(1,0,0,1,a,b)},rotate:function(a,b){return a=a/180*Math.PI,this.transform(Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a),0,0,b||"center")},scale:function(a,c,d){return c===b&&(c=a),this.transform(a,0,0,c,0,0,d||"center")},skew:function(a,c,d){return c===b&&(c=a),a=a/180*Math.PI,c=c/180*Math.PI,this.transform(1,Math.tan(c),Math.tan(a),1,0,0,d||"center")},toDataURL:function(a,c){if(c===b){if("function"!=typeof this.bounds)throw"Object #"+this.attr("z")+" can't be rasterized: need the bounds.";c=this.bounds()}a===b?a="image/png":a in R.fileTypes&&(a=R.fileTypes[a]);var d=m(c.width,c.height),e=d.getContext("2d");return e.setTransform(1,0,0,1,-c.x,-c.y),this.draw(e),d.toDataURL(a.type||a,a.quality||1)},toBlob:function(a,b,c,d){},toImageData:function(a){if(a===b){if("function"!=typeof this.bounds)throw"Object #"+this.z()+" can't be rasterized: need the bounds.";a=this.bounds()}var c=m(a.width,a.height),d=c.getContext("2d");return d.setTransform(1,0,0,1,-a.x,-a.y),this.draw(d),d.getImageData(0,0,a.width,a.height)},animate:function(a,c,d){if(a+""!==a)return d=+c!==c&&c?"function"==typeof c?{callback:c}:c:{duration:c,easing:d,callback:arguments[3]},Object.keys(a).forEach(function(b,c){this.animate(b,a[b],d),0===c&&(d.queue=!1,d.callback=null)},this),this;if(!this.attrHooks[a]||!this.attrHooks[a].anim)throw'Animation for "'+a+'" is not supported';+d!==d&&d?"function"==typeof d&&(d={callback:d}):d={duration:d,callback:arguments[4],easing:arguments[3]};var e=new I(d.duration,d.easing,d.callback);e.prop=a,e.tick=this.attrHooks[a].anim,e.tickContext=this,e.prePlay=function(){this.fx=e,this.attrHooks[a].preAnim.call(this,e,c)}.bind(this),e.elem=this,d.name&&(e.name=d.name);var f=d.queue;return!1!==f&&(!0===f||f===b?(this._queue||(this._queue=[]),f=this._queue):f instanceof H&&(f=f._queue),e.queue=f,f.push(e),f.length>1)?this:(e.play(),this)},pause:function(a){return this._paused||(this._paused=[]),I.queue.slice().forEach(function(b){b.elem!==this||a&&b.name!==a||(b.pause(),this._paused.push(b))},this),this},continue:function(a){if(this._paused)return this._paused.slice().forEach(function(b,c){a&&b.name!==a||(b.continue(),this._paused.splice(c,1))},this),this}}),H.processStroke=function(a,c){if(a+""===a){a=a.replace(/\s*\,\s*/g,",").split(" ");for(var d,e=a.length,f=!1,g=!1;e--;)W.test(a[e])?d=parseFloat(a[e]):i(a[e])?c.lineWidth=R.distance(a[e]):"round"===a[e]?(f||(c.lineJoin="round"),g||(c.lineCap=c.lineCap||"round")):"miter"===a[e]||"bevel"===a[e]?(f=!0,c.lineJoin=a[e]):"butt"===a[e]||"square"===a[e]?(g=!0,c.lineCap=a[e]):"["===a[e][0]?c.lineDash=a[e].substr(1,a[e].length-2).split(","):a[e]in R.dashes?c.lineDash=R.dashes[a[e]]:c.strokeStyle=a[e];d&&(a=R.color(c.strokeStyle),a[3]=d,c.strokeStyle="rgba("+a.join(",")+")")}else{if(a.color!==b&&(c.strokeStyle=a.color),a.opacity!==b&&c.strokeStyle){var h=R.color(c.strokeStyle);h[3]=a.opacity,c.strokeStyle="rgba("+h.join(",")+")"}a.width!==b&&(c.lineWidth=R.distance(a.width)),a.join!==b&&(c.lineJoin=a.join),a.cap!==b&&(c.lineCap=a.cap),a.dash!==b&&(a.dash in R.dashes?c.lineDash=R.dashes[a.dash]:c.lineDash=a.dash)}},H.processShadow=function(a,c){if(a+""===a){var d=["shadowOffsetX","shadowOffsetY","shadowBlur"];a=a.replace(/\s*\,\s*/g,",").split(" ");for(var e=0;e<a.length;e++)isNaN(+a[e][0])?c.shadowColor=a[e]:c[d.shift()]=R.distance(a[e])}else a.x!==b&&(c.shadowOffsetX=R.distance(a.x)),a.y!==b&&(c.shadowOffsetY=R.distance(a.y)),a.blur!==b&&(c.shadowBlur=R.distance(a.blur||0)),a.color&&(c.shadowColor=a.color)},R.Drawable=H,$.forEach(function(a){H.prototype[a]=G.prototype[a]}),I=new c({initialize:function(a,b,c){this.duration=a||I.default.duration,b+""===b?(b.indexOf("(")>-1&&(this.easingParam=+b.split("(")[1].split(")")[0]),this.easing=I.easing[b.split("(")[0]]):this.easing=b||I.easing.default,this.callback=c},play:function(a,b){this.prePlay&&this.prePlay(),a&&(this.tick=a),b&&(this.tickContext=b),this.startTime=Date.now(),this.endTime=this.startTime+this.duration,I.queue.length||_(I.do),I.queue.push(this)},pause:function(){this.pauseTime=Date.now(),I.queue.splice(I.queue.indexOf(this),1)},continue:function(){var a=this.pauseTime-this.startTime;this.startTime=Date.now()-a,this.endTime=this.startTime+this.duration,I.queue.length||_(I.do),I.queue.push(this)}}),I.queue=[],I.do=function(){for(var a,b,c=Date.now(),d=0;d<I.queue.length;d++)a=I.queue[d],(b=(c-a.startTime)/a.duration)<0||(b>1&&(b=1),a.now=c,a.pos=a.easing(b,a.easingParam),a.tick.call(a.tickContext,a),1===b&&(a.callback&&a.callback.call(a.tickContext,a),a.queue&&(a.queue.shift(),a.queue.length&&a.queue[0].play()),I.queue.splice(I.queue.indexOf(a),1)));I.queue.length&&_(I.do)},H.prototype.attrHooks._num={preAnim:function(a,b){a.startValue=this.attr(a.prop),a.delta=b-a.startValue,b+""===b&&(0===b.indexOf("+=")?a.delta=+b.substr(2):0===b.indexOf("-=")&&(a.delta=-b.substr(2)))},anim:function(a){this.attrs[a.prop]=a.startValue+a.delta*a.pos,this.update()}},H.prototype.attrHooks._numAttr={preAnim:H.prototype.attrHooks._num.preAnim,anim:function(a){this.attr(a.prop,a.startValue+a.delta*a.pos)}},I.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},sqrt:function(a){return Math.sqrt(a)},pow:function(a,b){return Math.pow(a,b||6)},expo:function(a,b){return Math.pow(b||2,8*a-8)},circ:function(a){return 1-Math.sin(Math.acos(a))},sine:function(a){return 1-Math.cos(a*Math.PI/2)},back:function(a,b){return Math.pow(a,2)*((b||1.618)*(a-1)+a)},bounce:function(a){for(var b=0,c=1;1;b+=c,c/=2)if(a>=(7-4*b)/11)return c*c-Math.pow((11-6*b-11*a)/4,2)},elastic:function(a,b){
return Math.pow(2,10*--a)*Math.cos(20*a*Math.PI*(b||1)/3)}},I.easing.default=I.easing.swing,["quad","cubic","quart","quint"].forEach(function(a,b){I.easing[a]=function(a){return Math.pow(a,b+2)}}),Object.keys(I.easing).forEach(function(a){I.easing[a+"In"]=I.easing[a],I.easing[a+"Out"]=function(b,c){return 1-I.easing[a](1-b,c)},I.easing[a+"InOut"]=function(b,c){return b>=.5?I.easing[a](2*b,c)/2:(2-I.easing[a](2*(1-b),c))/2}}),I.default={duration:500},R.animation=function(a,b,c){return new I(a,b,c)},J=new c(H,{initialize:function(a,b){this.super("initialize",arguments),g(a[0])&&(a=this.processObject(a[0],J.args)),this.attrs.x=a[0],this.attrs.y=a[1],this.attrs.width=a[2],this.attrs.height=a[3],a[4]&&(this.styles.fillStyle=a[4]),a[5]&&(this.attrs.stroke=a[5],H.processStroke(a[5],this.styles))},attrHooks:new n({x:{set:function(a){this.update()}},y:{set:function(a){this.update()}},width:{set:function(a){this.update()}},height:{set:function(a){this.update()}},x1:{get:function(){return this.attrs.x},set:function(a){return this.attrs.width+=this.attrs.x-a,this.attrs.x=a,this.update(),null}},y1:{get:function(){return this.attrs.y},set:function(a){return this.attrs.height+=this.attrs.y-a,this.attrs.y=a,this.update(),null}},x2:{get:function(){return this.attrs.x+this.attrs.width},set:function(a){return this.attrs.width=a-this.attrs.x,this.update(),null}},y2:{get:function(){return this.attrs.y+this.attrs.height},set:function(a){return this.attrs.height=a-this.attrs.y,this.update(),null}}}),isPointIn:function(a,b){var c=this.super("isPointIn",[a,b]);return a=c[0],b=c[1],a>this.attrs.x&&b>this.attrs.y&&a<this.attrs.x+this.attrs.width&&b<this.attrs.y+this.attrs.height},bounds:function(a,b){return this.super("bounds",[[this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height],a,b])},draw:function(a){this.attrs.visible&&(this.context.renderer.pre(a,this.styles,this.matrix,this),this.styles.fillStyle&&a.fillRect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height),this.styles.strokeStyle&&a.strokeRect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height),a.restore())},processPath:function(a){a.beginPath(),a.rect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height)}}),J.args=["x","y","width","height","fill","stroke"],["x","y","width","height","x1","x2","y1","y2"].forEach(function(a,b){var c=H.prototype.attrHooks[b>3?"_numAttr":"_num"];J.prototype.attrHooks[a].preAnim=c.preAnim,J.prototype.attrHooks[a].anim=c.anim}),R.rect=function(){return new J(arguments)},R.Rect=J,K=new c(H,{initialize:function(a,b){this.super("initialize",arguments),g(a[0])&&(a=this.processObject(a[0],K.args)),this.attrs.cx=a[0],this.attrs.cy=a[1],this.attrs.radius=a[2],a[3]&&(this.styles.fillStyle=a[3]),a[4]&&(this.attrs.stroke=a[4],H.processStroke(a[4],this.styles))},attrHooks:new n({cx:{set:function(a){this.update()}},cy:{set:function(a){this.update()}},radius:{set:function(a){this.update()}}}),isPointIn:function(a,b){var c=this.super("isPointIn",[a,b]);return a=c[0],b=c[1],Math.pow(a-this.attrs.cx,2)+Math.pow(b-this.attrs.cy,2)<=Math.pow(this.attrs.radius,2)},bounds:function(a,b){return this.super("bounds",[[this.attrs.cx-this.attrs.radius,this.attrs.cy-this.attrs.radius,2*this.attrs.radius,2*this.attrs.radius],a,b])},draw:function(a){this.attrs.visible&&(this.preDraw(a),a.beginPath(),a.arc(this.attrs.cx,this.attrs.cy,Math.abs(this.attrs.radius),0,2*Math.PI,!0),this.postDraw(a))},processPath:function(a){a.beginPath(),a.arc(this.attrs.cx,this.attrs.cy,Math.abs(this.attrs.radius),0,2*Math.PI,!0)}}),K.args=["cx","cy","radius","fill","stroke"],["cx","cy","radius"].forEach(function(a){K.prototype.attrHooks[a].preAnim=H.prototype.attrHooks._num.preAnim,K.prototype.attrHooks[a].anim=H.prototype.attrHooks._num.anim}),R.circle=function(){return new K(arguments)},R.Circle=K,L=new c({initialize:function(a,b,c){this.method=a,this.path=c,this.attrs={},this.attrs.args=b,L.canvasFunctions[a]&&(this.attrHooks=L.canvasFunctions[a].attrHooks)},attrHooks:o.prototype={args:{set:function(){this.update()}}},attr:c.attr,clone:function(){var a=R.curve(this.method,this.attrs.args);return Z(a.attrs,this.attrs),a},startAt:function(){var a=this.path.attrs.d.indexOf(this);return 0===a?[0,0]:this.path.attrs.d[a-1].endAt()},endAt:function(){return L.canvasFunctions[this.method].endAt?L.canvasFunctions[this.method].endAt(this.attrs.args):null},update:function(){return this.path&&this.path.update(),this},bounds:function(a){return L.canvasFunctions[this.method].bounds?(a||(a=this.startAt()),L.canvasFunctions[this.method].bounds(a,this.attrs.args)):null},process:function(a){a[this.method].apply(a,this.attrs.args)}}),L.canvasFunctions={moveTo:{attrHooks:p(["x","y"]),endAt:function(a){return a.slice()}},lineTo:{attrHooks:p(["x","y"]),bounds:function(a,b){return[a[0],a[1],b[0],b[1]]},endAt:function(a){return a.slice()}},quadraticCurveTo:{attrHooks:p(["hx","hy","x","y"]),bounds:function(a,b){return[Math.min(a[0],b[0],b[2]),Math.min(a[1],b[1],b[3]),Math.max(a[0],b[0],b[2]),Math.max(a[1],b[1],b[3])]},endAt:function(a){return a.slice(2)}},bezierCurveTo:{attrHooks:p(["h1x","h1y","h2x","h2y","x","y"]),bounds:function(a,b){return[Math.min(a[0],b[0],b[2],b[4]),Math.min(a[1],b[1],b[3],b[5]),Math.max(a[0],b[0],b[2],b[4]),Math.max(a[1],b[1],b[3],b[5])]},endAt:function(a){return a.slice(4)}},arc:{attrHooks:p(["x","y","radius","start","end","clockwise"]),bounds:function(a,b){var c=b[0],d=b[1],e=b[2];b[3],b[4],b[5];return[c-e,d-e,c+e,d+e]},endAt:function(a){var b=a[0],c=a[1],d=a[2],e=a[4]-a[3];return a[5]&&(e=-e),[b+Math.cos(e)*d,c+Math.sin(e)*d]}},arcTo:{attrHooks:p(["x1","y1","x2","y2","radius","clockwise"])}},L.fromArray=function(a,b){return!0===a?closePath:a[0]in R.curves?R.curve(a[0],a.slice(1),b):new L({2:"lineTo",4:"quadraticCurveTo",6:"bezierCurveTo"}[a.length],a,b)},R.curves={moveTo:L,lineTo:L,quadraticCurveTo:L,bezierCurveTo:L,arc:L,arcTo:L,closePath:L},R.Curve=L,R.curve=function(a,b,c){return new R.curves[a](a,b,c)},L.epsilon=1e-4,L.detail=10,Z(L.prototype,{before:function(){if(!this.path)return null;var a=this.path.attr("d"),b=a.indexOf(this);return b<1?null:a[b-1]}}),Z(L.prototype,{tangentAt:function(a,b,c){if(L.canvasFunctions[this.method]&&L.canvasFunctions[this.method].tangentAt)return L.canvasFunctions[this.method].tangentAt(this,c);b||(b=L.epsilon);var d=a-b,e=a+b;d<0&&(d=0),e>1&&(e=1);var f=this.pointAt(d,c),g=this.pointAt(e,c);return 180*Math.atan2(g[1]-f[1],g[0]-f[0])/Math.PI},normalAt:function(a,b,c){return this.tangentAt(a,b,c)-90},flatten:function(a,b){},approx:function(a,b,c){for(var d=this.startAt(),e=d,f=1;f<=a;f++)c=b(c,e,e=this.pointAt(f/a,d),f);return c},length:function(a,b){if(L.canvasFunctions[this.method]&&L.canvasFunctions[this.method].length)return L.canvasFunctions[this.method].length(this,b);a||(a=L.detail);for(var c,d=0,e=b||this.startAt(),f=1;f<=a;f++)c=this.pointAt(f/a),d+=Math.sqrt(Math.pow(c[1]-e[1],2)+Math.pow(c[0]-e[0],2)),e=c;return d},nearest:function(a,b,c,d){if(L.canvasFunctions[this.method]&&L.canvasFunctions[this.method].nearest)return L.canvasFunctions[this.method].nearest(this,d);c||(c=L.detail),d||(d=this.startAt());for(var e,f,g,h,i=1/0,j=0;j<=c;j++)e=this.pointAt(j/c,d),(h=Math.sqrt(Math.pow(e[0]-a,2)+Math.pow(e[1]-b,2)))<i&&(f=e,g=j,i=h);return{point:f,t:g/c,distance:i}},bounds:function(a,b){if(a||(a=this.startAt()),L.canvasFunctions[this.method].bounds)return L.canvasFunctions[this.method].bounds(a,this.attrs.args);b||(b=L.detail);for(var c,d=1/0,e=1/0,f=-1/0,g=-1/0,h=0;h<=b;h++)c=this.pointAt(h/b,a),d>c[0]&&(d=c[0]),e>c[1]&&(e=c[1]),f<c[0]&&(f=c[0]),g<c[1]&&(g=c[1]);return[d,e,f,g]},intersections:function(a){}}),Z(L.prototype,{pointAt:function(a,b){var c=L.canvasFunctions[this.method];if(c&&c.pointAt)return c.pointAt(this,a,b);throw'The method "pointAt" is not supported for "'+this.method+'" curves'},splitAt:function(a,b){var c=L.canvasFunctions[this.method];if(c&&c.splitAt)return c.splitAt(this,a,b);throw'The method "splitAt" is not supported for "'+this.method+'" curves'}}),Z(L.canvasFunctions.moveTo,{pointAt:function(a,b,c){return a.attrs.args},length:function(){return 0}}),Z(L.canvasFunctions.lineTo,{pointAt:function(a,b,c){return c||(c=a.startAt()),[c[0]+b*(a.attrs.args[0]-c[0]),c[1]+b*(a.attrs.args[1]-c[1])]},tangentAt:function(a){},splitAt:function(a,b,c){c||(c=a.startAt());var d=L.canvasFunctions.lineTo.pointAt(a,b,c);return{start:[c,d],end:[d,[a.attrs.args[0],a.attrs.args[1]]]}},length:function(a,b){b||(b=a.startAt());var c=a.attrs.args[0]-b[0],d=a.attrs.args[1]-b[1];return Math.sqrt(c*c+d*d)}}),Z(L.canvasFunctions.quadraticCurveTo,{pointAt:function(){},tangentAt:function(){},splitAt:function(){},length:function(a,b){function c(a){return console.log(2*n*a+o),(2*n*a+o)*Math.sqrt(a*(n*a+o)+p)/(4*n)-(o*o-4*n*p)*Math.log(2*Math.sqrt(n)*Math.sqrt(a*(n*a+o)+p)+2*n*a+o)/(8*Math.pow(n,1.5))}b||(b=a.startAt());var d=b[0],e=b[1],f=a.attrs.args[0],g=a.attrs.args[1],h=a.attrs.args[2],i=a.attrs.args[3],j=f-d,k=g-e,l=h-f,m=i-g,n=Math.pow(j-l,2)+Math.pow(k-m,2),o=2*(j*(l-j)+k*(m-k)),p=j*j+k*k;return c(1)-c(0)},bounds:function(a,b){var c,d,e=a[0],f=a[1],g=b[0],h=b[1],i=b[2],j=b[3],k=(e-g)/(i-2*g+e),l=(f-h)/(j-2*h+f);return k>=0&&k<=1&&(c=[Math.pow(1-k,2)*e+2*(1-k)*k*g+k*k*i,Math.pow(1-k,2)*f+2*(1-k)*k*h+k*k*j]),l>=0&&l<=1&&(d=[Math.pow(1-l,2)*e+2*(1-l)*l*g+l*l*i,Math.pow(1-l,2)*f+2*(1-l)*l*h+l*l*j]),[Math.min(e,i,c?c[0]:1/0,d?d[0]:1/0),Math.min(f,j,c?c[1]:1/0,d?d[1]:1/0),Math.max(e,i,c?c[0]:-1/0,d?d[0]:-1/0),Math.max(f,j,c?c[1]:-1/0,d?d[1]:-1/0)]}}),Z(L.canvasFunctions.bezierCurveTo,{bounds:function(a,b){function c(a){return a>=0&&a<=1&&[Math.pow(1-a,3)*h+3*Math.pow(1-a,2)*a*j+3*(1-a)*a*a*l+a*a*a*n,Math.pow(1-a,3)*i+3*Math.pow(1-a,2)*a*k+3*(1-a)*a*a*m+a*a*a*o]}var d,e,f,g,h=a[0],i=a[1],j=b[0],k=b[1],l=b[2],m=b[3],n=b[4],o=b[5],p=3*(3*j-h-3*l+n),q=3*(3*k-i-3*m+o),r=6*(h-2*j+l),s=6*(i-2*k+m),t=3*(j-h),u=3*(k-i),v=Math.sqrt(r*r-4*p*t),w=Math.sqrt(s*s-4*q*u);return d=c((-r+v)/(2*p)),e=c((-r-v)/(2*p)),f=c((-s+w)/(2*q)),g=c((-s-w)/(2*q)),[Math.min(h,n,d?d[0]:1/0,e?e[0]:1/0,f?f[0]:1/0,g?g[0]:1/0),Math.min(i,o,d?d[1]:1/0,e?e[1]:1/0,f?f[1]:1/0,g?g[1]:1/0),Math.max(h,n,d?d[0]:-1/0,e?e[0]:-1/0,f?f[0]:-1/0,g?g[0]:-1/0),Math.max(i,o,d?d[1]:-1/0,e?e[1]:-1/0,f?f[1]:-1/0,g?g[1]:-1/0)]}});var da=new c(L,{initialize:function(a,b,c){this.super("initialize",arguments),b[6]||(this.attrs.args[6]=.5)},attrHooks:new o({h1x:{set:function(a){this.attrs.args[0]=a,this.update()}},h1y:{set:function(a){this.attrs.args[1]=a,this.update()}},h2x:{set:function(a){this.attrs.args[2]=a,this.update()}},h2y:{set:function(a){this.attrs.args[3]=a,this.update()}},x:{set:function(a){this.attrs.args[4]=a,this.update()}},y:{set:function(a){this.attrs.args[5]=a,this.update()}},tension:{set:function(a){this.attrs.args[6]=a,this.update()}}}),pointAt:function(a,b){b||(b=this.startAt());var c=this.attrs.args,d=b[0],e=b[1],f=c[0],g=c[1],h=c[2],i=c[3],j=c[4],k=c[5];return[.5*((3*d-f-3*j+h)*a*a*a+(2*f-5*d+4*j-h)*a*a+(-d+j)*a+2*d),.5*((3*e-g-3*k+i)*a*a*a+(2*g-5*e+4*k-i)*a*a+(-e+k)*a+2*e)]},endAt:function(){return[this.attrs.args[4],this.attrs.args[5]]},tangentAt:function(a,b){b||(b=this.startAt());var c=this.attrs.args,d=b[0],e=b[1],f=c[0],g=c[1],h=c[2],i=c[3],j=c[4],k=c[5];return Math.atan2(.5*(3*a*a*(3*e-g-3*k+i)+2*a*(2*g-5*e+4*k-i)+(-g+k)),.5*(3*a*a*(3*d-f-3*j+h)+2*a*(2*f-5*d+4*j-h)+(-f+j)))/Math.PI*180},process:function(a){var b=this.startAt(),c=this.attrs.args,d=b[0],e=b[1],f=c[0],g=c[1],h=c[2],i=c[3],j=c[4],k=c[5],l=q(d,e,f,g,h,i,j,k,c[6]);a.bezierCurveTo(l[2],l[3],l[4],l[5],l[6],l[7])}});R.Curve.catmullSpline=function(a,b,c){return a.map(function(b,d){if(0===d)return b;var e=a[d-2]||a[d-1],f=a[d+1]||b;return["catmullTo",e[0],e[1],f[0],f[1],b[0],b[1],c]})},R.curves.catmullTo=da;var ea=new c(L,{initialize:function(a,b,c){this.super("initialize",arguments)},attrHooks:new o({h1x:{set:function(a){this.attrs.args[4]=a,this.update()}},h1y:{set:function(a){this.attrs.args[5]=a,this.update()}},h2x:{set:function(a){this.attrs.args[0]=a,this.update()}},h2y:{set:function(a){this.attrs.args[1]=a,this.update()}},h3x:{set:function(a){this.attrs.args[2]=a,this.update()}},h3y:{set:function(a){this.attrs.args[3]=a,this.update()}}}),pointAt:function(a,b){b||(b=this.startAt());var c=this.attrs.args,d=b[0],e=b[1],f=c[0],g=c[1],h=c[2],i=c[3],j=c[4],k=c[5],l=[2*d-2*j+f+h,2*e-2*k+g+i],m=[-3*d+3*j-2*f-h,-3*e+3*k-2*g-i],n=[f,g],o=[d,e];return[a*a*a*l[0]+a*a*m[0]+a*n[0]+o[0],a*a*a*l[1]+a*a*m[1]+a*n[1]+o[1]]},endAt:function(){return[this.attrs.args[4],this.attrs.args[5]]},tangentAt:function(a,b){b||(b=this.startAt());var c=this.attrs.args,d=b[0],e=b[1],f=c[0],g=c[1],h=c[2],i=c[3],j=c[4],k=c[5];return Math.atan2(.5*(3*a*a*(3*e-g-3*k+i)+2*a*(2*g-5*e+4*k-i)+(-g+k)),.5*(3*a*a*(3*d-f-3*j+h)+2*a*(2*f-5*d+4*j-h)+(-f+j)))/Math.PI*180},process:function(a){this.approx(100,function(b,c,d,e){0===e&&a.moveTo(c[0],c[1]),a.lineTo(d[0],d[1])})}});R.curves.hermiteTo=ea;var fa=new c(L,{initialize:function(a,b,c){this.super("initialize",arguments),this.attrs.detail=30},attrHooks:new o({args:{set:function(a){this._x=this._y=null,this.update()}},detail:{set:function(a){this.update()}}}),_processCoords:function(){var a=[],b=[];this.attrs.args.forEach(function(c,d){d%2==0?a.push(c):b.push(c)}),this._x=a,this._y=b},pointAt:function(a,b){b||(b=this.startAt()),this._x&&this._y||this._processCoords();var c=[b[0]].concat(this._x),d=[b[1]].concat(this._y);return[t(c,a),t(d,a)]},endAt:function(){return this.attrs.args.slice(this.attrs.args.length-2)},process:function(a){this._x&&this._y||this._processCoords();var b=this.startAt(),c=[b[0]].concat(this._x),d=[b[1]].concat(this._y),e=this.attrs.detail;a.moveTo(b[0],b[1]);for(var f=1;f<=e;f++)a.lineTo(t(c,f/e),t(d,f/e))}});R.curves.bezier=fa;var ga=new c(L,{initialize:function(a,b,c){this.super("initialize",arguments),this.attrs.detail=30},attrHooks:new o({args:{set:function(a){this.attrs.t&&2*this.attrs.t.length!==a.length+2&&(this.attrs.t=null),this.update()}},t:{get:function(){if(!this.attrs.t){for(var a=[],b=this.attrs.args.length/2,c=0;c<=b;c++)a.push(c/b);return a}return this.attrs.t},set:function(a){this.update()}},detail:{set:function(a){this.update()}}}),pointAt:function(a,b){if(b||(b=this.startAt()),0===a)return b;if(1===a)return this.endAt();for(var c=this.attr("t"),d=b.concat(this.attrs.args),e=0,f=0,g=0;g<d.length;g+=2){for(var h=g/2,i=1,j=0;j<c.length;j++)j!==h&&(i*=(a-c[j])/(c[h]-c[j]));e+=i*d[g],f+=i*d[g+1]}return[e,f]},endAt:function(){return this.attrs.args.slice(this.attrs.args.length-2)},process:function(a){var b=this.startAt(),c=(this.attrs.args,this.attrs.detail);a.moveTo(b[0],b[1]);for(var d=1;d<=c;d++){var e=this.pointAt(d/c);a.lineTo(e[0],e[1])}}});R.curves.lagrange=ga,R.drawRibbonCurve=function(a,b){for(var c,d,e=b.step||.2,f=b.point(-e),g=-e;g<1.02;g+=e){var h=b.point(g);d=u(f,h,10,-1),g>=e&&(a.lineWidth=1,a.beginPath(),a.moveTo(c[0].x,c[0].y),a.lineTo(c[1].x,c[1].y),a.lineTo(d[1].x,d[1].y),a.lineTo(d[0].x,d[0].y),a.fillStyle=randcolor(),a.fill(),a.stroke()),c=d,f=h}},R.Math.Quadratic={pointAt:function(a,b,c,d){return[Math.pow(1-d,2)*a[0]+2*d*(1-d)*b[0]+d*d*c[0],Math.pow(1-d,2)*a[1]+2*d*(1-d)*b[1]+d*d*c[1]]},splitAt:function(a,b,c,d){var e=R.Math.Quadratic.pointAt(a,b,c,d);return{start:[a,[d*b[0]+(1-d)*a[0],d*b[1]+(1-d)*a[1]],e],end:[e,[d*c[0]+(1-d)*b[0],d*c[1]+(1-d)*b[1]],c]}},length:function(a,b,c){},intersect:function(a,b,c,d,e,f){}},L.canvasFunctions.quadraticCurveTo.pointAt=function(a,b,c){c||(c=a.startAt());var d=c[0],e=c[1],f=a.attrs.args;return[Math.pow(1-b,2)*d+2*b*(1-b)*f[0]+b*b*f[2],Math.pow(1-b,2)*e+2*b*(1-b)*f[1]+b*b*f[3]]},L.canvasFunctions.quadraticCurveTo.splitAt=function(a,b,c){c||(c=a.startAt());var d=a.attrs.args,e=L.canvasFunctions.quadraticCurveTo.pointAt(a,b,c);return{start:[c,[b*d[0]-(b-1)*c[0],b*d[1]-(b-1)*c[1]],e],end:[e,[b*d[2]-(b-1)*d[0],b*d[3]-(b-1)*d[1]],[d[2],d[3]]]}},R.Math.Bezier={pointAt:function(a,b,c,d,e){return[Math.pow(1-e,3)*a[0]+3*e*Math.pow(1-e,2)*b[0]+3*e*e*(1-e)*c[0]+e*e*e*d[0],Math.pow(1-e,3)*a[1]+3*e*Math.pow(1-e,2)*b[1]+3*e*e*(1-e)*c[1]+e*e*e*d[1]]},splitAt:function(a,b,c,d,e){var f=R.Math.Bezier.pointAt(a,b,c,d,e);return{start:[a,[e*b[0]+(1-e)*a[0],e*c[1]+(1-e)*a[1]],[e*e*c[0]+2*e*(1-e)*b[0]+Math.pow(1-e,2)*a[0],e*e*c[1]+2*e*(1-e)*b[1]+Math.pow(1-e,2)*a[1]],f],end:[f,[e*e*d[0]+2*e*(1-e)*c[0]+Math.pow(1-e,2)*b[0],e*e*d[1]+2*e*(1-e)*c[1]+Math.pow(1-e,2)*b[1]],[e*d[0]-(1-e)*c[0],e*d[1]-(1-e)*c[1]],d]}},length:function(a,b,c,d){},intersect:function(a,b,c,d,e,f,g,h){}},L.canvasFunctions.bezierCurveTo.pointAt=function(a,b,c){c||(c=a.startAt());var d=c[0],e=c[1],f=a.funcAttrs;return[Math.pow(1-b,3)*d+3*b*Math.pow(1-b,2)*f[0]+3*b*b*(1-b)*f[2]+b*b*b*f[4],Math.pow(1-b,3)*e+3*b*Math.pow(1-b,2)*f[1]+3*b*b*(1-b)*f[3]+b*b*b*f[5]]},L.canvasFunctions.bezierCurveTo.splitAt=function(a,b,c){c||(c=a.startAt());var d=a.funcAttrs,e=L.canvasFunctions.bezierCurveTo.pointAt(a,b,c);return{start:[c,[b*d[0]-(b-1)*c[0],b*d[1]-(b-1)*c[1]],[b*b*d[2]-2*b*(b-1)*d[0]+(b-1)*(b-1)*c[0],b*b*d[3]-2*b*(b-1)*d[1]+(b-1)*(b-1)*c[1]],e],end:[e,[b*b*d[4]-2*b*(b-1)*d[2]+(b-1)*(b-1)*d[0],b*b*d[5]-2*b*(b-1)*d[3]+(b-1)*(b-1)*d[1]],[b*d[4]-(b-1)*d[2],b*d[5]-(b-1)*d[3]],[d[4],d[5]]]}},M=new c(H,{initialize:function(a,b){this.super("initialize",arguments),g(a[0])&&(a=this.processObject(a[0],M.args)),this.attrs.d=M.parse(a[0],this),isNaN(parseInt(a[1]))&&(a[3]=a[1],a[4]=a[2],a[1]=a[2]=null),(a[1]||a[2])&&(this.attrs.x=a[1]||0,this.attrs.y=a[2]||0),a[3]&&(this.styles.fillStyle=a[3]),a[4]&&(this.attrs.stroke=a[4],H.processStroke(a[4],this.styles))},attrHooks:new n({d:{set:function(a){return this.update(),a}},x:{set:function(a){this.update()}},y:{set:function(a){this.update()}}}),curve:function(a,c){return c===b?this.attrs.d[a]:(isNaN(c[0])||(c=[c]),c=M.parse(c,this,0!==a),this.attrs.d.splice.apply(this.attrs.d,[a,1].concat(c)),this.update())},curves:function(a){return a===b?this.attrs.d:(this.attrs.d=M.parse(a,this,!0),this.update())},before:function(a,b,c){return 0===a&&!1!==turnToLine&&(this.attrs.d[0].method="lineTo"),isNaN(b[0])||(b=[b]),b=M.parse(b,this,0!==a),this.attrs.d.splice.apply(this.attrs.d,[a,0].concat(b)),this.update()},after:function(a,b){return this.before(a+1,b)},remove:function(a){return a===b?this.super("remove"):(this.attrs.d[a].path=null,this.attrs.d.splice(a,1),this.update())},push:function(a,b){return b?this.attrs.d.push(R.curve(a,b,this)):this.attrs.d=this.attrs.d.concat(M.parse(a,this,0!==this.attrs.d.length)),this.update()},each:function(){return this.attrs.d.forEach.apply(this.attrs.d,arguments),this},map:function(){return this.attrs.d.map.apply(this.attrs.d,arguments)},moveTo:function(a,b){return this.push("moveTo",[a,b])},lineTo:function(a,b){return this.push("lineTo",[a,b])},quadraticCurveTo:function(a,b,c,d){return this.push("quadraticCurveTo",[a,b,c,d])},bezierCurveTo:function(a,b,c,d,e,f){return this.push("bezierCurveTo",[a,b,c,d,e,f])},arcTo:function(a,b,c,d,e,f){return this.push("arcTo",[a,b,c,d,e,!!f])},arc:function(a,b,c,d,e,f){return this.push("arc",[a,b,c,d,e,!!f])},closePath:function(){return this.push("closePath",[])},isPointIn:function(a,b){var c=this.super("isPointIn",[a,b]);a=c[0],b=c[1];var d=this.context.context;this.context.renderer.pre(d,this.styles,this.matrix,this),(this.attrs.x||this.attrs.y)&&d.translate(this.attrs.x||0,this.attrs.y||0),this.attrs.d.forEach(function(a){a.process(d)});var e=d.isPointInPath(a,b);return d.restore(),e},bounds:function(a,b){for(var c,d=1/0,e=1/0,f=-1/0,g=-1/0,h=[0,0],i=0;i<this.attrs.d.length;i++)c=this.attrs.d[i].bounds(h),h=this.attrs.d[i].endAt()||h,c&&(d=Math.min(d,c[0],c[2]),f=Math.max(f,c[0],c[2]),e=Math.min(e,c[1],c[3]),g=Math.max(g,c[1],c[3]));return this.super("bounds",[[d,e,f-d,g-e],a,b])},draw:function(a){this.attrs.visible&&(this.context.renderer.pre(a,this.styles,this.matrix,this),(this.attrs.x||this.attrs.y)&&a.translate(this.attrs.x||0,this.attrs.y||0),a.beginPath(),this.attrs.d.forEach(function(b){b.process(a)}),this.context.renderer.post(a,this.styles))}}),M.args=["d","x","y","fill","stroke"],M.parse=function(a,c,d){if(!a)return[];if(a instanceof L)return a.path=c,[a];a[0]===b||+a[0]!==a[0]&&a[0]+""!==a[0]||(a=[a]);var e=[];if(Array.isArray(a))for(var f=0;f<a.length;f++)a[f]instanceof L?(e.push(a[f]),a[f].path=c):0!==f||d?e.push(L.fromArray(a[f],c)):e.push(new L("moveTo",isNaN(a[f][0])?a[f].slice(1):a[f],c));return e},R.path=function(){return new M(arguments)},R.Path=M,Z(M.prototype,{length:function(){return this.attrs.d.reduce(function(a,b){return a+b.length()},0)},startAt:function(){return this.pointAt(0)},curveAt:function(a){if(a<0||a>1)return null;var b=this.attrs.d;1===a&&(a=1-Number.EPSILON);for(var c=this.length(),d=0,e=0;e<=b.length;e++){if(d/c>a)return b[e-1];d+=b[e].length()}return null},_pathToCurveParams:function(a){if(a<0||a>1)return null;for(var b,c,d=this.attrs.d,e=this.length(),f=0,g=0;g<=d.length;g++){if(f/e>a){c=d[g-1];break}b=f,f+=d[g].length()}return{t:(a-b/e)/((f-b)/e),curve:c}},pointAt:function(a){if(1===a)return this.curveAt(1).endAt();var b=this._pathToCurveParams(a);return b.curve.pointAt(b.t)},tangentAt:function(a){1===a&&(a=1-Number.EPSILON);var b=this._pathToCurveParams(a);return b.curve.tangentAt(b.t)},normalAt:function(a){1===a&&(a=1-Number.EPSILON);var b=this._pathToCurveParams(a);return b.curve.normalAt(b.t)},nearest:function(a,b,c){return this.attrs.d.reduce(function(d,e){var f=e.nearest(a,b,c);return f.distance<d.distance?f:d},{point:null,t:0,distance:1/0})}}),Z(R.curves,{moveBy:new c(L,{process:function(a){var b=this.before().endAt();a.moveTo(b[0]+this.attrs.args[0],b[1]+this.attrs.args[1])},endAt:function(){var a=this.before().endAt();return[a[0]+this.attrs.args[0],a[1]+this.attrs.args[1]]}}),lineBy:new c(L,{process:function(a){var b=this.before().endAt();a.lineTo(b[0]+this.attrs.args[0],b[1]+this.attrs.args[1])},endAt:function(){var a=this.before().endAt();return[a[0]+this.attrs.args[0],a[1]+this.attrs.args[1]]}}),horizontalLineTo:new c(L,{process:function(a){var b=this.before().endAt();a.lineTo(this.attrs.args[0],b[1])},endAt:function(){var a=this.before().endAt();return[this.attrs.args[0],a[1]]}}),horizontalLineBy:new c(L,{process:function(a){var b=this.before().endAt();a.lineTo(b[0]+this.attrs.args[0],b[1])},endAt:function(){var a=this.before().endAt();return[a[0]+this.attrs.args[0],a[1]]}}),verticalLineTo:new c(L,{process:function(a){var b=this.before().endAt();a.lineTo(b[0],this.attrs.args[0])},endAt:function(){return[this.before().endAt()[0],this.attrs.args[0]]}}),verticalLineBy:new c(L,{process:function(a){var b=this.before().endAt();a.lineTo(b[0],b[1]+this.attrs.args[0])},endAt:function(){var a=this.before().endAt();return[a[0],a[1]+this.attrs.args[0]]}}),quadraticCurveBy:new c(L,{getQuadraticParameters:function(){var a=this.before().endAt();return[a[0]+this.attrs.args[0],a[1]+this.attrs.args[1],a[0]+this.attrs.args[2],a[1]+this.attrs.args[3]]},process:function(a){var b=this.getQuadraticParameters();a.quadraticCurveTo(b[0],b[1],b[2],b[3])},endAt:function(){var a=this.getQuadraticParameters();return[a[2],a[3]]}}),shorthandQuadraticCurveTo:new c(L,{getQuadraticParameters:function(){var a,b=this.before(),c=b.endAt();return b="quadraticCurveTo"===b.method?b.attrs.args:b.getQuadraticParameters?b.getQuadraticParameters():null,a=b?[b[2]-b[0],b[3]-b[1]]:[0,0],[c[0]+a[0],c[1]+a[1],this.attrs.args[0],this.attrs.args[1]]},process:function(a){var b=this.getQuadraticParameters();a.quadraticCurveTo(b[0],b[1],b[2],b[3])},endAt:function(){var a=this.getQuadraticParameters();return[a[2],a[3]]}}),shorthandQuadraticCurveBy:new c(L,{getQuadraticParameters:function(){var a,b=this.before(),c=b.endAt();return b="quadraticCurveTo"===b.method?b.attrs.args:b.getQuadraticParameters?b.getQuadraticParameters():null,a=b?[b[2]-b[0],b[3]-b[1]]:[0,0],[c[0]+a[0],c[1]+a[1],c[0]+this.attrs.args[0],c[1]+this.attrs.args[1]]},process:function(a){var b=this.getQuadraticParameters();a.quadraticCurveTo(b[0],b[1],b[2],b[3])},endAt:function(){var a=this.getQuadraticParameters();return[a[2],a[3]]}}),bezierCurveBy:new c(L,{getBezierParameters:function(){var a=this.before().endAt();return[a[0]+this.attrs.args[0],a[1]+this.attrs.args[1],a[0]+this.attrs.args[2],a[1]+this.attrs.args[3],a[0]+this.attrs.args[4],a[1]+this.attrs.args[5]]},process:function(a){var b=this.getBezierParameters();a.bezierCurveTo(b[0],b[1],b[2],b[3],b[4],b[5])},endAt:function(){var a=this.getBezierParameters();return[a[4],a[5]]}}),shorthandCurveTo:new c(L,{getBezierParameters:function(){var a,b=this.before(),c=b.endAt();return b=b.getBezierParameters?b.getBezierParameters():"bezierCurveTo"===b.method?b.attrs.args:null,a=b?[b[4]-b[2],b[5]-b[3]]:[0,0],[c[0]+a[0],c[1]+a[1],this.attrs.args[0],this.attrs.args[1],this.attrs.args[2],this.attrs.args[3]]},process:function(a){var b=this.getBezierParameters();a.bezierCurveTo(b[0],b[1],b[2],b[3],b[4],b[5])},endAt:function(){var a=this.getBezierParameters();return[a[4],a[5]]}}),shorthandCurveBy:new c(L,{getBezierParameters:function(){var a,b=this.before(),c=b.endAt();return b=b.getBezierParameters?b.getBezierParameters():"bezierCurveTo"===b.method?b.attrs.args:null,a=b?[b[4]-b[2],b[5]-b[3]]:[0,0],[c[0]+a[0],c[1]+a[1],c[0]+this.attrs.args[0],c[1]+this.attrs.args[1],c[0]+this.attrs.args[2],c[1]+this.attrs.args[3]]},process:function(a){var b=this.getBezierParameters();a.bezierCurveTo(b[0],b[1],b[2],b[3],b[4],b[5])},endAt:function(){var a=this.getBezierParameters();return[a[4],a[5]]}}),ellipticalArcTo:new c(L,{process:function(a){function b(a,b,c,d,e,f,g,h,i){g*=Math.PI/180;var j=Math.sin(g),k=Math.cos(g);c=Math.abs(c),d=Math.abs(d);var l=k*(h-a)*.5+j*(i-b)*.5,m=k*(i-b)*.5-j*(h-a)*.5,n=l*l/(c*c)+m*m/(d*d);n>1&&(n=Math.sqrt(n),c*=n,d*=n);var o=k/c,p=j/c,q=-j/d,r=k/d,s=o*h+p*i,t=q*h+r*i,u=o*a+p*b,v=q*a+r*b,w=(u-s)*(u-s)+(v-t)*(v-t),x=1/w-.25;x<0&&(x=0);var y=Math.sqrt(x);f==e&&(y=-y);var z=.5*(s+u)-y*(v-t),A=.5*(t+v)+y*(u-s),B=Math.atan2(t-A,s-z),C=Math.atan2(v-A,u-z),D=C-B;D<0&&1==f?D+=2*Math.PI:D>0&&0==f&&(D-=2*Math.PI);for(var E=Math.ceil(Math.abs(D/(.5*Math.PI+.001))),F=[],G=0;G<E;G++){var H=B+G*D/E,I=B+(G+1)*D/E;F[G]=[z,A,H,I,c,d,j,k]}return F}function c(a,b,c,d,e,f,g,h){var i=h*e,j=-g*f,k=g*e,l=h*f,m=.5*(d-c),n=8/3*Math.sin(.5*m)*Math.sin(.5*m)/Math.sin(m),o=a+Math.cos(c)-n*Math.sin(c),p=b+Math.sin(c)+n*Math.cos(c),q=a+Math.cos(d),r=b+Math.sin(d),s=q+n*Math.sin(d),t=r-n*Math.cos(d);return[i*o+j*p,k*o+l*p,i*s+j*t,k*s+l*t,i*q+j*r,k*q+l*r]}var d=this.attrs.args[0],e=this.attrs.args[1],f=this.attrs.args[2],g=1===this.attrs.args[3],h=1===this.attrs.args[4],i=this.attrs.args[5],j=this.attrs.args[6],k=this.before().endAt();b(i,j,d,e,g,h,f,k[0],k[1]).forEach(function(b){b=c.apply(this,b),a.bezierCurveTo.apply(a,b)})},endAt:function(){return[this.attrs.args[5],this.attrs.args[6]]}})}),R.SVGCurves={M:"moveTo",m:"moveBy",L:"lineTo",l:"lineBy",H:"horizontalLineTo",h:"horizontalLineBy",V:"verticalLineTo",v:"verticalLineBy",C:"bezierCurveTo",c:"bezierCurveBy",S:"shorthandCurveTo",s:"shorthandCurveBy",Q:"quadraticCurveTo",q:"quadraticCurveBy",T:"shorthandQuadraticCurveTo",t:"shorthandQuadraticCurveBy",A:"ellipticalArcTo",a:"ellipticalArcBy",Z:"closePath",z:"closePath"},R.SVGCurvesLengths={M:2,m:2,L:2,l:2,H:1,h:1,V:1,v:1,C:6,c:6,S:4,s:4,Q:4,q:4,T:2,t:2,A:7,a:7,z:0};var ha=M.parse;M.parse=function(a,b,c){if(a+""!==a)return ha(a,b,c);var d=[];return a.match(/[a-zA-Z](\s*-?\d+\,?|\s*-?\d*\.\d+\,?)*/g).forEach(function(a,c){var e=a[0];if(!R.SVGCurves[e])throw'Unknown SVG curve command "'+e+'"';a=a.replace(/(\.\d+)\./g,"$1,.");var f=a.match(/-?\d+?\.\d+|-?\d+/g);f=f?f.map(Number):[];for(var g=R.SVGCurvesLengths[e];f.length>g;)d.push(R.curve(R.SVGCurves[e],f.slice(0,g),b)),f=f.slice(g);d.push(R.curve(R.SVGCurves[e],f,b))}),d},Z(M.prototype,{moveBy:function(a,b){return this.attrs.d.push(R.curve("moveBy",[a,b],this))}}),N=new c(H,{initialize:function(a,c){this.super("initialize",arguments),g(a[0])&&(a=this.processObject(a[0],N.args)),this.attrs.image=N.parse(a[0]),this.attrs.x=a[1],this.attrs.y=a[2],this.attrs.width=a[3]===b?"auto":a[3],this.attrs.height=a[4]===b?"auto":a[4],a[5]&&(this.attrs.crop=a[5]),this.attrs.image.addEventListener("load",function(a){this.update(),this.fire("load",a)}.bind(this)),this.attrs.image.addEventListener("error",function(a){this.fire("error",event)}.bind(this))},attrHooks:new n({image:{set:function(a){return a=N.parse(a),a.complete&&this.update(),a.addEventListener("load",function(a){this.update(),this.fire("load",a)}.bind(this)),a}},x:{set:function(a){this.attrs.x=a,this.update()}},y:{set:function(a){this.attrs.y=a,this.update()}},width:{set:function(a){this.attrs.width=a,this.update()}},height:{set:function(a){this.attrs.height=a,this.update()}},crop:{set:function(a){this.attrs.crop=a,this.update()}},smooth:{get:function(){return this.styles[v(this.context.context)]||this.context.context[v(this.context.context)]},set:function(a){this.styles[v(this.context.context)]=!!a,this.update()}}}),remove:function(){this.super("remove"),this.attrs.image.blob&&Y.revokeObjectURL(this.attrs.image.blob)},getRealSize:function(){var a=this.attrs.width,b=this.attrs.height;return"auto"===a&&"auto"===b&&(a=b="native"),"auto"===a?a=this.attrs.image.width*(b/this.attrs.image.height):"native"===a&&(a=this.attrs.image.width),"auto"===b?b=this.attrs.image.height*(a/this.attrs.image.width):"native"===b&&(b=this.attrs.image.height),[a,b]},bounds:function(a,b){var c=this.getRealSize();return this.super("bounds",[[this.attrs.x,this.attrs.y,c[0],c[1]],a,b])},isPointIn:function(a,b){var c=this.super("isPointIn",[a,b]);a=c[0],b=c[1];var d=this.getRealSize();return a>this.attrs.x&&b>this.attrs.y&&a<this.attrs.x+d[0]&&b<this.attrs.y+d[1]},draw:function(a){if(this.attrs.visible&&this.attrs.image.complete){this.context.renderer.pre(a,this.styles,this.matrix,this);var b=(this.attrs.image,this.attrs.x,this.attrs.y,this.attrs.width),c=this.attrs.height,d=this.attrs.crop;if("auto"===this.attrs.width||"native"===this.attrs.width||"auto"===this.attrs.height||"native"===this.attrs.height){var e=this.getRealSize();b=e[0],c=e[1]}d?a.drawImage(this.attrs.image,d[0],d[1],d[2],d[3],this.attrs.x,this.attrs.y,b,c):"auto"!==this.attrs.width&&"native"!==this.attrs.width||"auto"!==this.attrs.height&&"native"!==this.attrs.height?a.drawImage(this.attrs.image,this.attrs.x,this.attrs.y,b,c):a.drawImage(this.attrs.image,this.attrs.x,this.attrs.y),a.restore()}}});var ia;N.args=["image","x","y","width","height","crop"],N.parse=function(a){if(a+""===a){if("#"===a[0])return S.getElementById(a.substr(1));if("<svg"!==a[0]){var b=new Image;return b.src=a,b}var c=new Blob([a],{type:"image/svg+xml;charset=utf-8"});a=new Image,a.src=Y.createObjectURL(c),a.blob=c}return a},R.image=function(){return new N(arguments)},R.Image=N;var ja="top";O=new c(H,{initialize:function(a,c){this.super("initialize",arguments),g(a[0])?(a[0].align&&(this.attrs.align=a[0].align,this.styles.textAlign=a[0].align),a[0].baseline?this.attrs.baseline=a[0].baseline:this.attrs.baseline=ja,a[0].breaklines!==b?this.attrs.breaklines=a[0].breaklines:this.attrs.breaklines=!0,a[0].lineHeight!==b?this.attrs.lineHeight=a[0].lineHeight:this.attrs.lineHeight="auto",a[0].maxStringWidth!==b?this.attrs.maxStringWidth=a[0].maxStringWidth:this.attrs.maxStringWidth=1/0,a[0].blockWidth!==b?this.attrs.blockWidth=a[0].blockWidth:this.attrs.blockWidth=1/0,a[0].boundsMode?this.attrs.boundsMode=a[0].boundsMode:this.attrs.boundsMode="inline",a[0].text&&(a[0].string=a[0].text),a=this.processObject(a[0],O.args)):(this.attrs.baseline=ja,this.attrs.breaklines=!0,this.attrs.lineHeight="auto",this.attrs.maxStringWidth=1/0,this.attrs.blockWidth=1/0,this.attrs.boundsMode="inline"),this.styles.textBaseline=this.attrs.baseline,this.attrs.string=a[0]+"",this.attrs.x=a[1],this.attrs.y=a[2],this.attrs.font=O.parseFont(a[3]||O.font),this.styles.font=O.genFont(this.attrs.font),a[4]&&(this.styles.fillStyle=a[4]),a[5]&&(this.styles.stroke=a[5],H.processStroke(a[5],this.styles))},attrHooks:new n({string:{set:function(a){return this.lines=null,this.update(),
a+""}},x:{set:function(a){this.update()}},y:{set:function(a){this.update()}},font:{set:function(a){return Z(this.attrs.font,O.parseFont(a)),this.styles.font=O.genFont(this.attrs.font),this.update(),null}},align:{get:function(){return this.styles.textAlign||"left"},set:function(a){return this.styles.textAlign=a,this.update(),null}},baseline:{get:function(){return this.styles.textBaseline},set:function(a){return this.styles.textBaseline=a,this.update(),null}},breaklines:{set:function(){this.update()}},lineHeight:{set:function(){this.lines=null,this.update()}},maxStringWidth:{set:function(){this.update()}},blockWidth:{set:function(){this.lines=null,this.update()}}}),lines:null,processLines:function(a){var b=this.attrs.string,c=this.lines=[],d="auto"===this.attrs.lineHeight?this.attrs.font.size:this.attrs.lineHeight,e=this.attrs.blockWidth,f=("center"===this.styles.textAlign||this.styles.textAlign,this.context.renderer);return f.preMeasure(this.styles.font),b.split("\n").forEach(function(a){if(f.measure(a)>e){for(var b,g=a.split(" "),h="",i=0;i<g.length;i++)b=h+g[i]+" ",f.measure(b)>e?(c.push({text:h,y:d*c.length}),h=g[i]+" "):h=b;c.push({text:h,y:d*c.length})}else c.push({text:a,y:d*c.length})},this),f.postMeasure(),this},draw:function(a){if(this.attrs.visible){if(this.context.renderer.pre(a,this.styles,this.matrix,this),this.attrs.breaklines){this.lines||this.processLines(a);var c=this.attrs.x,d=this.attrs.y;this.styles.fillStyle&&!this.styles.strokeStyle?this.lines.forEach(function(b){a.fillText(b.text,c,d+b.y)}):this.styles.fillStyle?this.lines.forEach(function(b){a.fillText(b.text,c,d+b.y),a.strokeText(b.text,c,d+b.y)}):this.lines.forEach(function(b){a.strokeText(b.text,c,d+b.y)})}else{var e=this.attrs.maxStringWidth<1/0?this.attrs.maxStringWidth:b;this.styles.fillStyle&&a.fillText(this.attrs.string,this.attrs.x,this.attrs.y,e),this.styles.strokeStyle&&a.strokeText(this.attrs.string,this.attrs.x,this.attrs.y,e)}a.restore()}},isPointIn:function(a,b){var c=this.super("isPointIn",[a,b]);a=c[0],b=c[1];var d=this.bounds(!1);return a>d.x1&&b>d.y1&&a<d.x2&&b<d.y2},measure:function(){var a;return this.attrs.breaklines?(this.lines||this.processLines(this.context.context),this.context.renderer.preMeasure(this.styles.font),a=this.lines.reduce(function(a,b){return b=this.context.renderer.measure(b.text),a<b?b:a}.bind(this),0),this.context.renderer.postMeasure()):(this.context.renderer.preMeasure(this.styles.font),a=this.context.renderer.measure(this.attrs.string),this.context.renderer.postMeasure()),a},bounds:function(a,b){var c,d=this.attrs.x,e=this.attrs.y,f="auto"===this.attrs.lineHeight?this.attrs.font.size:this.attrs.lineHeight;this.attrs.breaklines?(c=this.attrs.blockWidth,"inline"!==this.attrs.boundsMode&&isFinite(c)||(c=this.measure()),this.lines||this.processLines(),f*=this.lines.length):(c=this.measure(),this.attrs.maxStringWidth<c&&(c=this.attrs.maxStringWidth));var g=this.styles.textBaseline,h=this.styles.textAlign;return"middle"===g?e-=this.attrs.font.size/2:"bottom"===g||"ideographic"===g?e-=this.attrs.font.size:"alphabetic"===g&&(e-=.8*this.attrs.font.size),"center"===h?d-=c/2:"right"===h&&(d-=c),this.super("bounds",[[d,e,c,f],a,b])}}),O.font="10px sans-serif",O.args=["string","x","y","font","fill","stroke"],O.parseFont=function(a){if(a+""===a){var b={family:""};return a.split(" ").forEach(function(a){"bold"===a?b.bold=!0:"italic"===a?b.italic=!0:X.test(a)?b.size=R.distance(a):b.family+=" "+a}),b.family=b.family.trim(),b}return a},O.genFont=function(a){var b="";return a.italic&&(b+="italic "),a.bold&&(b+="bold "),b+(a.size||10)+"px "+(a.family||"sans-serif")},R.text=function(){return new O(arguments)},R.Text=O,P=new c({initialize:function(a,b,c,d,e){this.context=e,a+""!==a&&(d=c,c=b,b=a,a="linear"),this.type=a||"linear",this.attrs={from:c,to:d,colors:P.parseColors(b)},P.types[this.type]&&(this.attrHooks=Z(Z({},this.attrHooks),P.types[this.type].attrHooks),P.types[this.type].initialize&&P.types[this.type].initialize.call(this))},attr:c.attr,attrHooks:{colors:{set:function(a){return this.update(),P.parseColors(a)}}},color:function(a,c){if(c!==b)return this.attrs.colors[a]=c,this.update();if(this.attrs.colors[a])return R.color(this.attrs.colors[a]);var d=this.attrs.colors,e=Object.keys(d).sort();if(a<e[0])return R.color(d[e[0]]);if(a>e[e.length-1])return R.color(d[e[e.length-1]]);for(var f=0;f<e.length;f++)if(+e[f]>a){var g=R.color(d[e[f-1]]),h=R.color(d[e[f]]);return a=(a-+e[f-1])/(+e[f]-+e[f-1]),[g[0]+(h[0]-g[0])*a+.5|0,g[1]+(h[1]-g[1])*a+.5|0,g[2]+(h[2]-g[2])*a+.5|0,+(g[3]+(h[3]-g[3])*a).toFixed(2)]}},update:function(){return this.context.update(),this},toCanvasStyle:function(a,b){return P.types[this.type].toCanvasStyle.call(this,a,b)}}),P.parseColors=function(a){if(!Array.isArray(a))return a;var b={},c=1/(a.length-1);return a.forEach(function(a,d){b[c*d]=a}),b},P.types={linear:{attrHooks:{from:{set:function(a){return this.update(),a}},to:{set:function(a){return this.update(),a}}},toCanvasStyle:function(a,b){return this.context.renderer.makeGradient(this.context,"linear",b.corner(this.attrs.from),b.corner(this.attrs.to),this.attrs.colors)}},radial:{initialize:function(){this.attrs.from&&Array.isArray(this.attrs.from)?(this.attrs.startRadius=this.attrs.from[2]||0,this.attrs.from=this.attrs.from.slice(0,2)):(this.attrs.from||(this.attrs.from="center"),this.attrs.startRadius=0),this.attrs.to&&Array.isArray(this.attrs.to)?(this.attrs.radius=this.attrs.to[2]||"auto",this.attrs.to=this.attrs.to.slice(0,2)):(this.attrs.to||(this.attrs.to=this.attrs.from),this.attrs.radius="auto")},attrHooks:{from:{set:function(a){return Array.isArray(a)&&a.length>2&&(this.attrs.startRadius=a[2],a=a.slice(0,2)),this.update(),a}},to:{set:function(a){return Array.isArray(a)&&a.length>2&&(this.attrs.radius=a[2],a=a.slice(0,2)),this.update(),a}},radius:{set:function(a){return this.update(),a}},startRadius:{set:function(a){return this.update(),a}}},toCanvasStyle:function(a,b){var c=b.corner(this.attrs.from),d=b.corner(this.attrs.to);return this.context.renderer.makeGradient(this.context,"radial",[c[0],c[1],this.attrs.startRadius],[d[0],d[1],"auto"===this.attrs.radius?b.bounds().height:this.attrs.radius],this.attrs.colors)}}},R.Gradient=P,Q=new c({initialize:function(a,b,c){this.image=N.parse(a),this.repeat=b,this.context=c,this.image.addEventListener("load",function(a){this.update(),this.image.blob&&Y.revokeObjectURL(blob)}.bind(this))},update:function(){return this.context.update(),this},toCanvasStyle:function(a){return this.image.complete?a.createPattern(this.image,this.repeat||"repeat"):"transparent"}}),R.Pattern=Q,H.prototype.attrHooks.along={preAnim:function(a,b){var c=b.curve;(b instanceof L||b instanceof M)&&(c=b,b={});var d=b.corner||"center";d=this.corner(d,b.cornerOptions||{transform:"ignore"}),b.offset&&(d[0]-=b.offset[0],d[1]-=b.offset[1]),a.initialCoords=d,a.curve=c,b.dynamic||(a.startCurvePoint=c.startAt()),this.attr("rotatePivot",d),+b.rotate===b.rotate?this.attr("rotate",b.rotate):!0===b.rotate&&(a.rotate=!0),a.addRotate=b.addRotate||0},anim:function(a){var b=a.curve.pointAt(a.pos,a.startCurvePoint);b[0]-=a.initialCoords[0],b[1]-=a.initialCoords[1],this.attr("translate",b),!0===a.rotate&&this.attr("rotate",a.curve.tangentAt(a.pos,null,a.startCurvePoint)+a.addRotate)}},M.prototype.attrHooks.morph={preAnim:function(a,b){var c=b.curve,d=b.to,e=c.startAt(),f=c.path.attr("d").indexOf(c);a.startCurve=c,a.endCurve=M.parse(d,null,!0)[0];var g=new ka(c.method,c.attrs,c.path,b.detail);a.startPoints=g._points=g.genPoints(e),a.endPoints=new ka(a.endCurve.method,a.endCurve.attrs,null,b.detail).genPoints(e),a.deltas=a.endPoints.map(function(b,c){return[b[0]-a.startPoints[c][0],b[1]-a.startPoints[c][1]]}),c.path.curve(f,g),a.curve=g,a.index=f},anim:function(a){a.curve._points=a.curve._points.map(function(b,c){return[a.startPoints[c][0]+a.deltas[c][0]*a.pos,a.startPoints[c][1]+a.deltas[c][1]*a.pos]}),a.curve.update(),1===a.pos&&a.curve.path.curve(a.index,a.endCurve)}};var ka=new c(L,{initialize:function(a,b,c,d){this.super("initialize",arguments),this.attrs.detail=d},genPoints:function(a){for(var b=this.attrs.detail||L.detail,c=[a||this.startAt()],d=1;d<=b;d++)c.push(this.pointAt(d/b,c[0]));return c},process:function(a){this._points||(this._points=this.genPoints()),this._points.forEach(function(b){a.lineTo(b[0],b[1])})}});R.CurveApprox=ka;var la=new c(L,{initialize:function(a,b,c){this.super("initialize",arguments),this.attrs={points:b}},process:function(a){this._points||(this._points=this.genPoints()),this._points.forEach(function(b){a.lineTo(b[0],b[1])})}});R.CurvePolyline=la;var ma;ma=new c(G,{initialize:function(a){if(this.gl=this._getAndPrepareGLContext(a),!this.gl)return new R.contexts["2d"](a);this.shaders={},this.buffers={},this.canvas=a,this.elements=[],this.listeners={},this._missing=[],this.drawMissingBound=this.drawMissing.bind(this),this.updateNowBounded=this.updateNow.bind(this)},_getAndPrepareGLContext:function(a){var b;if(b=a.getContext("webgl"));else if(b=a.getContext("experimental-webgl"));else if(b=a.getContext("webkit-3d"));else if(!(b=a.getContext("moz-webgl")))return null;return b.viewport(0,0,a.width,a.height),b.clearColor(1,.8,.9,1),b.clear(b.COLOR_BUFFER_BIT),b},push:function(a){return a.context=this,this.elements.push(a),a.shadersRequired&&a.shadersRequired.forEach(function(a){this.initShader(a)}.bind(this)),a.drawGL&&(this._missing.push(a),this._willDrawMissing||(_(this.drawMissingBound),this._willDrawMissing=!0)),a},initShader:function(a){if(!this.shaders[a]){if(!ma.shadersFactory[a])throw'The shader "'+a+'" is not exist.';this.shaders[a]=ma.shadersFactory[a](this.gl,this)}},drawMissing:function(){this._willDrawMissing=!1;var a=this.gl;this._missing.forEach(function(b){b.drawGL(a)})}}),ma.shadersFactory={"fragment-common":function(a){return R.createShader(a,a.FRAGMENT_SHADER,["#ifdef GL_ES","precision highp float;","#endif","varying vec4 vColor;","void main(void){","gl_FragColor = vec4(vColor[0] / 255.0, vColor[1] / 255.0, vColor[2] / 255.0, vColor[3]);","}"].join("\n"))}},R.createShader=function(a,b,c){var d=a.createShader(b);if(a.shaderSource(d,c),a.compileShader(d),!a.getShaderParameter(d,a.COMPILE_STATUS)){var e=a.getShaderInfoLog(d);throw a.deleteShader(d),"Shader compilation error: "+e}return d},R.contexts.gl=ma,ma.shadersFactory["vertex-rect"]=function(a){return R.createShader(a,a.VERTEX_SHADER,["attribute vec2 aVertexPosition;","uniform vec4 rectCoords;","uniform vec4 uColor;","varying vec4 vColor;","float canvasWidth = "+a.canvas.width+".0;","float canvasHeight = "+a.canvas.height+".0;","void main(void){","vColor = uColor;","gl_Position = vec4(","(aVertexPosition[0] * rectCoords[2] / canvasWidth) - 1.0 + rectCoords[2] / canvasWidth + (rectCoords[0] * 2.0 / canvasWidth),","(aVertexPosition[1] * rectCoords[3] / canvasHeight) + 1.0 - rectCoords[3] / canvasHeight - (rectCoords[1] * 2.0 / canvasHeight),","1.0,","1.0",");","}"].join("\n"))},ma.shadersFactory["program-rect"]=function(a,b){var c=a.createProgram();if(a.attachShader(c,b.shaders["vertex-rect"]),a.attachShader(c,b.shaders["fragment-common"]),a.linkProgram(c),!a.getProgramParameter(c,a.LINK_STATUS))throw"Could not initialize shaders";return a.useProgram(c),c.uColor=a.getUniformLocation(c,"uColor"),c.rectCoords=a.getUniformLocation(c,"rectCoords"),c.v_aVertexPosition=a.getAttribLocation(c,"aVertexPosition"),a.enableVertexAttribArray(c.v_aVertexPosition),c},J.prototype.shadersRequired=["fragment-common","vertex-rect","program-rect"],J.prototype.drawGL=function(a){var b=this.context;if(!b.buffers.rect){var c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,1,1,1,-1,-1,-1,1,1,-1,1]),a.STATIC_DRAW),b.buffers.rect=c}var d=R.color(this.styles.fillStyle);a.uniform4f(b.shaders["program-rect"].uColor,d[0],d[1],d[2],d[3]),a.uniform4f(b.shaders["program-rect"].rectCoords,this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height),a.vertexAttribPointer(b.shaders["program-rect"].v_aVertexPosition,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,6)},ma.shadersFactory["vertex-path"]=function(a){return R.createShader(a,a.VERTEX_SHADER,["attribute vec2 aVertexPosition;","uniform vec4 rectCoords;","uniform vec4 uColor;","varying vec4 vColor;","float canvasWidth = "+a.canvas.width+".0;","float canvasHeight = "+a.canvas.height+".0;","void main(void){","vColor = uColor;","gl_Position = vec4(","aVertexPosition[0],","aVertexPosition[1],","1.0,","1.0",");","}"].join("\n"))},ma.shadersFactory["program-path"]=function(a,b){var c=a.createProgram();if(a.attachShader(c,b.shaders["vertex-path"]),a.attachShader(c,b.shaders["fragment-common"]),a.linkProgram(c),!a.getProgramParameter(c,a.LINK_STATUS))throw"Could not initialize shaders";return a.useProgram(c),c.uColor=a.getUniformLocation(c,"uColor"),c.rectCoords=a.getUniformLocation(c,"rectCoords"),c.v_aVertexPosition=a.getAttribLocation(c,"aVertexPosition"),a.enableVertexAttribArray(c.v_aVertexPosition),c},M.prototype.shadersRequired=["fragment-common","vertex-path","program-path"],M.prototype.drawGL=function(a){var b=this.context;if(!b.buffers.rect){var c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,.5,.5,.5,0,.5,-.5,-1,0]),a.STATIC_DRAW),b.buffers.rect=c}var d=R.color(this.styles.fillStyle);a.uniform4f(b.shaders["program-rect"].uColor,d[0],d[1],d[2],d[3]),a.uniform4f(b.shaders["program-rect"].rectCoords,10,10,200,200),a.vertexAttribPointer(b.shaders["program-rect"].v_aVertexPosition,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLE_FAN,0,5)},Z(H.prototype,{editor:function(a,b,c){if(b||(b="enable"),!R.editors[a])throw"There's no "+a+" editor";if(b+""===b)return R.editors[a][b](this,c)||this}}),R.editors={};var na={axis:"both",inBounds:null,cursor:null,cursorAt:null,moveWith:[],delay:100,distance:5,grid:null,helper:null,helperFixPosition:!0,helperAttrs:{opacity:.5},zIndex:null,zIndexReturn:!0};H.prototype.draggable=function(a,b){return a+""!==a?(b=a,a="init"):a||(a="init"),this.draggable[a].call(this,b)},H.prototype.draggable.init=function(b){b||(b={}),this._draggingOptions=Z(Z({},na),b),this.draggable.updateMods.call(this),this.on("mousedown",w),a.addEventListener("mouseup",x.bind(this)),a.addEventListener("mousemove",y.bind(this))},H.prototype.draggable.destroy=function(){},H.prototype.draggable.enable=function(){},H.prototype.draggable.disable=function(){},H.prototype.draggable.updateMods=function(){var a=[];"left top"!==this._draggingOptions.cursorAt&&"lt"!==this._draggingOptions.cursorAt&&"tl"!==this._draggingOptions.cursorAt&&a.push("cursorAt"),this._draggingOptions.distance&&a.push("distance"),this._draggingOptions.delay&&a.push("delay"),this._draggingOptions.inBounds&&(this._draggingOptions.inBounds instanceof d||!this._draggingOptions.inBounds.bounds||(this._draggingOptions.inBounds=this._draggingOptions.inBounds.bounds()),a.push("inBounds")),"both"!==this._draggingOptions.axis&&a.push("axis"),this._draggingOptions.grid&&(+this._draggingOptions.grid===this._draggingOptions.grid&&(this._draggingOptions.grid=[this._draggingOptions.grid,this._draggingOptions.grid]),0===this._draggingOptions.grid[0]&&(this._draggingOptions.grid[0]=1),0===this._draggingOptions.grid[1]&&(this._draggingOptions.grid[1]=1),a.push("grid")),this._draggingOptions.moveWith&&(this._draggingOptions.moveWith.length||(this._draggingOptions.moveWith=[this._draggingOptions.moveWith]),a.push("moveWith")),this._draggingOptions.helper&&a.push("helper"),this._draggingOptions.mods=a};var oa={cursorAt:function(a,b,c){var d=this._draggingOptions.cursorAt;if(!d){var e=[this._dragging.downCoords[0]-this._dragging.bounds.x,this._dragging.downCoords[1]-this._dragging.bounds.y];return[a-e[0],b-e[1]]}return[a-this._dragging.bounds.width*R.corners[d][0],b-this._dragging.bounds.height*R.corners[d][1]]},distance:function(a,b,c){return this._dragging.doNotCheckDistance?[a,b]:Math.sqrt(Math.pow(this._dragging.downCoords[0]-c.contextX,2)+Math.pow(this._dragging.downCoords[1]-c.contextY,2))<this._draggingOptions.distance?[this._dragging.bounds.x-this._dragging.nativeBounds.x,this._dragging.bounds.y-this._dragging.nativeBounds.y]:(this._dragging.doNotCheckDistance=!0,[a,b])},delay:function(a,b,c){return this._dragging.doNotCheckDelay?[a,b]:Date.now()-this._dragging.downTime<this._draggingOptions.delay?[this._dragging.bounds.x-this._dragging.nativeBounds.x,this._dragging.bounds.y-this._dragging.nativeBounds.y]:(this._dragging.doNotCheckDelay=!0,[a,b])},inBounds:function(a,b,c){var d=[a+this._dragging.nativeBounds.x,b+this._dragging.nativeBounds.y],e=this._draggingOptions.inBounds;return d[0]<e.x?a=e.x-this._dragging.nativeBounds.x:d[0]+this._dragging.bounds.width>e.x2&&(a=e.x2-this._dragging.nativeBounds.x-this._dragging.bounds.width),d[1]<e.y?b=e.y-this._dragging.nativeBounds.y:d[1]+this._dragging.bounds.height>e.y2&&(b=e.y2-this._dragging.nativeBounds.y-this._dragging.bounds.height),[a,b]},axis:function(a,b,c){return"x"===this._draggingOptions.axis?b=this._dragging.bounds.y-this._dragging.nativeBounds.y:"y"===this._draggingOptions.axis&&(a=this._dragging.bounds.x-this._dragging.nativeBounds.x),[a,b]},moveWith:function(a,b,c){return this._draggingOptions.moveWith.forEach(function(a){},this),[a,b]},grid:function(a,b,c){var d=this._draggingOptions.grid;return[a-a%d[0],b-b%d[1]]},helper:function(a,b,c){return this._dragging.helper&&(this._dragging.helperTranslation&&(a+=this._dragging.helperTranslation[0],b+=this._dragging.helperTranslation[1]),this._dragging.helper.attr("translate",[a,b])),[this._dragging.bounds.x-this._dragging.nativeBounds.x,this._dragging.bounds.y-this._dragging.nativeBounds.y]}};R.editors.__commonControls={style:{radius:5,color:"#0af",opacity:.3},point:function(a,b){return ctx.circle({cx:a,cy:b,radius:this.style.radius,fill:this.style.color,stroke:this.style.stroke,opacity:this.style.opacity})},border:function(a,b,c,d){return ctx.rect({x:a,y:b,width:c,height:d,stroke:this.style.color,opacity:this.style.opacity})}},R.editors.transform={enable:function(b){var c=b.bounds();if(b._editorTransform)b._editorTransform.border.attr("visible",!0),b._editorTransform.lt.attr("visible",!0),b._editorTransform.lb.attr("visible",!0),b._editorTransform.rt.attr("visible",!0),b._editorTransform.rb.attr("visible",!0);else{var d,e,f,g,h,i=this.__controls;b._editorTransform={border:h=i.border(c.x,c.y,c.width,c.height),lt:d=i.point(c.x1,c.y1),lb:e=i.point(c.x1,c.y2),rt:f=i.point(c.x2,c.y1),rb:g=i.point(c.x2,c.y2)};var j,k,l,m;a.addEventListener("mouseup",function(){j=k=l=m=null}),a.addEventListener("mousemove",function(a){var c=b.context.contextCoords(a.clientX,a.clientY);j?(d.attr({cx:c[0],cy:c[1]}),e.attr("cx",c[0]),f.attr("cy",c[1]),h.attr({x1:c[0],y1:c[1]}),b.transform(null),b.scale(h.attr("width")/j.width,h.attr("height")/j.height,"rb")):k&&(e.attr({cx:c[0],cy:c[1]}),d.attr("cx",c[0]),g.attr("cy",c[1]),h.attr({x1:c[0],y2:c[1]}),b.transform(null),b.scale(h.attr("width")/k.width,h.attr("height")/k.height,"rt"))}),d.on("mousedown",function(){j=b.bounds()}),e.on("mousedown",function(){k=b.bounds()}),f.on("mousedown",function(){l=b.bounds()}),g.on("mousedown",function(){m=b.bounds()})}},disable:function(a){},attr:function(a,b){},__controls:R.editors.__commonControls},G.prototype.toSVG=function(a,b){},H.prototype.toSVGGetStyle=function(){var a=[];if(this.styles.fillStyle?this.styles.fillStyle+""===this.styles.fillStyle&&a.push('fill="rgba('+R.color(this.styles.fillStyle).join(",")+')"'):a.push('fill="transparent"'),console.log(this.styles),this.styles.strokeStyle){this.styles.strokeStyle+""===this.styles.strokeStyle&&a.push('stroke="rgba('+R.color(this.styles.strokeStyle).join(",")+')"');var c=this.styles.lineWidth;c===b&&(c=1),a.push('stroke-width="'+c+'"')}return" "+a.join(" ")},J.prototype.toSVG=function(a,b){return'<rect x="'+this.attrs.x+'" y="'+this.attrs.y+'" width="'+this.attrs.width+'" height="'+this.attrs.height+'"'+this.toSVGGetStyle()+"/>"},R.drawGradientCurve=function(a,b){var c,d;d=a.curve(0);for(var e=1;e<a.detail;e++)c=a.curve(e/a.detail),b.beginPath(),b.moveTo(d[0],d[1]),b.lineTo(c[0],c[1]),b.lineWidth=a.width(e/a.detail),b.stroke(),d=c},H.prototype.attrHooks.shadow={set:function(a){this._useEnhancedShadow=!(a+""===a||a.length===b&&!1!==a.opacityDependence&&+a.opacity!==a.opacity&&+a.size!==a.size),this._useEnhancedShadow?(delete this.styles.shadowOffsetX,delete this.styles.shadowOffsetY,delete this.styles.shadowBlur,delete this.styles.shadowColor,a.length||(a=[a])):H.processShadow(a,this.styles),this.update()}};var pa=1e3,qa=K.prototype.draw;K.prototype.draw=function(a){if(this._useEnhancedShadow){a.save(),a.translate(-pa,-pa);this.attrs.shadow.forEach(function(b){a.shadowOffsetX=(b.x||0)+pa,a.shadowOffsetY=(b.y||0)+pa,a.shadowColor=b.color,a.shadowBlur=b.blur||0,b.size&&b.size,qa.call(this,a)},this),a.restore()}qa.call(this,a)},R.intersections={},R.intersections.lineIntersection=A,R.intersections.segmentIntersection=B,R.intersections.segmentQuadIntersection=C,R.intersections.pointInRect=D,R.intersections.evenOddRule=z,R.intersections.rectIntersect=E,R.intersections.polyIntersections=F,Z(G.prototype.eventsHooks,{mousedrag:function(){function b(a,b){var i=!0;a.cancelContextPropagation=function(){i=!1},a.lastX=g,a.lastY=h,a.startX=d,a.startY=e,a.startObject=f,c._processPointParams(a,b,a),i&&!c.fire(b,a)&&(a.stopPropagation(),a.preventDefault())}var c=this,d=null,e=null,f=null,g=null,h=null;this.on("mousedown",function(a){d=a.contextX,e=a.contextY,f=a.targetObject}),a.addEventListener("mouseup",function(a){null!==g&&(b(a,"mousedragend"),d=null,e=null)}),a.addEventListener("mousemove",function(a){null!==d&&(b(a,"mousedrag"),g=a.contextX,h=a.contextY)})}}),G.prototype.eventsHooks.mousedragend=G.prototype.eventsHooks.mousedrag,R.version="1.9.0",R.query=function(a,b,c,d){return a+""===a&&(a=(d||S).querySelectorAll(a)[c||0]),new R.contexts[b||"2d"](a.canvas||a)},R.id=function(a,b){return new R.contexts[b||"2d"](S.getElementById(a))},"object"==typeof module&&"object"==typeof module.exports?module.exports=R:"function"==typeof define&&define.amd?define("Delta",[],function(){return R}):a.Delta=R}("undefined"!=typeof window?window:this);