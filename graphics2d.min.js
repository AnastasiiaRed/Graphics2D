!function(s,h){var e,a,i,r,n,o,c,u,l,f,d={},p=s.document,m=Object.prototype.toString,g=Array.prototype.slice,y=Function.prototype.call.bind(Object.prototype.hasOwnProperty),v=/^\d*\.\d+$/,b=/^(\d+|(\d+)?\.\d+)(em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|px|pt|pc)?$/,x=s.URL||s.webkitURL||s,w={mouse:["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","mousewheel","blur","focus"],touch:["touchstart","touchmove","touchend","touchcancel"],pointer:["pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture"],keyboard:["keypress","keydown","keyup"]},k=s.requestAnimationFrame||s.webkitRequestAnimationFrame||s.mozRequestAnimationFrame||s.oRequestAnimationFrame||s.msRequestAnimationFrame||function(t){return s.setTimeout(t,1e3/60)};s.cancelAnimationFrame||s.webkitCancelAnimationFrame||s.mozCancelAnimationFrame||s.oCancelAnimationFrame||s.msCancelAnimationFrame||s.cancelRequestAnimationFrame||s.webkitCancelRequestAnimationFrame||s.mozCancelRequestAnimationFrame||s.oCancelRequestAnimationFrame||s.msCancelRequestAnimationFrame||s.clearTimeout;function O(t){return t.constructor===String}function A(t){return t.constructor===Object}function C(t){return Array.isArray(t)}function M(t,e,r,s){r<0&&(t-=r=-r),s<0&&(e-=s=-s),this.x=this.x1=t,this.y=this.y1=e,this.w=this.width=r,this.h=this.height=s,this.x2=t+r,this.y2=e+s,this.cx=t+r/2,this.cy=e+s/2}function A(t){return"[object Object]"===m.call(t)}function P(t){return+t===t||t+""===t&&b.test(t)}d.renderers={},d.xtypes={rect:d.Rect,circle:d.Circle,path:d.Path,curve:d.Curve,image:d.Image,text:d.Text,gradient:d.Gradient,pattern:d.Pattern},d.bounds=function(t,e,r,s){return new M(t,e,r,s)},d.Class=F,d.Bounds=M,d.argument=function(e){return function(t){return this.argument(e,t)}},d.wrap=function(t,e){var r=t[e];return t=g.call(t,e+1),function(){this[r].apply(this,t)}},d.isObject=A,d.isNumberLike=P,d.isPatternLike=function(t){return t instanceof Image||A(t)&&y(t,"image")||t+""===t&&!(t.indexOf("http://")&&t.indexOf("https://")&&t.indexOf("./")&&t.indexOf("../")&&t.indexOf("data:image/")&&t.indexOf("<svg"))},d.dashes={shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},d.fileTypes={jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",webp:"image/webp"},d.corners={left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],center:[.5,.5],"left top":[0,0],"top left":[0,0],"left bottom":[0,1],"bottom left":[0,1],"right top":[1,0],"top right":[1,0],"right bottom":[1,1],"bottom right":[1,1],lt:[0,0],tl:[0,0],lb:[0,1],bl:[0,1],rt:[1,0],tr:[1,0],rb:[1,1],br:[1,1]},d.colors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",chucknorris:"c00000",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},d.coordsOfElement=function(t){var e=t.getBoundingClientRect(),r=s.getComputedStyle(t);return{x:e.left+parseInt(r.borderLeftWidth||0)+parseInt(r.paddingLeft||0),y:e.top+parseInt(r.borderTopWidth||0)+parseInt(r.paddingTop||0)}},d.clone=function(t){var e=new t.constructor;for(var r in t)y(t,r)&&("object"!=typeof t[r]||t[r]instanceof E||t[r]instanceof Image?e[r]=t[r]:e[r]=d.clone(t[r]));return e},d.strParse={functions:function(t){var e=[];return(t=t.split(")")).forEach(function(t){""!==(t=t.trim())&&e.push({args:t.split("(")[1].split(",").map(function(t){return t.trim()}),method:t.match(/[a-z]+/)[0]})}),e},partition:function(t,e){for(var r=[],s="",i=0;i<t.length;i++)-1===e.indexOf(t[i])?s+=t[i]:(""!==s&&(r.push(s),s=""),r.push(t[i]));return""!==s&&r.push(s),r}},d.parseTransform=function(e,s){if(Array.isArray(e.transform))return e.transform;var i=[1,0,0,1,0,0];"attributes"===e.transform?(e.transformOrder||"translate rotate scale skew").split(" ").forEach(function(t){e[t]!==h&&(i=d.transforms[t](i,e[t],s))}):e.transform.split(")").forEach(function(t){if(""!==(t=t.trim())){var e=t.match(/[a-z]+/),r=t.split("(")[1].split(",").map(function(t){return t.trim()});i=d.transforms[e](i,r,s)}});return i},d.transforms={translate:function(t,e){return t[4]+=+e[0],t[5]+=+e[1],t},scale:function(t,e,r){+e===e?e=[e,e]:+e[1]!==e[1]&&(e=[e[0],e[0],e[1]]);var s=r.corner(e[2]||"center");return t=d.transform(t,[1,0,0,1,s[0],s[1]]),t=d.transform(t,[e[0],0,0,e[1],0,0]),t=d.transform(t,[1,0,0,1,-s[0],-s[1]])},skew:function(t,e,r){+e===e?e=[e,e]:+e[1]!==e[1]&&(e=[e[0],e[0],e[1]]),e[0]=+e[0]/180*Math.PI,e[1]=+e[1]/180*Math.PI;var s=r.corner(e[2]||"center");return t=d.transform(t,[1,0,0,1,s[0],s[1]]),t=d.transform(t,[1,Math.tan(e[1]),Math.tan(e[0]),1,0,0]),t=d.transform(t,[1,0,0,1,-s[0],-s[1]])},rotate:function(t,e,r){+e===e&&(e=[e]),e[0]=+e[0]/180*Math.PI;var s=r.corner(e[1]||"center");return t=d.transform(t,[1,0,0,1,s[0],s[1]]),t=d.transform(t,[Math.cos(e[0]),Math.sin(e[0]),-Math.sin(e[0]),Math.cos(e[0]),0,0]),t=d.transform(t,[1,0,0,1,-s[0],-s[1]])}},d.isIdentityTransform=function(t){return 0===t[5]&&0===t[4]&&1===t[3]&&0===t[2]&&0===t[1]&&1===t[0]},d.transform=function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},d.transformPoint=function(t,e){return[t[0]*e[0]+t[2]*e[1]+t[4],t[1]*e[0]+t[3]*e[1]+t[5]]},d.inverseTransform=function(t){var e=t[0]*t[3]-t[2]*t[1];return 0===e?null:[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,-(t[3]*t[4]-t[2]*t[5])/e,(t[1]*t[4]-t[0]*t[5])/e]},d.color=function(t){if(t!==h){if(Array.isArray(t))return t.slice(0,4);if(t+""!==t)throw"Not a color: "+t.toString();if(0!==t.indexOf("rgb"))return"#"===t[0]?(3===(t=t.substring(1)).length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16),1]):t in d.colors?d.color("#"+d.colors[t]):"rand"===t?[Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random()),1]:[0,0,0,0];var e=(t=t.substring(t.indexOf("(")+1,t.length-1).replace(/\s/g,"").split(","))[3];return t=t.slice(0,3).map(function(t,e){return 0<t.indexOf("%")?Math.round(2.55*parseInt(t)):parseInt(t)}),e===h&&(e=1),t.push(Number(e)),t}},d.angleUnit="grad",d.unit="px";var E,T="pt em in cm mm pc ex ch rem v wvh vmin vmax".split(" "),S={px:1,ch:8,cm:37.78125,em:16,ex:7.15625,in:96,mm:3.765625,pc:16,pt:1.328125,rem:16,v:16,vmax:13.65625,vmin:4.78125,wvh:16};function H(t,e){if(t!==h){if(!t)return 0;if(d.snapToPixels&&!e)return Math.round(d.distance(t,!0)/d.snapToPixels)*d.snapToPixels;if(t.constructor===Number)return"px"!==d.unit?d.distance(t+""+d.unit):t;if((t+="").indexOf("px")===t.length-2)return parseInt(t);if(t.constructor!==String)return d.lastDistanceObject=t;var r=t.replace(/[\d\.]+?/g,"");if(t=t.replace(/[^\d\.]+?/g,""),""===r)return t;if(!d.units)if(p){var s=p.createElement("div");p.body.appendChild(s),d.units={},T.forEach(function(t){s.style.width="1"+t,d.units[t]=parseFloat(getComputedStyle(s).width)}),p.body.removeChild(s)}else d.units=S;return 1===d.snapToPixels?Math.round(d.units[r]*t):d.units[r]*t}}function F(i,t){t||(t=i,i=null);var e=function(){return this.initialize&&this.initialize.apply(this,arguments)};if(i){var r=function(){};r.prototype=i.prototype,(e.prototype=new r).superclass=i.prototype,(e.prototype.constructor=e).prototype.super=function(t,e){if(!this.superclass.superclass||!this.superclass.superclass[t])return this.superclass[t].apply(this,e);var r=this.superclass;this.superclass=this.superclass.superclass;var s=r[t].apply(this,e);return this.superclass=i.prototype,s}}return t.mixins&&t.mixins.forEach(function(t){Object.assign(e.prototype,F.mixins[t])}),Object.assign(e.prototype,t),e}function t(t){this.attrs.matrix="dirty",this.update()}d.snapToPixels=1,d.lastDistanceObject=null,d.distance=H,F.mixins={AttrMixin:{attrs:{},attrHooks:{},attr:function(e,t){return e.constructor===Array?e.map(function(t){return this.attr(t)},this):e.constructor!==String?(Object.keys(e).forEach(function(t){this.attr(t,e[t])},this),this):t===h?this.attrHooks[e]&&this.attrHooks[e].get?this.attrHooks[e].get.call(this):this.attrs[e]:(this.attrs[e]=t,this.attrHooks[e]&&this.attrHooks[e].set&&this.attrHooks[e].set.call(this,t),this)},processArguments:function(r,t){if(r[0].constructor===Object)this.attr(r[0]);else{var s={};t.forEach(function(t,e){r[e]!==h&&(s[t]=r[e])},this),this.attr(s)}}},TransformableMixin:{attrHooks:{transform:{set:function(t){this.attrs.matrix=null===t?null:"dirty",this.update()}},transformOrder:{set:t},pivot:{set:t},translate:{get:function(){return this.attrs.translate||[0,0]},set:t},rotate:{get:function(){return this.attrs.rotate||0},set:t},scale:{get:function(){return this.attrs.scale||[1,1]},set:t},skew:{get:function(){return this.attrs.skew||[0,0]},set:t}},calcMatrix:function(){var r,t=this.attrs.transform;return t.constructor===Array?r=new Float32Array(t):"attributes"===t?(r=new Float32Array([1,0,0,1,0,0]),(this.attrs.transformOrder||d.transformOrder).split(" ").forEach(function(t){var e=this.attrs[t];e&&this.transformFunctions[t].call(this,r,e.constructor===Array?e:[e])},this)):(r=new Float32Array([1,0,0,1,0,0]),d.strParse.functions(t).forEach(function(t){this.transformFunctions[t.method].call(this,r,t.args)},this)),this.attrs.matrix=r},transformFunctions:{pivot:function(t){return t&&-1<t.indexOf(";")?(t=t.split(";"),[Number(t[0].trim()),Number(t[1].trim())]):this.corner(t||this.attrs.pivot,{transform:"none"})},translate:function(t,e){var r=Number(e[0]),s=Number(e[1]);e[2]?(t[4]+=r,t[5]+=s):(t[4]=t[0]*r+t[2]*s+t[4],t[5]=t[1]*r+t[3]*s+t[5])},matrix:function(t,e){var r=t[0],s=t[1],i=t[2],n=t[3],a=t[4],o=t[5];t[0]=r*e[0]+i*e[1],t[1]=s*e[0]+n*e[1],t[2]=r*e[2]+i*e[3],t[3]=s*e[2]+n*e[3],t[4]=r*e[4]+i*e[5]+a,t[5]=s*e[4]+n*e[5]+o},lmatrix:function(t,e){this.transformFunctions.matrix.call(this,e,t)},rotate:function(t,e){var r=this.transformFunctions.pivot.call(this,e[1]),s=Number(e[0])*Math.PI/180,i=Math.cos(s),n=Math.sin(s);this.transformFunctions.matrix.call(this,t,[i,n,-n,i,-r[0]*i+r[1]*n+r[0],-r[0]*n-r[1]*i+r[1]])},scale:function(t,e){isNaN(e[1])&&(e[2]=e[1],e[1]=e[0]);var r=Number(e[0]),s=Number(e[1]),i=this.transformFunctions.pivot.call(this,e[2]);this.transformFunctions.matrix.call(this,t,[r,0,0,s,-i[0]*r+i[0],-i[1]*s+i[1]])},skew:function(t,e){isNaN(e[1])&&(e[2]=e[1],e[1]=e[0]);var r=Math.tan(Number(e[0])*Math.PI/180),s=Math.tan(Number(e[1])*Math.PI/180),i=this.transformFunctions.pivot.call(this,e[2]);this.transformFunctions.matrix.call(this,t,[1,s,r,1,-i[1]*r,-i[0]*s])}}},EventMixin:{listeners:{},eventHooks:{},on:function(e,t,r){return e.constructor!==String?Object.keys(e).forEach(function(t){this.on(t,e[t])},this):(t&&(t.constructor===Function?(r=t,t=null):t.constructor===String&&Array.prototype.splice.call(arguments,1,0,null)),r.constructor===String&&(i=(s=arguments)[2],r=function(){return this[i].apply(this,Array.prototype.slice.call(s,3))}),this.listeners[e]||(this.listeners[e]=[],this.eventHooks[e]&&this.eventHooks[e].init&&this.eventHooks[e].init.call(this,e)),this.listeners[e].push({callback:r,options:t})),this;var s,i},off:function(t,e){var r=this.listeners[t],s=this.eventHooks[t];if(r)if(e){for(var i=0;i<r.length;i++)if(r[i].callback===e){r.splice(i,1);break}s&&!r.length&&s.teardown&&(this.listeners[t]=null,s.teardown.call(this,t))}else this.listeners[t]=null,s&&s.teardown&&s.teardown.call(this,t);return this},fire:function(t,e,r){var s=this.listeners[t];return s&&(r&&(s=s.filter(r,this)),s.forEach(function(t){t.callback.call(this,e)},this)),this}},LinkMixin:{links:[],pushLink:function(){},callLinks:function(t){}}},d.transformOrder="translate rotate scale skew",F.attr=function(e,t){if(Array.isArray(e))return e.map(function(t){return this.attr(t)},this);if(e+""!==e)return Object.keys(e).forEach(function(t){this.attr(t,e[t])},this),this;if(1===arguments.length)return this.attrHooks[e]&&this.attrHooks[e].get?this.attrHooks[e].get.call(this):this.attrs[e];if(this.attrHooks[e]&&this.attrHooks[e].set){var r=this.attrHooks[e].set.call(this,t);null!==r&&(this.attrs[e]=r===h?t:r)}else this.attrs[e]=t;return this},(a=new F({initialize:function(t,e,r){this.setParams(t||a.default.duration,e||a.default.easing,r)},paused:!1,setParams:function(t,e,r){if(t&&(this.duration=t),e)if(e.constructor===String){var s=e.indexOf("(");-1!==s&&(this.easingParam=e.substring(s+1,e.length-1),e=e.substring(0,s)),this.easing=a.easing[e]}else this.easing=e;r&&(this.callback=r)},play:function(t,e){this.prePlay&&this.prePlay(),t&&(this.tick=t),e&&(this.tickContext=e),this.startTime=Date.now(),this.endTime=this.startTime+this.duration,a.queue.length||k(a.do),a.queue.push(this)},pause:function(){this.paused=!0,this.pauseTime=Date.now()},continue:function(){if(this.paused){var t=this.pauseTime-this.startTime;this.startTime=Date.now()-t,this.endTime=this.startTime+this.duration,a.queue.length||k(a.do),this.paused=!1}},cancel:function(){var t=a.queue.indexOf(this);-1<t&&a.queue.splice(t,1)}})).queue=[],a.do=function(){for(var t,e,r=Date.now(),s=0;s<a.queue.length;s++)(t=a.queue[s]).paused||(e=(r-t.startTime)/t.duration)<0||(1<e&&(e=1),t.now=r,t.pos=t.easing(e,t.easingParam),t.tick.call(t.tickContext,t),1===e&&(t.callback&&k(function(){t.callback.call(t.tickContext,t)}),t.queue&&(t.queue.shift(),t.queue[0]&&t.queue[0].play()),a.queue.splice(a.queue.indexOf(t),1)));a.queue.length&&k(a.do)},a.animationsOfElem=function(t){for(var e=[],r=0;r<a.queue.length;r++)a.queue[r].elem===t&&e.push(a.queue[r]);return e},a.animationByName=function(t){for(var e=[],r=0;r<a.queue.length;r++)a.queue[r].name===t&&e.push(a.queue[r]);return e},F.mixins.AnimatableMixin={animQueue:[],animate:function(e,t,r,s,i){var n;if(e.constructor!==String&&(i=s,s=r,r=t,t=null),r&&r.constructor===Object||(r&&r.constructor===Function&&(i=r,r=null),r={duration:r||a.default.duration,easing:s||a.default.easing,callback:i}),e instanceof a)(n=e).setParams(r.duration,r.easing,r.callback);else{if(n=new a(r.duration,r.easing,r.callback),e.constructor===String){if(n.prop=e,n.tick=this.attrHooks[e].anim,n.prePlay=function(){this.attrHooks[e].preAnim.call(this,n,t),this.attrs.animation=n}.bind(this),!this.attrHooks[e]||!this.attrHooks[e].anim)throw'Animation for "'+e+'" is not supported'}else n.prop=Object.keys(e).map(function(t){var e=new a;return e.prop=t,e.tick=this.attrHooks[t].anim,e.tickContext=this,e},this),n.tick=function(e){e.prop.forEach(function(t){t.now=e.now,t.pos=e.pos,this.attrHooks[t.prop].anim.call(this,t)},this)},n.prePlay=function(){n.prop.forEach(function(t){this.attrHooks[t.prop].preAnim.call(this,t,e[t.prop])},this)}.bind(this);n.tickContext=this}return n.elem=this,r.name&&(n.name=r.name),r.ignoreQueue?n.play():(n.queue=this.animQueue,n.queue.push(n),1===n.queue.length&&n.play()),this},pause:function(t,e){return t?a.animationByName(t).forEach(function(t){t.pause()}):e?this.animQueue[0].pause():a.animationsOfElem(this).forEach(function(t){t.pause()}),this},continue:function(t,e){return t?a.animationByName(t).forEach(function(t){t.continue()}):e?this.animQueue[0].continue():a.animationsOfElem(this).forEach(function(t){t.continue()}),this}},a.tick={num:{preAnim:function(t,e){t.startValue=this.attr(t.prop),t.delta=e-t.startValue,e.constructor===String&&(0===e.indexOf("+=")?t.delta=+e.substr(2):0===e.indexOf("-=")&&(t.delta=-e.substr(2)))},anim:function(t){this.attrs[t.prop]=t.startValue+t.delta*t.pos,this.update()}},numAttr:{anim:function(t){this.attr(t.prop,t.startValue+t.delta*t.pos)}}},a.tick.numAttr.preAnim=a.tick.num.preAnim,a.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},sqrt:function(t){return Math.sqrt(t)},pow:function(t,e){return Math.pow(t,e||6)},expo:function(t,e){return Math.pow(e||2,8*t-8)},sigmoid:function(t,e){return e=-(e||5),(1+Math.exp(e/2))/(1+Math.exp(e*(t-.5)))},circ:function(t){return 1-Math.sin(Math.acos(t))},sine:function(t){return 1-Math.cos(t*Math.PI/2)},back:function(t,e){return Math.pow(t,2)*((e||1.618)*(t-1)+t)},bounce:function(t){for(var e=0,r=1;;e+=r,r/=2)if((7-4*e)/11<=t)return r*r-Math.pow((11-6*e-11*t)/4,2)},elastic:function(t,e){return Math.pow(2,10*--t)*Math.cos(20*t*Math.PI*(e||1)/3)},bezier:function(t,e){}},["quad","cubic","quart","quint"].forEach(function(t,e){a.easing[t]=function(t){return Math.pow(t,e+2)}}),Object.keys(a.easing).forEach(function(r){a.easing[r+"In"]=a.easing[r],a.easing[r+"Out"]=function(t,e){return 1-a.easing[r](1-t,e)},a.easing[r+"InOut"]=function(t,e){return.5<=t?a.easing[r](2*t,e)/2:(2-a.easing[r](2*(1-t),e))/2}}),a.default={duration:500,easing:"swing"},d.animation=function(t,e,r){return new a(t,e,r)},(E=function(t){this.canvas=t,this.context=t.getContext("2d"),this.elements=[],this.listeners={},this.attrs={transform:"attributes",pivot:"center"},this.updateNow=this.updateNow.bind(this)}).prototype={object:function(t){return t.constructor===Function?t={draw:t}:t.xtype,this.push(Object.assign(new e,t))},rect:function(){return this.push(new i(arguments))},circle:function(){return this.push(new r(arguments))},path:function(){return this.push(new o(arguments))},image:function(){return this.push(new c(arguments))},text:function(){return this.push(new u(arguments))},line:function(t,e,r,s,i){return this.path([[t,e],[r,s]],null,i)},quadratic:function(t,e,r,s,i,n,a){return this.path([[t,e],[r,s,i,n]],null,a)},bezier:function(t,e,r,s,i,n,a,o,h){return this.path([[t,e],[r,s,i,n,a,o]],null,h)},arcTo:function(t,e,r,s,i,n,a){return this.path([[t,e],["arcTo",t,e,r,s,i,n]],null,a)},gradient:function(t,e,r,s){return new l(t,e,r,s,this)},pattern:function(t,e){return new f(t,e,this)},push:function(t){if((t.context=this).elements.push(t),t.draw){var e=this.context;if(e.save(),this.attrs.matrix){var r="dirty"!==this.attrs.matrix?this.attrs.matrix:this.calcMatrix();e.setTransform(r[0],r[1],r[2],r[3],r[4],r[5])}else e.setTransform(1,0,0,1,0,0);t.draw(e),e.restore()}return t.update=t.updateFunction,t},update:function(){this._willUpdate||(this._willUpdate=!0,k(this.updateNow))},updateNow:function(){this.fire("beforeUpdate");var e=this.context;if(e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),this.attrs.matrix){var t="dirty"!==this.attrs.matrix?this.attrs.matrix:this.calcMatrix();e.setTransform(t[0],t[1],t[2],t[3],t[4],t[5])}this.elements.forEach(function(t){t.draw(e)}),e.restore(),this._willUpdate=!1,this.fire("afterUpdate")},getObjectInPoint:function(t,e,r){for(var s=this.elements,i=s.length;i--;)if(s[i].isPointIn&&(s[i].attrs.interaction||!r)&&s[i].isPointIn(t,e,"mouse"))return s[i];return null},each:function(t){if(t+""===t){var e=g.call(arguments,1),r=t;t=function(t){t[r].apply(t,e)}}return this.elements.slice().forEach(t,this),this},contextCoords:function(t,e){var r=d.coordsOfElement(this.canvas);return[t-r.x,e-r.y]},corner:function(t){return[this.canvas.width*d.corners[t][0],this.canvas.height*d.corners[t][1]]}},Object.assign(E.prototype,F.mixins.EventMixin,{hoverElement:null,eventHooks:{}}),d.browserCommonEvent={init:function(t){this.eventHooks[t].canvas&&this.canvas.addEventListener(t,this.listeners["_canvasListener_"+t]=this.eventHooks[t].canvas.bind(this))},teardown:function(t){k(function(){this.listeners[t]||this.canvas.removeEventListener(t,this.listeners["_canvasListener_"+t])}.bind(this))},canvas:function(t){t.cancelContextPropagation=function(){},this.fire(t.type,t)}},d.browserMouseEvent={init:d.browserCommonEvent.init,teardown:d.browserCommonEvent.teardown,canvas:function(t){var e=!0;t.cancelContextPropagation=function(){e=!1};var r=this.contextCoords(t.clientX,t.clientY);t.contextX=r[0],t.contextY=r[1],t.targetObject=this.getObjectInPoint(t.contextX,t.contextY,!0),t.targetObject&&t.targetObject.fire&&t.targetObject.fire(t.type,t),e&&this.fire(t.type,t)}},d.browserTouchEvent={init:d.browserCommonEvent.init,teardown:d.browserCommonEvent.teardown,canvas:function(e){var t=!0;e.cancelContextPropagation=function(){t=!1},["touches","changedTouches","targetTouches"].forEach(function(t){e[t]&&Array.prototype.forEach.call(e[t],function(t){var e=this.contextCoords(t.clientX,t.clientY);t.contextX=e[0],t.contextY=e[1],t.targetObject=this.getObjectInPoint(t.contextX,t.contextY,!0)},this)},this),Array.prototype.forEach.call(e.touches,function(t){t.targetObject&&t.targetObject.fire&&e.targetObject.fire(e.type,e)},this),t&&this.fire(e.type,e)}};var j,I=s.document?{mouse:d.browserMouseEvent,touch:d.browserTouchEvent,pointer:d.browserCommonEvent,keyboard:d.browserCommonEvent}:{};function L(t,e){return j||(j=p.createElement("canvas")),j.width=t,j.height=e,j}Object.keys(w).forEach(function(t){w[t].forEach(function(e){E.prototype.eventHooks[e]=I[t],E.prototype[e]=function(t){return t.constructor===Function?this.on(e,t):t.constructor===String?this.on.apply(this,[e].concat(g.call(arguments))):this.fire(t)}})}),Object.assign(E.prototype,F.mixins.AttrMixin,F.mixins.TransformableMixin,{attrHooks:Object.assign({},F.mixins.TransformableMixin.attrHooks,{width:{get:function(){return this.canvas.width},set:function(t){t=H(t),this.canvas.width=t,this.canvas.style.width=t/(this.attrs.dpi||1)+"px",this.update()}},height:{get:function(){return this.canvas.height},set:function(t){t=H(t),this.canvas.height=t,this.canvas.style.height=t/(this.attrs.dpi||1)+"px",this.update()}},dpi:{get:function(){return this.attrs.dpi||1},set:function(t){this.canvas.style.width=this.canvas.width/t+"px",this.canvas.style.height=this.canvas.height/t+"px",this.update()}},smooth:{get:function(t){var e=this.canvas.style.imageRendering;return"pixelated"!==e&&"crisp-edges"!==e},set:function(t){this.canvas.style.imageRendering=t?"initial":"pixelated"}}})}),d.Context=E,d.contexts={"2d":E};var R,q,B="http://www.w3.org/2000/svg";function D(t){Object.assign(this,t)}function N(){this.update()}function e(t){this.listeners={},this.styles={},this.cache={},this.attrs={interaction:!0,visible:!0,transform:"attributes",pivot:"center"},this.animQueue=[],this.argsOrder&&this.processArguments(t,this.argsOrder)}function z(t){Object.assign(this,t)}function _(t){for(var e=new z({}),r=0;r<t.length;r++);return e}function l(t,e,r,s){!O(t)&&e&&(s=r,r=e,e=t,t=l.types.default),this.attrs={},this.updateList=[],this.processArguments([t,e,r,s],this.argsOrder),l.types[this.attrs.type]&&Object.assign(this,l.types[this.attrs.type]),this.initialize&&this.initialize(),this.update=this.updateFunction}e.prototype={initialize:e,updateFunction:function(){return this.context&&this.context.update(),this},update:function(){return this},cloneReducers:{order:"clone",clone:function(t,e,r){var s=new this.constructor([this.attrs]);return!1===r.attrs&&(s.attrs=this.attrs),"no-copy"!==r.events&&(!1===r.events?s.listeners=this.listeners:(s.listeners={},Object.keys(this.listeners).forEach(function(t){s.listeners[t]=this.listeners[t].slice()},this))),r.fills&&this.attrs.fill&&this.attrs.fill.clone&&s.attr("fill",this.attrs.fill.clone(r.fillOptions)),!1!==r.push&&this.context&&this.context.push(s),s}},clone:function(r){return r=Object.assign({clone:!0},r),this.cloneReducers.order.split(" ").reduce(function(t,e){return r[e]===h?t:this.cloneReducers[e].call(this,r[e],t,r)}.bind(this),null)},remove:function(){return this.context.elements.splice(this.context.elements.indexOf(this),1),this.update(),this.context=null,this},isPointInBefore:function(t,e,r){if((r="mouse"===r?this.attrs.interactionProps:r)&&!1!==r.transform){var s=this.getTransform();if(!d.isIdentityTransform(s)){var i=d.inverseTransform(s);return d.transformPoint(i,[t,e])}}return[t,e,r]},boundsReducers:{order:"accuracy transform stroke tight",accuracy:function(t,e,r){return"precise"===t?(this.preciseBounds||this.roughBounds).call(this,r):"rough"===t?(this.roughBounds||this.preciseBounds).call(this,r):void 0},stroke:function(t,e){var r=this.styles.lineWidth;return r&&"ignore"!==t&&(r/=2,"-"===t&&(r=-r),e.lt[0]-=r,e.lt[1]-=r,e.lb[0]-=r,e.rt[1]-=r,e.lb[1]+=r,e.rt[0]+=r,e.rb[0]+=r,e.rb[1]+=r),e},transform:function(t,e){var r,s=this.context&&this.context.attrs.matrix,i=this.attrs.matrix;return"full"===t&&s&&i?("dirty"===s&&(s=this.context.calcMatrix()),"dirty"===i&&(i=this.calcMatrix()),r=d.transform(s,i)):"context"!==t&&"full"!==t||!s?"self"!==t&&"full"!==t||!i||(r="dirty"===i?this.calcMatrix():i):r="dirty"===s?this.context.calcMatrix():s,"none"!==t&&r?{lt:d.transformPoint(r,[e.x1,e.y1]),lb:d.transformPoint(r,[e.x1,e.y2]),rt:d.transformPoint(r,[e.x2,e.y1]),rb:d.transformPoint(r,[e.x2,e.y2])}:{lt:[e.x1,e.y1],lb:[e.x1,e.y2],rt:[e.x2,e.y1],rb:[e.x2,e.y2]}},tight:function(t,e){if(t)return e;var r=Math.min(e.lt[0],e.lb[0],e.rt[0],e.rb[0]),s=Math.min(e.lt[1],e.lb[1],e.rt[1],e.rb[1]);return new M(r,s,Math.max(e.lt[0],e.lb[0],e.rt[0],e.rb[0])-r,Math.max(e.lt[1],e.lb[1],e.rt[1],e.rb[1])-s)}},bounds:function(r){return r=Object.assign({accuracy:"precise",transform:"full",stroke:"ignore",tight:!1},r),this.boundsReducers.order.split(" ").reduce(function(t,e){return r[e]===h?t:this.boundsReducers[e].call(this,r[e],t,r)}.bind(this),null)},corner:function(t,e){return[(e=e instanceof M?e:this.bounds(e)).x+e.w*d.corners[t][0],e.y+e.h*d.corners[t][1]]},preDraw:function(e){if(e.save(),Object.keys(this.styles).forEach(function(t){e[t]=this.styles[t]},this),this.attrs.matrix){var t="dirty"!==this.attrs.matrix?this.attrs.matrix:this.calcMatrix();e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}this.attrs.fill&&this.attrs.fill.toCanvasStyle&&(e.fillStyle=this.attrs.fill.toCanvasStyle(e,this))},postDraw:function(t){this.styles;this.attrs.fill&&t.fill(this.attrs.fillRule),this.attrs.stroke&&t.stroke(),t.restore()},toDataURL:function(t,e){if(e===h){if("function"!=typeof this.bounds)throw"Object #"+this.attr("z")+" can't be rasterized: need the bounds.";e=this.bounds()}t===h?t="image/png":t in d.fileTypes&&(t=d.fileTypes[t]);var r=L(e.width,e.height),s=r.getContext("2d");return s.setTransform(1,0,0,1,-e.x,-e.y),this.draw(s),r.toDataURL(t.type||t,t.quality||1)},toBlob:function(t,e,r,s){},toImageData:function(t){if(t===h){if("function"!=typeof this.bounds)throw"Object #"+this.z()+" can't be rasterized: need the bounds.";t=this.bounds()}var e=L(t.width,t.height).getContext("2d");return e.setTransform(1,0,0,1,-t.x,-t.y),this.draw(e),e.getImageData(0,0,t.width,t.height)}},e.AttrHooks=D,e.processStroke=function(t,e){if(t+""===t){for(var r,s=(t=t.replace(/\s*\,\s*/g,",").split(" ")).length,i=!1,n=!1;s--;)v.test(t[s])?r=parseFloat(t[s]):P(t[s])?e.lineWidth=d.distance(t[s]):"round"===t[s]?(i||(e.lineJoin="round"),n||(e.lineCap=e.lineCap||"round")):"miter"===t[s]||"bevel"===t[s]?(i=!0,e.lineJoin=t[s]):"butt"===t[s]||"square"===t[s]?(n=!0,e.lineCap=t[s]):"["===t[s][0]?e.lineDash=t[s].substr(1,t[s].length-2).split(","):t[s]in d.dashes?e.lineDash=d.dashes[t[s]]:t[s].lastIndexOf("ml")===t[s].length-2?e.miterLimit=+t[s].slice(0,t[s].length-2):0===t[s].indexOf("do")?e.lineDashOffset=d.distance(t[s].slice(2)):e.strokeStyle=t[s];r&&((t=d.color(e.strokeStyle))[3]=r,e.strokeStyle="rgba("+t.join(",")+")")}else{if(t.color!==h&&(e.strokeStyle=t.color),t.opacity!==h&&e.strokeStyle){var a=d.color(e.strokeStyle);a[3]=t.opacity,e.strokeStyle="rgba("+a.join(",")+")"}t.width!==h&&(e.lineWidth=d.distance(t.width)),t.join!==h&&(e.lineJoin=t.join),t.cap!==h&&(e.lineCap=t.cap),t.miterLimit!==h&&(e.miterLimit=t.miterLimit),t.dash!==h&&(t.dash in d.dashes?e.lineDash=d.dashes[t.dash]:e.lineDash=t.dash),t.dashOffset!==h&&(e.lineDashOffset=d.distance(t.dashOffset))}},e.processShadow=function(t,e){if(t+""===t){var r=["shadowOffsetX","shadowOffsetY","shadowBlur"];t=t.replace(/\s*\,\s*/g,",").split(" ");for(var s=0;s<t.length;s++)isNaN(+t[s][0])?e.shadowColor=t[s]:e[r.shift()]=d.distance(t[s])}else t.x!==h&&(e.shadowOffsetX=d.distance(t.x)),t.y!==h&&(e.shadowOffsetY=d.distance(t.y)),t.blur!==h&&(e.shadowBlur=d.distance(t.blur||0)),t.color&&(e.shadowColor=t.color)},Object.assign(e.prototype,F.mixins.EventMixin,{eventHooks:{}}),e.browserCommonEvent={init:function(t){this.context&&this.context.eventHooks[t].init.call(this.context,t)},teardown:function(t){this.context&&this.context.eventHooks[t].teardown.call(this.context,t)}},Array.prototype.concat.call(w.mouse,w.touch,w.pointer,w.keyboard).forEach(function(t){e.prototype.eventHooks[t]=e.browserCommonEvent,e.prototype[t]=E.prototype[t]}),e.browserMouseOverOut=function(t){if(this.hoverElement!==t.targetObject){var e=this.hoverElement;this.hoverElement=t.targetObject,e&&e.fire&&e.fire("mouseout",t),t.targetObject&&t.targetObject.fire&&t.targetObject.fire("mouseover",t)}},e.prototype.eventHooks.mouseover=e.prototype.eventHooks.mouseout={init:function(t){this.context&&!this.context.listeners._specialMouseOverOutHook_&&(this.context.listeners._specialMouseOverOutHook_=e.browserMouseOverOut,this.context.on("mousemove",e.browserMouseOverOut))},teardown:function(t){this.context&&(this.context.listeners._specialMouseOverOutHook_=null,this.context.off("mousemove",e.browserMouseOverOut))}},Object.assign(e.prototype,F.mixins.AttrMixin,F.mixins.TransformableMixin,F.mixins.AnimatableMixin,{attrHooks:D.prototype=Object.assign({},F.mixins.TransformableMixin.attrHooks,{z:{get:function(){return this.context.elements.indexOf(this)},set:function(t){var e=this.context.elements;"top"===t&&(t=e.length),e.splice(this.context.elements.indexOf(this),1),e.splice(t,0,this),this.update()}},visible:{set:N},clip:{set:N},fill:{set:function(t){if(this.attrs.fillLink&&this.attrs.fillLink!==t){var e=this.attrs.fillLink.updateList.indexOf(this);-1!==e&&this.attrs.fillLink.updateList.splice(e,1)}t?t.toCanvasStyle?(t.updateList&&(this.attrs.fillLink=t).updateList.push(this),delete this.styles.fillStyle):this.styles.fillStyle=t:delete this.styles.fillStyle,this.update()},preAnim:function(t,e){if(this.attrs.fill.constructor!==String)throw t.cancel(),"Can't animate non-color fill";t.startValue=d.color(this.attrs.fill),t.endValue=d.color(e),t.delta=[t.endValue[0]-t.startValue[0],t.endValue[1]-t.startValue[1],t.endValue[2]-t.startValue[2],t.endValue[3]-t.startValue[3]]},anim:function(t){this.attrs.fill=this.styles.fillStyle="rgba("+[t.startValue[0]+t.delta[0]*t.pos|0,t.startValue[1]+t.delta[1]*t.pos|0,t.startValue[2]+t.delta[2]*t.pos|0,t.startValue[3]+t.delta[3]*t.pos].join(",")+")",this.update()}},fillRule:{set:N},stroke:{set:function(t){var e={};if(null===t);else if(O(t)){for(var r,s,i=(t=t.replace(/\s*\,\s*/g,",").split(" ")).length,n=!1,a=!1;i--;)v.test(t[i])?r=parseFloat(t[i]):P(t[i])?e.lineWidth=d.distance(t[i]):"round"===t[i]?(n||(e.lineJoin="round"),a||(e.lineCap="round")):"miter"===t[i]||"bevel"===t[i]?(n=!0,e.lineJoin=t[i]):"butt"===t[i]||"square"===t[i]?(a=!0,e.lineCap=t[i]):"["===t[i][0]?e.strokeDash=t[i].substr(1,t[i].length-2).split(","):t[i]in d.dashes?e.strokeDash=d.dashes[t[i]]:t[i].lastIndexOf("ml")===t[i].length-2?e.miterLimit=+t[i].slice(0,t[i].length-2):t[i].indexOf("do")===t[i].length-2?e.strokeDashOffset=d.distance(t[i].slice(0,t[i].length-2)):s=t[i];s&&(r&&((s=d.color(s))[3]=r,s="rgba("+s.join(",")+")"),e.strokeStyle=s)}else{if(t.color!==h&&(e.strokeStyle=t.color),t.opacity!==h&&e.strokeStyle){var o=d.color(e.strokeStyle);o[3]=t.opacity,e.strokeStyle="rgba("+o.join(",")+")"}t.width!==h&&(e.lineWidth=d.distance(t.width)),t.join!==h&&(e.lineJoin=t.join),t.cap!==h&&(e.lineCap=t.cap),t.miterLimit!==h&&(e.miterLimit=t.miterLimit),t.dash!==h&&(t.dash in d.dashes?e.strokeDash=d.dashes[t.dash]:e.strokeDash=t.dash),t.dashOffset!==h&&(e.strokeDashOffset=d.distance(t.dashOffset))}["strokeStyle","lineWidth","lineJoin","lineCap","miterLimit"].forEach(function(t){e[t]?this.styles[t]=e[t]:delete this.styles[t]},this),e.strokeDash?this.attrs.strokeDash=e.strokeDash:delete this.attrs.strokeDash,e.strokeDashOffset?this.attrs.strokeDashOffset=e.strokeDashOffset:delete this.attrs.strokeDashOffset}},shadow:{set:function(t){var e={};if(null===t);else if(O(t)){var r=["shadowOffsetX","shadowOffsetY","shadowBlur"];t=t.replace(/\s*\,\s*/g,",").split(" ");for(var s=0;s<t.length;s++)isNaN(+t[s][0])?e.shadowColor=t[s]:e[r.shift()]=d.distance(t[s])}else t.x!==h&&(e.shadowOffsetX=d.distance(t.x)),t.y!==h&&(e.shadowOffsetY=d.distance(t.y)),t.blur!==h&&(e.shadowBlur=d.distance(t.blur)),t.color&&(e.shadowColor=t.color);["shadowOffsetX","shadowOffsetY","shadowColor","shadowBlur"].forEach(function(t){e[t]?this.styles[t]=e[t]:delete this.styles[t]},this)}},opacity:{get:function(){return this.attrs.opacity===h?1:this.attrs.opacity},set:function(t){this.styles.globalAlpha=+t,this.update()},preAnim:a.tick.numAttr.preAnim,anim:a.tick.numAttr.anim},composite:{set:function(t){this.styles.globalCompositeOperation=t,this.update()}},filter:{set:function(t){Array.isArray(t)&&(t=t.map(function(t){if(O(t))return t;A(t)&&(t=[t]);var e=(R||((R=p.createElement("svg")).setAttribute("xmlns",B),R.setAttribute("version","1.1"),R.defs=p.createElementNS(B,"defs"),R.appendChild(R.defs),p.body.appendChild(R)),R).defs,r=Date.now()+"_"+String(Math.random()).substr(2),s=p.createElementNS(B,"filter");return s.setAttribute("id",r),t.forEach(function(e){var r=p.createElementNS(B,e.effect);Object.keys(e).forEach(function(t){"effect"!==t&&r.setAttribute(t,e[t])}),s.appendChild(r)}),e.appendChild(s),"url(#"+r+")"}).join(" ")),this.styles.filter=t,this.update()}}})}),d.Drawable=e,(i=new F(e,{argsOrder:["x","y","width","height","fill","stroke"],attrHooks:new D({x:{set:function(t){this.attrs.x=H(t),this.update()}},y:{set:function(t){this.attrs.y=H(t),this.update()}},width:{set:function(t){this.attrs.width=H(t),this.update()}},height:{set:function(t){this.attrs.height=H(t),this.update()}},x1:{get:function(){return this.attrs.x},set:function(t){t=H(t),this.attrs.width+=this.attrs.x-t,this.attrs.x=t,this.update()}},y1:{get:function(){return this.attrs.y},set:function(t){t=H(t),this.attrs.height+=this.attrs.y-t,this.attrs.y=t,this.update()}},x2:{get:function(){return this.attrs.x+this.attrs.width},set:function(t){this.attrs.width=H(t)-this.attrs.x,this.update()}},y2:{get:function(){return this.attrs.y+this.attrs.height},set:function(t){this.attrs.height=H(t)-this.attrs.y,this.update()}}}),isPointIn:function(t,e,r){var s=this.attrs.x,i=this.attrs.y,n=this.attrs.width,a=this.attrs.height,o=this.isPointInBefore(t,e,r);return t=o[0],e=o[1],n<0&&(s-=n=-n),a<0&&(i-=a=-a),s<t&&i<e&&t<s+n&&e<i+a},preciseBounds:function(){return new M(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height)},draw:function(t){this.attrs.visible&&(this.preDraw(t),this.attrs.fill&&t.fillRect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height),this.attrs.stroke&&t.strokeRect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height),t.restore())},processPath:function(t){t.beginPath(),t.rect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height)}})).prototype.roughBounds=i.prototype.preciseBounds,["x","y","width","height","x1","x2","y1","y2"].forEach(function(t,e){var r=3<e?a.tick.numAttr:a.tick.num;i.prototype.attrHooks[t].preAnim=r.preAnim,i.prototype.attrHooks[t].anim=r.anim}),d.rect=function(){return new i(arguments)},d.Rect=i,(r=new F(e,{argsOrder:["cx","cy","radius","fill","stroke"],attrHooks:new D({cx:{set:function(t){this.attrs.cx=H(t),this.update()}},cy:{set:function(t){this.attrs.cy=H(t),this.update()}},radius:{set:function(t){this.attrs.radius=H(t),this.update()}}}),isPointIn:function(t,e,r){var s=this.isPointInBefore(t,e,r);return t=s[0],e=s[1],Math.pow(t-this.attrs.cx,2)+Math.pow(e-this.attrs.cy,2)<=Math.pow(this.attrs.radius,2)},preciseBounds:function(){return new M(this.attrs.cx-this.attrs.radius,this.attrs.cy-this.attrs.radius,2*this.attrs.radius,2*this.attrs.radius)},draw:function(t){this.attrs.visible&&(this.preDraw(t),t.beginPath(),t.arc(this.attrs.cx,this.attrs.cy,Math.abs(this.attrs.radius),0,2*Math.PI,!0),this.postDraw(t))},processPath:function(t){t.beginPath(),t.arc(this.attrs.cx,this.attrs.cy,Math.abs(this.attrs.radius),0,2*Math.PI,!0)}})).prototype.roughBounds=r.prototype.preciseBounds,["cx","cy","radius"].forEach(function(t){r.prototype.attrHooks[t].preAnim=a.tick.numAttr.preAnim,r.prototype.attrHooks[t].anim=a.tick.numAttr.anim}),d.circle=function(){return new r(arguments)},d.Circle=r,(n=new F({initialize:function(t,e,r){this.method=t,this.path=r,this.attrs={},this.attrs.args=e,n.canvasFunctions[t]&&(this.attrHooks=n.canvasFunctions[t].attrHooks)},attrHooks:z.prototype={args:{set:function(){this.update()}}},attr:F.attr,clone:function(){var t=d.curve(this.method,this.attrs.args);return Object.assign(t.attrs,this.attrs),t},startAt:function(){var t=this.path.attrs.curves.indexOf(this);return 0===t?[0,0]:this.path.attrs.curves[t-1].endAt()},endAt:function(){return n.canvasFunctions[this.method].endAt?n.canvasFunctions[this.method].endAt(this.attrs.args):null},update:function(){return this.path&&this.path.update(),this},bounds:function(t){return n.canvasFunctions[this.method].bounds?(t||(t=this.startAt()),n.canvasFunctions[this.method].bounds(t,this.attrs.args)):null},process:function(t){t[this.method].apply(t,this.attrs.args)}})).AttrHooks=z,n.canvasFunctions={moveTo:{attrHooks:_(["x","y"]),endAt:function(t){return t.slice()}},lineTo:{attrHooks:_(["x","y"]),bounds:function(t,e){return[t[0],t[1],e[0],e[1]]},endAt:function(t){return t.slice()}},quadraticCurveTo:{attrHooks:_(["hx","hy","x","y"]),bounds:function(t,e){return[Math.min(t[0],e[0],e[2]),Math.min(t[1],e[1],e[3]),Math.max(t[0],e[0],e[2]),Math.max(t[1],e[1],e[3])]},endAt:function(t){return t.slice(2)}},bezierCurveTo:{attrHooks:_(["h1x","h1y","h2x","h2y","x","y"]),bounds:function(t,e){return[Math.min(t[0],e[0],e[2],e[4]),Math.min(t[1],e[1],e[3],e[5]),Math.max(t[0],e[0],e[2],e[4]),Math.max(t[1],e[1],e[3],e[5])]},endAt:function(t){return t.slice(4)}},arc:{attrHooks:_(["x","y","radius","start","end","clockwise"]),bounds:function(t,e){var r=e[0],s=e[1],i=e[2];e[3],e[4],e[5];return[r-i,s-i,r+i,s+i]},endAt:function(t){var e=t[0],r=t[1],s=t[2],i=t[4]-t[3];return t[5]&&(i=-i),[e+Math.cos(i)*s,r+Math.sin(i)*s]}},arcTo:{attrHooks:_(["x1","y1","x2","y2","radius","clockwise"])}},n.fromArray=function(t,e){return!0===t?closePath:t[0]in d.curves?d.curve(t[0],t.slice(1),e):new n({2:"lineTo",4:"quadraticCurveTo",6:"bezierCurveTo"}[t.length],t,e)},d.curves={moveTo:n,lineTo:n,quadraticCurveTo:n,bezierCurveTo:n,arc:n,arcTo:n,closePath:n},d.Curve=n,d.curve=function(t,e,r){return new d.curves[t](t,e,r)},(o=new F(e,{initialize:function(t){t[0].constructor!==Object&&t[1].constructor!==Number&&(t[3]=t[1],t[4]=t[2],t[1]=t[2]=h),this.super("initialize",[t])},argsOrder:["d","x","y","fill","stroke"],attrHooks:new D({d:{set:function(t){this.attrs.curves=o.parse(t,this),this.update()}},x:i.prototype.attrHooks.x,y:i.prototype.attrHooks.y}),curve:function(t,e){return e===h?this.attrs.curves[t]:(isNaN(e[0])||(e=[e]),Array.prototype.splice.apply(this.attrs.d,[t,1].concat(e)),Array.prototype.splice.apply(this.attrs.curves,[t,1].concat(o.parse(e,this,0!==t))),this.update())},before:function(t,e,r){return 0===t&&r&&(this.attrs.curves[0].method="lineTo"),isNaN(e[0])||(e=[e]),Array.prototype.splice.apply(this.attrs.d,[t,0].concat(e)),Array.prototype.splice.apply(this.attrs.curves,[t,0].concat(o.parse(e,this,0!==t))),this.update()},after:function(t,e){return this.before(t+1,e)},remove:function(t){return t===h?this.super("remove"):(this.attrs.curves[t].path=null,this.attrs.curves.splice(t,1),this.attrs.d.splice(t,1),this.update())},push:function(t,e){return e?(this.attrs.d.push([t].concat(e)),this.attrs.curves.push(d.curve(t,e,this))):(this.attrs.d=this.attrs.d.concat(t),this.attrs.curves=this.attrs.curves.concat(o.parse(t,this,0!==this.attrs.d.length))),this.update()},each:function(){return Array.prototype.forEach.apply(this.attrs.curves,arguments),this},map:function(){return Array.prototype.map.apply(this.attrs.d,arguments)},moveTo:function(t,e){return this.push("moveTo",[t,e])},lineTo:function(t,e){return this.push("lineTo",[t,e])},quadraticCurveTo:function(t,e,r,s){return this.push("quadraticCurveTo",[t,e,r,s])},bezierCurveTo:function(t,e,r,s,i,n){return this.push("bezierCurveTo",[t,e,r,s,i,n])},arcTo:function(t,e,r,s,i,n){return this.push("arcTo",[t,e,r,s,i,!!n])},arc:function(t,e,r,s,i,n){return this.push("arc",[t,e,r,s,i,!!n])},closePath:function(){return this.push("closePath",[])},isPointIn:function(t,e,r){var s=this.isPointInBefore(t,e,r);t=s[0],e=s[1];var i=this.context.context;i.save(),(this.attrs.x||this.attrs.y)&&i.translate(this.attrs.x||0,this.attrs.y||0),this.process(i);var n=i.isPointInPath(t,e);return i.restore(),n},roughBounds:function(t,e){for(var r,s=1/0,i=1/0,n=-1/0,a=-1/0,o=[0,0],h=0;h<this.attrs.curves.length;h++)r=this.attrs.curves[h].bounds(o),o=this.attrs.curves[h].endAt()||o,r&&(s=Math.min(s,r[0],r[2]),n=Math.max(n,r[0],r[2]),i=Math.min(i,r[1],r[3]),a=Math.max(a,r[1],r[3]));return new M(s+(this.attrs.x||0),i+(this.attrs.y||0),n-s,a-i)},process:function(e){e.beginPath(),this.attrs.curves.forEach(function(t){t.process(e)})},draw:function(t){this.attrs.visible&&(this.preDraw(t),(this.attrs.x||this.attrs.y)&&t.translate(this.attrs.x||0,this.attrs.y||0),this.process(t),this.postDraw(t))}})).args=["d","x","y","fill","stroke"],o.parse=function(t,e,r){if(!t)return[];if(t.constructor===String)return o.parseString(t,e,r);if(t instanceof n)return t.path=e,[t];t[0]===h||+t[0]!==t[0]&&t[0]+""!==t[0]||(t=[t]);var s=[];if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i]instanceof n?(s.push(t[i]),t[i].path=e):0!==i||r?s.push(n.fromArray(t[i],e)):s.push(new n("moveTo",isNaN(t[i][0])?t[i].slice(1):t[i],e));return s},o.parseString=function(t,e,r){throw"String path data is not supported"},d.path=function(){return new o(arguments)},d.Path=o,(c=new F(e,{argsOrder:["image","x","y","width","height","crop"],attrHooks:new D({image:{set:function(t){return(t=this.attrs.image=c.parse(t)).complete&&this.update(),t.addEventListener("load",c.onImageLoadedCallback.bind(this)),t.addEventListener("error",c.onImageErrorCallback.bind(this)),t}},x:i.prototype.attrHooks.x,y:i.prototype.attrHooks.y,width:i.prototype.attrHooks.width,height:i.prototype.attrHooks.height,x1:i.prototype.attrHooks.x1,y1:i.prototype.attrHooks.y1,x2:i.prototype.attrHooks.x2,y2:i.prototype.attrHooks.y2,crop:{set:function(t){this.attrs.crop=t.map(H),this.update()}},smooth:{get:function(){return this.attrs.smooth||!0},set:function(t){this.styles.imageSmoothingEnabled=!!t,this.update()}}}),remove:function(){this.super("remove"),this.attrs.image.blob&&x.revokeObjectURL(this.attrs.image.blob)},getRealSize:function(){var t=this.attrs.width===h?"auto":this.attrs.width,e=this.attrs.height===h?"auto":this.attrs.height;return"auto"===t&&"auto"===e&&(t=e="native"),"auto"===t?t=this.attrs.image.width*(e/this.attrs.image.height):"native"===t&&(t=this.attrs.image.width),"auto"===e?e=this.attrs.image.height*(t/this.attrs.image.width):"native"===e&&(e=this.attrs.image.height),[t,e]},preciseBounds:function(){var t=this.getRealSize();return new M(this.attrs.x,this.attrs.y,t[0],t[1])},isPointIn:function(t,e){var r=this.isPointInBefore(t,e,options);t=r[0],e=r[1];var s=this.getRealSize();return t>this.attrs.x&&e>this.attrs.y&&t<this.attrs.x+s[0]&&e<this.attrs.y+s[1]},draw:function(t){if(this.attrs.visible){this.preDraw(t);var e=this.getRealSize(),r=this.attrs.crop;r?t.drawImage(this.attrs.image,r[0],r[1],r[2],r[3],this.attrs.x,this.attrs.y,e[0],e[1]):t.drawImage(this.attrs.image,this.attrs.x,this.attrs.y,e[0],e[1]),t.restore()}}})).args=["image","x","y","width","height","crop"],c.parse=function(t){if(O(t)){if("#"===t[0])return p.getElementById(t.substr(1));if("<svg"!==t[0]){var e=new Image;return e.src=t,e}var r=new Blob([t],{type:"image/svg+xml;charset=utf-8"});(t=new Image).src=x.createObjectURL(r),t.blob=r}return t},c.onImageLoadedCallback=function(t){this.update(),this.fire("load",t)},c.onImageErrorCallback=function(t){this.fire("error",t)},d.image=function(){return new c(arguments)},d.Image=c,(u=new F(e,{initialize:function(t){this.super("initialize",arguments),this.attrs.baseline||(this.styles.textBaseline=this.attrs.baseline=u.baseline)},argsOrder:["text","x","y","font","fill","stroke"],attrHooks:new D({text:{set:function(t){this.lines=null,this.attrs.text=t+"",this.update()}},x:i.prototype.attrHooks.x,y:i.prototype.attrHooks.y,font:{get:function(){return this.attrs.font||u.font},set:function(t){t?(this.attrs.parsedFont=u.parseFont(t),this.styles.font=u.genFont(this.attrs.parsedFont)):(delete this.attrs.parsedFont,delete this.styles.font),this.update()}},align:{get:function(){return this.styles.textAlign||"left"},set:function(t){this.styles.textAlign=t,this.update()}},baseline:{get:function(){return this.styles.textBaseline},set:function(t){this.styles.textBaseline=t,this.update()}},mode:{get:function(){return this.attrs.mode||"string"},set:N},maxStringWidth:{get:function(){return this.attrs.maxStringWidth||1/0},set:function(t){t&&(this.attrs.maxStringWidth=H(t)),this.update()}},trimLines:{get:function(){return!1!==this.attrs.trimLines},set:function(){this.lines=null,this.update()}},lineHeight:{get:function(){return this.attrs.lineHeight||"auto"},set:function(t){t&&(this.attrs.lineHeight=H(t)),this.lines=null,this.update()}},blockWidth:{get:function(){return this.attrs.blockWidth||1/0},set:function(t){t&&(this.attrs.blockWidth=H(t)),this.lines=null,this.update()}}}),lines:null,processLines:function(n){var t=this.attrs.text,a=this.lines=[],o="auto"!==(this.attrs.lineHeight||"auto")?this.attrs.lineHeight:this.attrs.parsedFont?this.attrs.parsedFont.size:u.parseFont(u.font).size,h=this.attrs.blockWidth||1/0;"center"===this.styles.textAlign||this.styles.textAlign;return n.save(),n.font=this.styles.font,t.split("\n").forEach(function(t){if(n.measureText(t).width<=h)a.push({text:t,y:o*a.length});else{for(var e,r=d.strParse.partition(t,u.wordSeparators),s="",i=0;i<r.length;i++)e=s+r[i],s=n.measureText(e).width<=h?e:(a.push({text:s,y:o*a.length}),r[i]);a.push({text:s,y:o*a.length})}}),!1!==this.attrs.trimLines&&a.forEach(function(t){t.text=t.text.trim()}),n.restore(),this},draw:function(e){if(this.attrs.visible){if(this.preDraw(e),"block"===this.attrs.mode){this.lines||this.processLines(e);var r=this.attrs.x,s=this.attrs.y;this.attrs.fill&&!this.attrs.stroke?this.lines.forEach(function(t){e.fillText(t.text,r,s+t.y)}):this.attrs.fill?this.lines.forEach(function(t){e.fillText(t.text,r,s+t.y),e.strokeText(t.text,r,s+t.y)}):this.lines.forEach(function(t){e.strokeText(t.text,r,s+t.y)})}else{var t=this.attrs.maxStringWidth<1/0?this.attrs.maxStringWidth:h;this.styles.fillStyle&&e.fillText(this.attrs.text,this.attrs.x,this.attrs.y,t),this.styles.strokeStyle&&e.strokeText(this.attrs.text,this.attrs.x,this.attrs.y,t)}e.restore()}},isPointIn:function(t,e,r){var s=this.isPointInBefore(t,e,r);t=s[0],e=s[1];var i=this.bounds(!1);return t>i.x1&&e>i.y1&&t<i.x2&&e<i.y2},measure:function(){var t,r=this.context?this.context.context:L(0,0).getContext("2d");return r.save(),r.font=this.styles.font,t="block"===this.attrs.mode?(this.lines||this.processLines(r),this.lines.reduce(function(t,e){return e=r.measureText(e.text).width,Math.max(e,t)},0)):r.measureText(this.attrs.text).width,r.restore(),t},preciseBounds:function(t){var e,r=this.attrs.x,s=this.attrs.y,i=this.attrs.parsedFont?this.attrs.parsedFont.size:u.parseFont(u.font).size,n="auto"===(this.attrs.lineHeight||"auto")?i:this.attrs.lineHeight;"block"===this.attrs.mode?(e=this.attrs.blockWidth,"inline"!==t.blockWidth&&isFinite(e)||(e=this.measure()),this.lines||this.processLines(this.context?this.context.context:L(0,0).getContext("2d")),n*=this.lines.length):(e=this.measure(),this.attrs.maxStringWidth<e&&(e=this.attrs.maxStringWidth));var a=this.styles.textBaseline,o=this.styles.textAlign;return"middle"===a?s-=i/2:"bottom"===a||"ideographic"===a?s-=i:"alphabetic"===a&&(s-=.8*i),"center"===o?r-=e/2:"right"===o&&(r-=e),new M(r,s,e,n)}})).baseline="top",u.font="10px sans-serif",u.parseFont=function(t){if(t+""!==t)return t;var e={family:""};return t.split(" ").forEach(function(t){"bold"===t?e.bold=!0:"italic"===t?e.italic=!0:b.test(t)?e.size=H(t):e.family+=" "+t}),e.family=e.family.trim(),e},u.genFont=function(t){var e="";return t.italic&&(e+="italic "),t.bold&&(e+="bold "),e+(t.size||10)+"px "+(t.family||"sans-serif")},u.wordSeparators=[" ","-"],d.text=function(){return new u(arguments)},d.Text=u,l.AttrHooks=function(t){Object.assign(this,t)},Object.assign(l.prototype,F.mixins.AttrMixin,{argsOrder:["type","colors","from","to"],cached:null,attrHooks:l.AttrHooks.prototype={colors:{set:function(t){this.cached=null,this.attrs.colors=l.parseColors(t),this.update()}}},update:function(){return this},updateFunction:function(){return this.updateList.forEach(function(t){t.update()}),this},clone:function(){return new l(this.attrs)},color:function(t,e){for(var r=0,s=this.attrs.colors=this.attrs.colors.sort(function(t,e){return t[0]>e[0]?1:-1});s[r][0]<t&&++r<s.length;);if(e!==h&&e.constructor!==Boolean)return this.cached=null,s[r]&&s[r][0]===t?s[r][1]=e:s.push([t,e]),this.update();if(s[r]&&s[r][0]===t)return d.color(s[r][1]);if(!1===e)return null;if(t<s[0][0])return d.color(s[0][1]);if(t>s[s.length-1][0])return d.color(s[s.length-1][1]);var i=d.color(s[r-1][1]),n=d.color(s[r][1]);return t=(t-s[r-1][0])/(s[r][0]-s[r-1][0]),[i[0]+(n[0]-i[0])*t+.5|0,i[1]+(n[1]-i[1])*t+.5|0,i[2]+(n[2]-i[2])*t+.5|0,+(i[3]+(n[3]-i[3])*t).toFixed(2)]}}),l.types={default:"linear",linear:{attrHooks:new l.AttrHooks({from:{set:N},to:{set:N}}),toCanvasStyle:function(t,e){var r=O(this.attrs.from)?e.corner(this.attrs.from,this.attrs.boundsOptions):this.attrs.from,s=O(this.attrs.to)?e.corner(this.attrs.to,this.attrs.boundsOptions):this.attrs.to,i=this.attrs.colors,n=r+" "+s;if(this.cached&&this.cached.key===n)return this.cached.grad;var a=t.createLinearGradient(r[0],r[1],s[0],s[1]);return i.forEach(function(t){a.addColorStop(t[0],t[1])}),this.cached={grad:a,key:n},a}},radial:{attrHooks:new l.AttrHooks({from:{set:function(t){C(t)&&2<t.length&&(this.attrs.startRadius=t[2],this.attrs.from=t.slice(0,2)),this.update()}},to:{set:function(t){C(t)&&2<t.length&&(this.attrs.radius=t[2],this.attrs.to=t.slice(0,2)),this.update()}},radius:{get:function(){return this.attrs.radius===h?"auto":this.attrs.radius},set:N},startRadius:{get:function(){return this.attrs.startRadius||0},set:N}}),toCanvasStyle:function(t,e){var r=this.attrs.boundsOptions instanceof M?this.attrs.boundsOptions:e.bounds(this.attrs.boundsOptions),s=O(this.attrs.from)?e.corner(this.attrs.from,r):this.attrs.from,i=O(this.attrs.to)?e.corner(this.attrs.to,r):this.attrs.to,n=this.attrs.startRadius||0,a=isNaN(this.attrs.radius)?Math.max(r.width,r.height):this.attrs.radius,o=this.attrs.colors,h=s+" "+i+" "+n+" "+a;if(this.cached&&this.cached.key===h)return this.cached.grad;var c=t.createRadialGradient(s[0],s[1],n,i[0],i[1],a);return o.forEach(function(t){c.addColorStop(t[0],t[1])}),this.cached={grad:c,key:h},c}}},l.parseColors=function(e){if(C(e[0]))return e.map(function(t){return t.slice()});var r=[];if(C(e)){var s=1/(e.length-1);e.forEach(function(t,e){r.push([s*e,t])})}else Object.keys(e).forEach(function(t){r.push([+t,e[t]])});return r},d.Gradient=l,f=new F({initialize:function(t,e,r){this.image=c.parse(t),this.repeat=e,this.context=r,this.image.addEventListener("load",function(t){this.update(),this.image.blob&&x.revokeObjectURL(blob)}.bind(this))},update:function(){return this.context.update(),this},toCanvasStyle:function(t){return this.image.complete?t.createPattern(this.image,this.repeat||"repeat"):"transparent"}}),d.Pattern=f,(q=new F(E,{initialize:function(t){if(this.gl=this._getAndPrepareGLContext(t),!this.gl)return new d.contexts["2d"](t);this.shaders={},this.buffers={},this.canvas=t,this.elements=[],this.elementsByProgram={},this.listeners={},this.attrs={transform:"attributes",pivot:"center",glBackgroundColor:[255,255,255,1],glDrawOrder:["program-rect"]},this.glMissing=[],this.drawMissing=this.drawMissing.bind(this),this.updateNow=this.updateNow.bind(this)},_getAndPrepareGLContext:function(t){var e;if(e=t.getContext("webgl"));else if(e=t.getContext("experimental-webgl"));else if(e=t.getContext("webkit-3d"));else if(!(e=t.getContext("moz-webgl")))return null;return e.viewport(0,0,t.width,t.height),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT),e},push:function(t){return(t.context=this).elements.push(t),(this.elementsByProgram[t.glProgramName]||(this.elementsByProgram[t.glProgramName]=[])).push(t),t.shadersRequired&&t.shadersRequired.forEach(function(t){this.initShader(t)}.bind(this)),t.drawGL&&(this.glMissing.push(t),this._willDrawMissing||(k(this.drawMissing),this._willDrawMissing=!0)),t},initShader:function(t){if(!this.shaders[t]){if(!q.shadersFactory[t])throw'The shader "'+t+'" is not exist.';this.shaders[t]=q.shadersFactory[t](this.gl,this)}},drawMissing:function(){this._willDrawMissing=!1;var e=this.gl;this.glMissing.forEach(function(t){t.drawGL(e)})},updateNow:function(){var s=this.gl;s.clear(s.COLOR_BUFFER_BIT),this.attrs.glDrawOrder.forEach(function(t){for(var e=this.elementsByProgram[t],r=e.length;r--;){this.elements.indexOf(e[r]),this.elements.length;e[r]._glZIndex=1,e[r].drawGL(s)}},this)}})).shadersFactory={"fragment-common":function(t){return d.createShader(t,t.FRAGMENT_SHADER,["#ifdef GL_ES","precision highp float;","#endif","varying vec4 vColor;","void main(void){","gl_FragColor = vec4(vColor[0] / 255.0, vColor[1] / 255.0, vColor[2] / 255.0, vColor[3]);","}"].join("\n"))}},d.createShader=function(t,e,r){var s=t.createShader(e);if(t.shaderSource(s,r),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS))return s;var i=t.getShaderInfoLog(s);throw t.deleteShader(s),"Shader compilation error: "+i},d.contexts.gl=q,Object.assign(q.shadersFactory,{"vertex-path":function(t){return d.createShader(t,t.VERTEX_SHADER,["attribute vec2 aVertexPosition;","uniform vec4 rectCoords;","uniform vec4 uColor;","varying vec4 vColor;","float canvasWidth = "+t.canvas.width+".0;","float canvasHeight = "+t.canvas.height+".0;","void main(void){","vColor = uColor;","gl_Position = vec4(","aVertexPosition[0],","aVertexPosition[1],","1.0,","1.0",");","}"].join("\n"))},"program-path":function(t,e){var r=t.createProgram();if(t.attachShader(r,e.shaders["vertex-path"]),t.attachShader(r,e.shaders["fragment-common"]),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw"Could not initialize shaders";return t.useProgram(r),r.uColor=t.getUniformLocation(r,"uColor"),r.rectCoords=t.getUniformLocation(r,"rectCoords"),r.v_aVertexPosition=t.getAttribLocation(r,"aVertexPosition"),t.enableVertexAttribArray(r.v_aVertexPosition),r}}),Object.assign(o.prototype,{shadersRequired:["fragment-common","vertex-path","program-path"],drawGL:function(t){var e=this.context;if(!e.buffers.rect){var r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,.5,.5,.5,0,.5,-.5,-1,0]),t.STATIC_DRAW),e.buffers.rect=r}var s=d.color(this.styles.fillStyle);t.uniform4f(e.shaders["program-rect"].uColor,s[0],s[1],s[2],s[3]),t.uniform4f(e.shaders["program-rect"].rectCoords,10,10,200,200),t.vertexAttribPointer(e.shaders["program-rect"].v_aVertexPosition,2,t.FLOAT,!1,0,0),t.drawArrays(t.TRIANGLE_FAN,0,5)}}),Object.assign(q.shadersFactory,{"vertex-rect":function(t){return d.createShader(t,t.VERTEX_SHADER,["attribute vec2 aVertexPosition;","uniform float zIndex;","uniform vec4 rectCoords;","uniform vec4 uColor;","varying vec4 vColor;","float canvasWidth = "+t.canvas.width+".0;","float canvasHeight = "+t.canvas.height+".0;","void main(void){","vColor = uColor;","gl_Position = vec4(","(aVertexPosition[0] * rectCoords[2] / canvasWidth) - 1.0 + rectCoords[2] / canvasWidth + (rectCoords[0] * 2.0 / canvasWidth),","(aVertexPosition[1] * rectCoords[3] / canvasHeight) + 1.0 - rectCoords[3] / canvasHeight - (rectCoords[1] * 2.0 / canvasHeight),","zIndex,","1.0",");","}"].join("\n"))},"program-rect":function(t,e){var r=t.createProgram();if(t.attachShader(r,e.shaders["vertex-rect"]),t.attachShader(r,e.shaders["fragment-common"]),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw"Could not initialize shaders";return t.useProgram(r),r.uColor=t.getUniformLocation(r,"uColor"),r.rectCoords=t.getUniformLocation(r,"rectCoords"),r.zIndex=t.getUniformLocation(r,"zIndex"),r.v_aVertexPosition=t.getAttribLocation(r,"aVertexPosition"),t.enableVertexAttribArray(r.v_aVertexPosition),r}}),Object.assign(i.prototype,{shadersRequired:["fragment-common","vertex-rect","program-rect"],glProgramName:"program-rect",glCreateBuffer:function(t){var e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,1,1,-1,-1,-1,1,1,-1,1]),t.STATIC_DRAW),this.context.buffers.rect=e},drawGL:function(t){var e=this.context;e.buffers.rect||this.glCreateBuffer(t);var r=d.color(this.styles.fillStyle);t.uniform4f(e.shaders["program-rect"].uColor,r[0],r[1],r[2],r[3]),t.uniform4f(e.shaders["program-rect"].rectCoords,this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height),this._glZIndex!==h&&t.uniform1f(e.shaders["program-rect"].zIndex,this._glZIndex),t.vertexAttribPointer(e.shaders["program-rect"].v_aVertexPosition,2,t.FLOAT,!1,0,0),t.drawArrays(t.TRIANGLES,0,6)}}),d.version="1.9.0",d.query=function(t,e,r,s){return t+""===t&&(t=(s||p).querySelectorAll(t)[r||0]),new d.contexts[e||"2d"](t.canvas||t)},d.id=function(t,e){return new d.contexts[e||"2d"](p.getElementById(t))},"object"==typeof module&&"object"==typeof module.exports?module.exports=d:"function"==typeof define&&define.amd?define("Delta",[],function(){return d}):s&&(s.Delta=d)}("undefined"!=typeof window?window:this);