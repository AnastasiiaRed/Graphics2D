!function(a,b){function c(a,b){return J||(J=B.createElement("canvas")),J.width=a,J.height=b,J}function d(a){return L?L:(["mozImageSmoothingEnabled","webkitImageSmoothingEnabled","msImageSmoothingEnabled","imageSmoothingEnabled"].forEach(function(b){b in a&&(L=b)}),L)}function e(a){A.easing[M+"In"]=a,A.easing[M+"Out"]=function(b,c){return 1-a(1-b,c)},A.easing[M+"InOut"]=function(b,c){return b<=.5?a(2*b,c)/2:(2-a(2*(1-b),c))/2}}function f(a,b,c,d){c<0&&(c=-c,a-=c),d<0&&(d=-d,b-=d),this.x=this.x1=a,this.y=this.y1=b,this.w=this.width=c,this.h=this.height=d,this.x2=a+c,this.y2=b+d,this.cx=a+c/2,this.cy=b+d/2}function g(a,b){b||(b=a,a=null);var c=function(){return(this.initialize||C).apply(this,arguments)};if(a){b.liftInits&&(c=function(){if(c.prototype.__initialize__)return c.prototype.__initialize__.apply(this,arguments);for(var a=[],d=this.constructor.parent;d;)a.push(d.prototype.initialize),d=d.parent;for(var e=a.length;e--;)a[e]&&a[e].apply(this,arguments);return c.prototype.initialize&&b.initialize===c.prototype.initialize?c.prototype.initialize.apply(this,arguments):void 0});var d=function(){};d.prototype=a.prototype,c.prototype=new d,c.prototype.superclass=a.prototype,c.prototype.constructor=c,c.prototype.super=function(b,c){if(!this.superclass.superclass||!this.superclass.superclass[b])return this.superclass[b].apply(this,c);var d=this.superclass;this.superclass=this.superclass.superclass;var e=d[b].apply(this,c);return this.superclass=a.prototype,e}}return h(c.prototype,b),c}function h(a,b){return Object.assign(a,b)}function i(a){return function(b){return this.argument(a,b)}}function j(a){var b=a[1];return a=E.call(a,2),function(){this[b].apply(this,a)}}function k(a){return"[object Object]"===D.call(a)}function l(a){return Array.isArray(a)||a in A.corners}function m(a){return+a===a||a+""===a&&A.reNumberLike.test(a)}function n(a){return a instanceof Image||k(a)&&F(a,"image")||a+""===a&&!(a.indexOf("http://")&&a.indexOf("https://")&&a.indexOf("./")&&a.indexOf("../")&&a.indexOf("data:image/")&&a.indexOf("<svg"))}function o(a,c){if(a!==b){if(!a)return 0;if(A.snapToPixels&&!c)return Math.round(A.distance(a,!0)/A.snapToPixels)*A.snapToPixels;if(+a===a)return"px"!==A.unit?A.distance(a+""+A.unit):a;if(a+="",a.indexOf("px")===a.length-2)return parseInt(a);if(!A.units)if(B){var d=B.createElement("div");B.body.appendChild(d),A.units={},N.forEach(function(a){d.style.width="1"+a,A.units[a]=parseFloat(getComputedStyle(d).width)}),B.body.removeChild(d)}else A.units=O;var e=a.replace(/[\d\.]+?/g,"");return a=a.replace(/[^\d\.]+?/g,""),""===e?a:Math.round(A.units[e]*a)}}var p,q,r,s,t,u,v,w,x,y,z,A={},B=a.document,C=function(){},D=Object.prototype.toString,E=Array.prototype.slice,F=Function.prototype.call.bind(Object.prototype.hasOwnProperty),G=/^\d*\.\d+$/,H=a.URL||a.webkitURL||a,I=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){return a.setTimeout(b,1e3/60)};a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.mozCancelAnimationFrame||a.oCancelAnimationFrame||a.msCancelAnimationFrame||a.cancelRequestAnimationFrame||a.webkitCancelRequestAnimationFrame||a.mozCancelRequestAnimationFrame||a.oCancelRequestAnimationFrame||a.msCancelRequestAnimationFrame||a.clearTimeout;A.renderers={},A.renderers["2d"]={init:function(a,b){a.context=b.getContext("2d"),a._cache={}},preRedraw:function(a,b){console.time("Drawing time"),a.save(),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,a.canvas.width,a.canvas.height),b.matrix&&a.setTransform.apply(a,b.matrix)},postRedraw:function(a){a.restore(),console.timeEnd("Drawing time")},drawCircle:function(a,b,c,d,e){this.pre(b,c,d,e),b.beginPath(),b.arc(a[0],a[1],Math.abs(a[2]),0,2*Math.PI,!0),this.post(b,c)},drawRect:function(a,b,c,d,e){this.pre(b,c,d,e),c.fillStyle&&b.fillRect(a[0],a[1],a[2],a[3]),c.strokeStyle&&b.strokeRect(a[0],a[1],a[2],a[3]),b.restore()},drawCircle:function(a,b,c,d,e){this.pre(b,c,d,e),b.beginPath(),b.arc(a[0],a[1],a[2],0,2*Math.PI,!0),c.fillStyle&&b.fill(),c.strokeStyle&&b.stroke(),b.restore()},drawPath:function(a,b,c,d,e){this.pre(b,c,d,e),b.beginPath(),a.forEach(function(a){a.process(b)}),this.post(b,c)},drawImage:function(a,b,c,d,e){switch(this.pre(b,c,d,e),a.length){case 5:b.drawImage(a[0],a[1],a[2],a[3],a[4]);break;case 9:b.drawImage(a[0],a[5],a[6],a[7],a[8],a[1],a[2],a[3],a[4]);break;default:b.drawImage(a[0],a[1],a[2])}b.restore()},drawData:function(a,b,c,d,e){b.putImageData(a[0],a[1],a[2])},drawText:function(a,b,c,d,e){this.pre(b,c,d,e),c.fillStyle&&b.fillText(a[0],a[1],a[2]),c.strokeStyle&&b.strokeText(a[0],a[1],a[2]),b.restore()},makeGradient:function(a,b,c,d,e){if(a.useCache){var f=this.hashGradient(b,c,d,e);if(a._cache[f])return a._cache[f]}var g;return g="linear"===b?a.context.createLinearGradient(c[0],c[1],d[0],d[1]):a.context.createRadialGradient(c[0],c[1],c[2],d[0],d[1],d[2]),Object.keys(e).forEach(function(a){g.addColorStop(a,e[a])}),a.useCache&&(a._cache[f]=g),g},hashGradient:function(a,b,c,d){var e;return d=JSON.stringify(d),e="linear"===a?b[0]===c[0]?["ver",b[1],c[1],d]:b[1]===c[1]?["hor",b[0],c[0],d]:[b[0],b[1],c[0],c[1],d]:[b[0],b[1],b[2],c[0],c[1],c[2],d],e.join(";")},pre:function(a,b,c,d){a.save(),Object.keys(b).forEach(function(c){a[c]=b[c]}),b.fillStyle&&b.fillStyle.toCanvasStyle&&(a.fillStyle=b.fillStyle.toCanvasStyle(a,d)),b.strokeStyle&&b.strokeStyle.toCanvasStyle&&(a.strokeStyle=b.strokeStyle.toCanvasStyle(a,d)),b.lineDash&&(a.setLineDash?a.setLineDash(b.lineDash):a.mozDash=b.lineDash),d.attrs.clip&&(d.attrs.clip.matrix?(a.save(),a.transform.apply(a,d.attrs.clip.matrix),d.attrs.clip.processPath(a),a.restore()):d.attrs.clip.processPath(a),a.clip()),c&&a.transform(c[0],c[1],c[2],c[3],c[4],c[5])},post:function(a,b){b.fillStyle&&a.fill(),b.strokeStyle&&a.stroke(),a.restore()}};var p;p=function(a,b){this.canvas=a,this.elements=[],this.listeners={},this.renderer=A.renderers[b||"2d"],this.renderer.init(this,a),this.updateNowBounded=this.updateNow.bind(this)},p.prototype={object:function(a){return this.push(Object.assign(new q,a))},rect:function(){return this.push(new r(arguments,this))},circle:function(){return this.push(new s(arguments,this))},path:function(){return this.push(new u(arguments,this))},image:function(){return this.push(new v(arguments,this))},raster:function(){return this.push(new w(arguments,this))},text:function(){return this.push(new x(arguments,this))},line:function(a,b,c,d,e){return this.path([[a,b],[c,d]],null,e)},quadratic:function(a,b,c,d,e,f,g){return this.path([[a,b],[c,d,e,f]],null,g)},bezier:function(a,b,c,d,e,f,g,h,i){return this.path([[a,b],[c,d,e,f,g,h]],null,i)},arcTo:function(a,b,c,d,e,f,g){return this.path([[a,b],["arcTo",a,b,c,d,e,f]],null,g)},useCache:!1,gradient:function(a,b,c,d){return new y(a,b,c,d,this)},pattern:function(a,b){return new z(a,b,this)},push:function(a){return a.context=this,this.elements.push(a),a.draw&&a.draw(this.context),a},update:function(){this._willUpdate||(this._willUpdate=!0,I(this.updateNowBounded))},updateNow:function(){var a=this.context;this.renderer.preRedraw(a,this),this.elements.forEach(function(b){b.draw(a)}),this.renderer.postRedraw(a),this._willUpdate=!1},getObjectInPoint:function(a,b,c){for(var d=this.elements,e=d.length;e--;)if(d[e].isPointIn&&d[e].isPointIn(a,b)&&(d[e].attrs.interaction||!c))return d[e];return null},hoverElement:null,focusElement:null,listener:function(a){return this.listeners[a]?this.listeners[a]:(this.listeners[a]=[],this.eventsHooks.hasOwnProperty(a)&&this.eventsHooks[a].call(this,a),this.eventsInteract.indexOf(a)===-1?this.listeners[a]:(this.canvas.addEventListener(a,function(b){var c,d=!0,e=A.coordsOfElement(this.canvas);return b.contextX=b.clientX-e.x,b.contextY=b.clientY-e.y,b.cancelContextPropagation=function(){d=!1},"mouseout"===a?(c=this.hoverElement,this.hoverElement=null):c=this.getObjectInPoint(b.contextX,b.contextY,!0),b.targetObject=c,c&&c.fire&&!c.fire(a,b)?(b.stopPropagation(),void b.preventDefault()):void(d&&this.fire(a,b))}.bind(this)),this.listeners[a]))},eventsInteract:["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","mousewheel","blur","focus","keypress","keydown","keyup","touchstart","touchmove","touchend","touchcancel","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture"],eventsHooks:{mouseover:function(){this.listeners.mouseout||(this.listenerSpecial("mouseover","mouseout","hover","mousemove"),this.listener("mouseout"))},mouseout:function(){this.listeners.mouseover||(this.listenerSpecial("mouseover","mouseout","hover","mousemove"),this.listener("mouseover"))},focus:function(){this.listeners.blur||(this.listenerSpecial("focus","blur","focus","mousedown"),this.listener("blur"))},blur:function(){this.listeners.focus||(this.listenerSpecial("focus","blur","focus","mousedown"),this.listener("focus"))}},listenerSpecial:function(a,b,c,d){return c+="Element",this.on(d,function(d){var e=d.targetObject,f=this[c];f!=e&&(f&&f.fire&&f.fire(b,d),e&&e.fire&&e.fire(a,d),this[c]=e)}.bind(this)),this},on:function(a,b){if(a+""!==a){for(var c in a)F(a,c)&&this.on(c,a[c]);return this}return(this.listeners[a]||this.listener(a)).push(b),this},off:function(a,b){b||(this.listeners[a]=[]);var c=this.listeners[a].indexOf(b);return this.listeners=this.listeners[a].slice(0,c).concat(this.listeners[a].slice(c+1)),this},fire:function(a,b){return this.listeners[a]?(this.listeners[a].forEach(function(a){a.call(this,b)}.bind(this)),this):this},matrix:null,transform:function(a,b,c,d,e,f,g){return g&&(g+""===g&&(g=A.corners[g],g=[g[0]*this.canvas.width,g[1]*this.canvas.height]),e=e-a*g[0]+g[0]-c*g[1],f=f-b*g[0]-d*g[1]+g[1]),this.matrix=A.transform(this.matrix||[1,0,0,1,0,0],[a,b,c,d,e,f]),this.update()},translate:function(a,b){return this.transform(1,0,0,1,a,b)},rotate:function(a,b){return a=a/180*Math.PI,this.transform(Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a),0,0,b)},scale:function(a,c,d){return(c===b||l(c))&&(d=c,c=a),this.transform(a,0,0,c,0,0,d)},skew:function(a,c,d){return(c===b||l(c))&&(d=c,c=a),this.transform(1,Math.tan(c*Math.PI/180),Math.tan(a*Math.PI/180),1,0,0,d)}},A.Context=p;var J;q=new g({initialize:function(a){this.listeners={},this.styles={},this.attrs={interaction:!0}},_visible:!0,update:function(){return this.context&&this.context.update(),this},z:function(a){return a===b?this.context.elements.indexOf(this):("top"===a&&(a=this.context.elements.length),this.context.elements.splice(this.context.elements.indexOf(this),1),this.context.elements.splice(a,0,this),this.update())},clone:function(a,b,c){var d=new this.constructor([],this.context);return a===!1?d.attrs=this.attrs:d.attrs=Object.assign({},this.attrs),b===!1?(d.styles=this.styles,d.matrix=this.matrix):(d.styles=Object.assign({},this.styles),this.matrix&&(d.matrix=this.matrix.slice())),c===!1?d.listeners=this.listeners:d.listeners=Object.assign({},this.listeners),this.context.push(d)},remove:function(){return this.context.elements.splice(this.context.elements.indexOf(this),1),this.context=null,this.update()},hide:function(){return this._visible=!1,this.update()},show:function(){return this._visible=!0,this.update()},attr:function(a,c){return a+""!==a?(Object.keys(a).forEach(function(b){this.attr(b,a[b])}.bind(this)),this):c===b?this.attrHooks[a]&&this.attrHooks[a].get?this.attrHooks[a].get.call(this):this.attrs[a]:(this.attrHooks[a]&&this.attrHooks[a].set?this.attrHooks[a].set.call(this,c):this.attrs[a]=c,this)},attrHooks:{fill:{get:function(){return this.styles.fillStyle},set:function(a){this.styles.fillStyle=a,this.update()}},stroke:{set:function(a){q.processStroke(a,this.styles),this.update()}},shadow:{set:function(a){q.processShadow(a,this.styles),this.update()}},opacity:{get:function(){return this.styles.globalAlpha!==b?this.styles.globalAlpha:1},set:function(a){this.styles.globalAlpha=+a,this.update()}},composite:{get:function(){return this.styles.globalCompositeOperation},set:function(a){this.styles.globalCompositeOperation=a,this.update()}},clip:{set:function(a){a.context=this.context,this.attrs.clip=a,this.update()}}},processObject:function(a,b){return F(a,"opacity")&&(this.styles.globalAlpha=a.opacity),F(a,"composite")&&(this.styles.globalCompositeOperation=a.composite),F(a,"clip")&&(a.clip.context=this.context,this.attrs.clip=a.clip),b.map(function(b){return a[b]})},bounds:function(a){if(!this.shapeBounds)throw"The object doesn't have shapeBounds method.";var b=Array.isArray(this.shapeBounds)?this.shapeBounds:this.shapeBounds();return new f(b[0],b[1],b[2],b[3])},corner:function(a,b){if(Array.isArray(a))return a;var c=this.bounds(b);return[c.x+c.w*A.corners[a][0],c.y+c.h*A.corners[a][1]]},on:function(a,b){if(a+""!==a)for(var c in a)F(a,c)&&this.on(c,a[c]);return b+""===b&&(b=j(arguments)),this.context.listener(a),(this.listeners[a]||(this.listeners[a]=[])).push(b),this},off:function(a,b){return a?b?(this.listeners[a].splice(this.listeners[a].indexOf(b),1),this):(this.listeners[a]=null,this):(this.listeners={},this)},fire:function(a,b){return(this.listeners[a]||[]).forEach(function(a){a.call(this,b)}.bind(this)),this},transform:function(a,b,c,d,e,f,g){return null===a?this.matrix=null:(g&&(g=this.corner(g),e=g[0]+e-a*g[0]-c*g[1],f=g[1]+f-b*g[0]-d*g[1]),this.matrix=A.transform(this.matrix||[1,0,0,1,0,0],[a,b,c,d,e,f])),this.update()},translate:function(a,b){return this.transform(1,0,0,1,a,b)},rotate:function(a,b){return a=a/180*Math.PI,this.transform(Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a),0,0,b||"center")},scale:function(a,c,d){return c===b&&(c=a),this.transform(a,0,0,c,0,0,d||"center")},skew:function(a,c,d){return c===b&&(c=a),this.transform(1,Math.tan(c),Math.tan(a),1,0,0,d||"center")},toDataURL:function(a,d){if(d===b){if("function"!=typeof this.bounds)throw"Object #"+this.z()+" can't be rasterized: need the bounds.";d=this.bounds()}a===b?a="image/png":a in A.fileTypes&&(a=A.fileTypes[a]);var e=c(d.width,d.height),f=e.getContext("2d");return f.setTransform(1,0,0,1,-d.x,-d.y),this.draw(f),e.toDataURL(a.type||a,a.quality||1)},toImageData:function(a){if(a===b){if("function"!=typeof this.bounds)throw"Object #"+this.z()+" can't be rasterized: need the bounds.";a=this.bounds()}var d=c(a.width,a.height),e=d.getContext("2d");return e.setTransform(1,0,0,1,-a.x,-a.y),this.draw(e),e.getImageData(0,0,a.width,a.height)}}),q.processStroke=function(a,b){if(a+""===a){a=a.replace(/\s*\,\s*/g,",").split(" ");for(var c,d=a.length;d--;)G.test(a[d])?c=parseFloat(a[d]):m(a[d])?b.lineWidth=A.distance(a[d]):"round"===a[d]?(b.lineJoin=b.lineJoin||"round",b.lineCap=b.lineCap||"round"):"miter"===a[d]||"bevel"===a[d]?b.lineJoin=a[d]:"butt"===a[d]||"square"===a[d]?b.lineCap=a[d]:"["===a[d][0]?b.lineDash=a[d].substr(1,a[d].length-2).split(","):a[d]in A.dashes?b.lineDash=A.dashes[a[d]]:b.strokeStyle=a[d];c&&(a=A.color(b.strokeStyle),a[3]=c,b.strokeStyle="rgba("+a.join(",")+")")}else{if(a.color&&(b.strokeStyle=a.color),a.opacity&&b.strokeStyle){var e=A.color(b.strokeStyle);e[3]=a.opacity,b.strokeStyle="rgba("+e.join(",")+")"}a.width&&(b.lineWidth=A.distance(a.width)),a.join&&(b.lineJoin=a.join),a.cap&&(b.lineCap=a.cap),a.dash&&(a.dash in A.dashes?b.lineDash=A.dashes[a.dash]:b.lineDash=a.dash)}},q.processShadow=function(a,c){if(a+""===a){var d=["shadowOffsetX","shadowOffsetY","shadowBlur"];a=a.replace(/\s*\,\s*/g,",").split(" ");for(var e=0;e<a.length;e++)isNaN(+a[e][0])?c.shadowColor=a[e]:c[d.shift()]=A.distance(a[e])}else a.x!==b&&(c.shadowOffsetX=A.distance(a.x)),a.y!==b&&(c.shadowOffsetY=A.distance(a.y)),a.blur!==b&&(c.shadowBlur=A.distance(a.blur||0)),a.color&&(c.shadowColor=a.color)},A.Drawable=q,p.prototype.eventsInteract.forEach(function(a){q.prototype[a]=p.prototype[a]=function(b){return this["function"==typeof b||b+""===b?"on":"fire"].apply(this,[a].concat(E.call(arguments)))}}),r=new g(q,{initialize:function(a,b){this.super("initialize",arguments),k(a[0])&&(a=this.processObject(a[0],r.args)),this.attrs.x=a[0],this.attrs.y=a[1],this.attrs.width=a[2],this.attrs.height=a[3],a[4]&&(this.styles.fillStyle=a[4]),a[5]&&q.processStroke(a[5],this.styles)},attrHooks:h(Object.assign({},q.prototype.attrHooks),{x:{set:function(a){this.attrs.x=a,this.update()}},y:{set:function(a){this.attrs.y=a,this.update()}},width:{set:function(a){this.attrs.width=a,this.update()}},height:{set:function(a){this.attrs.height=a,this.update()}},x1:{get:function(){return this.attrs.x},set:function(a){this.attrs.x=a,this.update()}},y1:{get:function(){return this.attrs.y},set:function(a){this.attrs.y=a,this.update()}},x2:{get:function(){return this.attrs.x+this.attrs.width},set:function(a){this.attrs.width=a-this.attrs.x,this.update()}},y2:{get:function(){return this.attrs.y+this.attrs.height},set:function(a){this.attrs.height=a-this.attrs.y,this.update()}}}),shapeBounds:function(){return[this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height]},draw:function(a){this._visible&&this.context.renderer.drawRect([this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height],a,this.styles,this.matrix,this)},isPointIn:function(a,b){return a>this.attrs.x&&b>this.attrs.y&&a<this.attrs.x+this.attrs.width&&b<this.attrs.y+this.attrs.height},processPath:function(a){a.beginPath(),a.rect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height)}}),r.args=["x","y","width","height","fill","stroke"],A.rect=function(){return new r(arguments)},A.Rect=r,s=new g(q,{initialize:function(a,b){this.super("initialize",arguments),k(a[0])&&(a=this.processObject(a[0],s.args)),this.attrs.cx=a[0],this.attrs.cy=a[1],this.attrs.radius=a[2],a[3]&&(this.styles.fillStyle=a[3]),a[4]&&q.processStroke(a[4],this.styles)},attrHooks:h(Object.assign({},q.prototype.attrHooks),{cx:{set:function(a){this.attrs.cx=a,this.update()}},cy:{set:function(a){this.attrs.cy=a,this.update()}},radius:{set:function(a){this.attrs.radius=Math.abs(a),this.update()}}}),shapeBounds:function(){return[this.attrs.cx-this.attrs.radius,this.attrs.cy-this.attrs.radius,2*this.attrs.radius,2*this.attrs.radius]},draw:function(a){this._visible&&this.context.renderer.drawCircle([this.attrs.cx,this.attrs.cy,this.attrs.radius],a,this.styles,this.matrix,this)},isPointIn:function(a,b){return Math.pow(a-this.attrs.cx,2)+Math.pow(b-this.attrs.cy,2)<=Math.pow(this.attrs.radius,2)},processPath:function(a){a.beginPath(),a.arc(this.attrs.cx,this.attrs.cy,Math.abs(this.attrs.radius),0,2*Math.PI,!0)}}),s.args=["cx","cy","radius","fill","stroke"],A.circle=function(){return new s(arguments)},A.Circle=s,t=new g({initialize:function(a,b,c){this.method=a,this.path=c,this.attrs=b},update:function(){return this.path.update(),this},process:function(a){a[this.method].apply(a,this.attrs)},attr:function(a,c){return k(a)?(Object.keys(a).forEach(function(b){this.attr(b,a[b])}.bind(this)),this):(a=t.types[this.name].attrs.indexOf(a),c===b?this.attrs[a]:(this.attrs[a]=c,this.update()))},bounds:function(){return t.types[this.method].bounds(this.attrs)}}),t.types={moveTo:{attrs:["x","y"],bounds:function(a){}},lineTo:{attrs:["x","y"]}},t.fromArray=function(a,b){if(a===!0)return K;if(a[0]in t.types)return new t(a[0],a.slice(1),b);switch(a.length){case 2:return new t("lineTo",a,b);case 4:return new t("quadraticCurveTo",a,b);case 6:return new t("bezierCurveTo",a,b)}},A.curves=t.types,A.Curve=t;var K=new t("closePath",[]);u=new g(q,{initialize:function(a,b){this.super("initialize",arguments),k(a[0])&&(a=this.processObject(a[0],u.args)),this.attrs.d=u.parse(a[0],this),a[1]&&(this.styles.fillStyle=a[1]),a[2]&&q.processStroke(a[2],this.styles)},attrHooks:h(Object.assign({},q.prototype.attrHooks),{d:{set:function(a){return this.update(),a}}}),part:function(a,c){return c===b?this.attrs.d[a]:(c=u.parse(c,this,0!==a),this.attrs.d.splice.apply(this.attrs.d,[a,1].concat(c)),this.update())},before:function(a,b,c){return 0===a&&turnToLine!==!1&&(this.attrs.d[0].name="lineTo"),b=u.parse(b,this,0!==a),this.attrs.d.splice.apply(this.attrs.d,[a,0].concat(b)),this.update()},after:function(a,b){return this.before(a+1,b)},remove:function(a){return a===b?this.super("remove"):(this.attrs.d[a].path=null,this.attrs.d.splice(a,1),this.update())},push:function(a){return this.attrs.d=this.attrs.d.concat(u.parse(a,this,0!==this.attrs.d.length)),this.update()},forEach:function(){return this.attrs.d.forEach.apply(this.attrs.d,arguments),this},map:function(){return this.attrs.d.map.apply(this.attrs.d,arguments)},reduce:function(){return this.attrs.d.reduce.apply(this.attrs.d,arguments)},moveTo:function(a,b){return this.push(["moveTo",a,b])},lineTo:function(a,b){return this.push(["lineTo",a,b])},quadraticCurveTo:function(a,b,c,d){return this.push(["quadraticCurveTo",a,b,c,d])},bezierCurveTo:function(a,b,c,d,e,f){return this.push(["bezierCurveTo",a,b,c,d,e,f])},arcTo:function(a,b,c,d,e,f){return this.push(["arcTo",a,b,c,d,e,!!f])},arc:function(a,b,c,d,e,f){return this.push(["arc",a,b,c,d,e,!!f])},closePath:function(){return this.push(K)},shapeBounds:function(){for(var a,b=1/0,c=1/0,d=-(1/0),e=-(1/0),g=0;g<this.attrs.d.length;g++)a=this.attrs.d[g].bounds(),b=Math.min(b,a.x1,a.x2),d=Math.max(d,a.x1,a.x2),c=Math.min(c,a.y1,a.y2),e=Math.max(e,a.y1,a.y2);return new f(b,c,d-b,e-c)},draw:function(a){this._visible&&this.context.renderer.drawPath(this.attrs.d,a,this.styles,this.matrix,this)}}),u.args=["d","fill","stroke"],u.parse=function(a,b,c){if(!a)return[];if(a+""===a)return u.parseSVG(a,b,c);var d=[];if(Array.isArray(a))for(var e=0;e<a.length;e++)+a[1]===a[1]&&(a=[a]),0!==e||c?d.push(t.fromArray(a[e],b)):d.push(new t("moveTo",isNaN(a[e][0])?a[e].slice(1):a[e],b));return d},u.parseSVG=function(a,b,c){return[]},A.path=function(){var a=new u(arguments);return a.init(),a},A.Path=u,v=new g(q,{initialize:function(a,b){this.super("initialize",arguments),k(a[0])&&(a=this.processObject(a[0],v.args)),this.attrs.image=v.parse(a[0]),this.attrs.x=a[1],this.attrs.y=a[2],a[3]&&(this.attrs.width=a[3]),a[4]&&(this.attrs.height=a[4]),a[5]&&(this.attrs.crop=a[5]),this.attrs.image.addEventListener("load",function(a){this.update(),this.fire("load",a)}.bind(this)),this.attrs.image.addEventListener("error",function(a){this.fire("error",event)})},attrHooks:h(Object.assign({},q.prototype.attrHooks),{x:{set:function(a){this.attrs.x=a,this.update()}},y:{set:function(a){this.attrs.y=a,this.update()}},width:{set:function(a){this.attrs.width=a,this.update()}},height:{set:function(a){this.attrs.height=a,this.update()}},crop:{set:function(a){this.attrs.crop=a,this.update()}},smooth:{get:function(){return this.styles[d(this.context.context)]||this.context.context[d(this.context.context)]},set:function(a){this.styles[d(this.context.context)]=!!a,this.update()}}}),remove:function(){this.super("remove"),this.attrs.image.blob&&H.revokeObjectURL(this.attrs.image.blob)},_realSize:function(){var a=this.attrs.width,b=this.attrs.height;return"auto"===a?a=this.attrs.image.width*(b/this.attrs.image.height):"native"!==a&&null!=a||(a=this.attrs.image.width),"auto"===b?b=this.attrs.image.height*(a/this.attrs.image.width):"native"!==b&&null!=b||(b=this.attrs.image.height),[a,b]},shapeBounds:function(){var a=this._realSize();return[this.attrs.x,this.attrs.y,a[0],a[1]]},isPointIn:function(a,b){var c=this._realSize();return a>this.attrs.x&&b>this.attrs.y&&a<this.attrs.x+c[0]&&b<this.attrs.y+c[1]},draw:function(a){if(this._visible&&this.attrs.image.complete){var b=[this.attrs.image,this.attrs.x,this.attrs.y];if(this.attrs.width||this.attrs.height){var c=this._realSize();b.push(c[0]),b.push(c[1]),this.attrs.crop&&(b=b.concat(this.attrs.crop))}else this.attrs.crop&&(b=b.concat([this.attrs.image.width,this.attrs.image.height]).concat(this.attrs.crop));this.context.renderer.drawImage(b,a,this.styles,this.matrix,this)}}});var L;v.args=["image","x","y","width","height","crop"],v.parse=function(a){if(a+""===a){if("#"===a[0])return B.getElementById(a.substr(1));if("<svg"!==a[0]){var b=new Image;return b.src=a,b}var c=new Blob([a],{type:"image/svg+xml;charset=utf-8"});a=new Image,a.src=H.createObjectURL(c),a.blob=c}return a},A.image=function(){var a=new v(arguments);return a},A.Image=v,w=new g(q,{initialize:function(a,b){this.super("initialize",arguments),k(a[0])&&(a=this.processObject(a[0],w.args)),this.attrs.data=a[0],this.attrs.x=a[1],this.attrs.y=a[2]},draw:function(a){if(this._visible){var b=[this.attrs.data,this.attrs.x,this.attrs.y];this.context.renderer.drawData(b,a,this.styles,this.matrix,this)}}}),w.args=["data","x","y"],A.raster=function(){var a=new w(arguments);return a},y=new g({initialize:function(a,b,c,d,e){this.context=e,a+""!==a&&(d=c,c=b,b=a,a="linear"),this.type=a||"linear",this.attrs={from:c,to:d,colors:y.parseColors(b)},y.types[this.type]&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),y.types[this.type].attrHooks),y.types[this.type].initialize&&y.types[this.type].initialize.call(this))},attr:q.prototype.attr,attrHooks:{colors:{set:function(a){return this.update(),y.parseColors(a)}}},color:function(a,c){if(c!==b)return this.attrs.colors[a]=c,this.update();if(this.attrs.colors[a])return A.color(this.attrs.colors[a]);var d=this.attrs.colors,e=Object.keys(d).sort();if(a<e[0])return A.color(d[e[0]]);if(a>e[e.length-1])return A.color(d[e[e.length-1]]);for(var f=0;f<e.length;f++)if(+e[f]>a){var g=A.color(d[e[f-1]]),h=A.color(d[e[f]]);return a=(a-+e[f-1])/(+e[f]-+e[f-1]),[g[0]+(h[0]-g[0])*a+.5|0,g[1]+(h[1]-g[1])*a+.5|0,g[2]+(h[2]-g[2])*a+.5|0,+(g[3]+(h[3]-g[3])*a).toFixed(2)]}},update:function(){return this.context.update(),this},toCanvasStyle:function(a,b){return y.types[this.type].toCanvasStyle.call(this,a,b)}}),y.parseColors=function(a){if(!Array.isArray(a))return a;var b={},c=1/(a.length-1);return a.forEach(function(a,d){b[c*d]=a}),b},y.types={linear:{attrHooks:{from:{set:function(a){return this.update(),a}},to:{set:function(a){return this.update(),a}}},toCanvasStyle:function(a,b){return this.context.renderer.makeGradient(this.context,"linear",b.corner(this.attrs.from),b.corner(this.attrs.to),this.attrs.colors)}},radial:{initialize:function(){this.attrs.from&&Array.isArray(this.attrs.from)?(this.attrs.startRadius=this.attrs.from[2]||0,this.attrs.from=this.attrs.from.slice(0,2)):(this.attrs.from||(this.attrs.from="center"),this.attrs.startRadius=0),this.attrs.to&&Array.isArray(this.attrs.to)?(this.attrs.radius=this.attrs.to[2]||"auto",this.attrs.to=this.attrs.to.slice(0,2)):(this.attrs.to||(this.attrs.to=this.attrs.from),this.attrs.radius="auto")},attrHooks:{from:{set:function(a){return Array.isArray(a)&&a.length>2&&(this.attrs.startRadius=a[2],a=a.slice(0,2)),this.update(),a}},to:{set:function(a){return Array.isArray(a)&&a.length>2&&(this.attrs.radius=a[2],a=a.slice(0,2)),this.update(),a}},radius:{set:function(a){return this.update(),a}},startRadius:{set:function(a){return this.update(),a}}},toCanvasStyle:function(a,b){var c=b.corner(this.attrs.from),d=b.corner(this.attrs.to);return this.context.renderer.makeGradient(this.context,"radial",[c[0],c[1],this.attrs.startRadius],[d[0],d[1],"auto"===this.attrs.radius?b.bounds().height:this.attrs.radius],this.attrs.colors)}}},A.Gradient=y,z=new g({initialize:function(a,b,c){this.image=v.parse(a),this.repeat=b,this.context=c,this.image.addEventListener("load",function(a){this.update(),this.image.blob&&H.revokeObjectURL(blob)}.bind(this))},update:function(){return this.context.update(),this},toCanvasStyle:function(a){return this.image.complete?a.createPattern(this.image,this.repeat||"repeat"):"transparent"}}),A.Pattern=z,A.easing={linear:function(a){return a},root:function(a){return Math.sqrt(a)},pow:function(a,b){return Math.pow(a,b||6)},expo:function(a,b){return Math.pow(b||2,8*a-8)},circ:function(a){return 1-Math.sin(Math.acos(a))},sine:function(a){return 1-Math.cos(a*Math.PI/2)},back:function(a,b){return Math.pow(a,2)*((b||1.618)*(a-1)+a)},bounce:function(a){for(var b=0,c=1;1;b+=c,c/=2)if(a>=(7-4*b)/11)return c*c-Math.pow((11-6*b-11*a)/4,2)},elastic:function(a,b){return Math.pow(2,10*--a)*Math.cos(20*a*Math.PI*(b||1)/3)}},["quad","cubic","quart","quint"].forEach(function(a,b){A.easing[a]=function(a){return Math.pow(a,b+2)}});for(var M in A.easing)Object.prototype.hasOwnProperty.call(A.easing,M)&&e(A.easing[M]);A.reNumberLike=/^(\d+|(\d+)?\.\d+)(em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|px|pt|pc)?$/,A.Class=g,A.Bounds=f,A.extend=h,A.argument=i,A.wrap=j,A.isObject=k,A.isNumberLike=m,A.isPatternLike=n,A.dashes={shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},A.fileTypes={jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",webp:"image/webp"},A.corners={left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],center:[.5,.5],"left top":[0,0],"top left":[0,0],"left bottom":[0,1],"bottom left":[0,1],"right top":[1,0],"top right":[1,0],"right bottom":[1,1],"bottom right":[1,1],lt:[0,0],tl:[0,0],lb:[0,1],bl:[0,1],rt:[1,0],tr:[1,0],rb:[1,1],br:[1,1]},A.colors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",chucknorris:"c00000",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},A.coordsOfElement=function(b){var c=b.getBoundingClientRect(),d=a.getComputedStyle(b);return{x:c.left+parseInt(d.borderLeftWidth)+parseInt(d.paddingLeft),y:c.top+parseInt(d.borderTopWidth)+parseInt(d.paddingTop)
}},A.clone=function(a){var b=new a.constructor;for(var c in a)F(a,c)&&("object"!=typeof a[c]||a[c]instanceof p||a[c]instanceof Image?b[c]=a[c]:b[c]=A.clone(a[c]));return b},A.transform=function(a,b){return[a[0]*b[0]+a[2]*b[1],a[1]*b[0]+a[3]*b[1],a[0]*b[2]+a[2]*b[3],a[1]*b[2]+a[3]*b[3],a[0]*b[4]+a[2]*b[5]+a[4],a[1]*b[4]+a[3]*b[5]+a[5]]},A.color=function(a){if(a!==b){if(Array.isArray(a))return a.slice(0,4);if(a+""!==a)throw"Not a color: "+a.toString();return 0===a.indexOf("rgb")?(a=a.substring(a.indexOf("(")+1,a.length-1).replace(/\s/g,"").split(",").map(function(a){return a.indexOf("%")>0?Math.round(2.55*parseInt(a)):parseInt(a)}),3===a.length&&a.push(1),a):"#"===a[0]?(a=a.substring(1),3===a.length&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16),1]):a in A.colors?A.color("#"+A.colors[a]):"rand"===a?[Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random()),1]:[0,0,0,0]}},A.angleUnit="grad",A.unit="px";var N="pt em in cm mm pc ex ch rem v wvh vmin vmax".split(" "),O={px:1,ch:8,cm:37.78125,em:16,ex:7.15625,in:96,mm:3.765625,pc:16,pt:1.328125,rem:16,v:16,vmax:13.65625,vmin:4.78125,wvh:16};A.snapToPixels=0,A.distance=o,A.version=Math.PI/3.490658503988659,A.query=function(b,c,d,e){return new p(b+""===b?(d||a.document).querySelectorAll(b)[c||0]:b.canvas||b,e)},A.id=function(a,b){return new p(B.getElementById(a),b)},"object"==typeof module&&"object"==typeof module.exports?module.exports=A:"function"==typeof define&&define.amd?define([],function(){return A}):a.Graphics2D=A}("undefined"!=typeof window?window:this);