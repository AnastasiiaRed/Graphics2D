!function(i,o){var e,a,t,s,n,r,h,c,u,l,f={},d=i.document,p=Object.prototype.toString,m=Array.prototype.slice,g=Function.prototype.call.bind(Object.prototype.hasOwnProperty),b=/^\d*\.\d+$/,y=/^(\d+|(\d+)?\.\d+)(em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|px|pt|pc)?$/,x=i.URL||i.webkitURL||i,v=Object.assign?Object.assign:function(t,e){for(var s=Object.keys(e),i=s.length;i--;)t[s[i]]=e[s[i]];return t},w={mouse:["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","mousewheel","blur","focus"],touch:["touchstart","touchmove","touchend","touchcancel"],pointer:["pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture"],keyboard:["keypress","keydown","keyup"]},k=i.requestAnimationFrame||i.webkitRequestAnimationFrame||i.mozRequestAnimationFrame||i.oRequestAnimationFrame||i.msRequestAnimationFrame||function(t){return i.setTimeout(t,1e3/60)};i.cancelAnimationFrame||i.webkitCancelAnimationFrame||i.mozCancelAnimationFrame||i.oCancelAnimationFrame||i.msCancelAnimationFrame||i.cancelRequestAnimationFrame||i.webkitCancelRequestAnimationFrame||i.mozCancelRequestAnimationFrame||i.oCancelRequestAnimationFrame||i.msCancelRequestAnimationFrame||i.clearTimeout;function O(t,e,s,i){s<0&&(t-=s=-s),i<0&&(e-=i=-i),this.x=this.x1=t,this.y=this.y1=e,this.w=this.width=s,this.h=this.height=i,this.x2=t+s,this.y2=e+i,this.cx=t+s/2,this.cy=e+i/2}function M(t){return"[object Object]"===p.call(t)}function A(t){return+t===t||t+""===t&&y.test(t)}f.renderers={},f.bounds=function(t,e,s,i){return new O(t,e,s,i)},f.Class=j,f.Bounds=O,f.extend=v,f.argument=function(e){return function(t){return this.argument(e,t)}},f.wrap=function(t,e){var s=t[e];return t=m.call(t,e+1),function(){this[s].apply(this,t)}},f.isObject=M,f.isNumberLike=A,f.isPatternLike=function(t){return t instanceof Image||M(t)&&g(t,"image")||t+""===t&&!(t.indexOf("http://")&&t.indexOf("https://")&&t.indexOf("./")&&t.indexOf("../")&&t.indexOf("data:image/")&&t.indexOf("<svg"))},f.dashes={shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},f.fileTypes={jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",webp:"image/webp"},f.corners={left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],center:[.5,.5],"left top":[0,0],"top left":[0,0],"left bottom":[0,1],"bottom left":[0,1],"right top":[1,0],"top right":[1,0],"right bottom":[1,1],"bottom right":[1,1],lt:[0,0],tl:[0,0],lb:[0,1],bl:[0,1],rt:[1,0],tr:[1,0],rb:[1,1],br:[1,1]},f.colors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",chucknorris:"c00000",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},f.coordsOfElement=function(t){var e=t.getBoundingClientRect(),s=i.getComputedStyle(t);return{x:e.left+parseInt(s.borderLeftWidth||0)+parseInt(s.paddingLeft||0),y:e.top+parseInt(s.borderTopWidth||0)+parseInt(s.paddingTop||0)}},f.clone=function(t){var e=new t.constructor;for(var s in t)g(t,s)&&("object"!=typeof t[s]||t[s]instanceof T||t[s]instanceof Image?e[s]=t[s]:e[s]=f.clone(t[s]));return e},f.strParse={functions:function(t){var e=[];return(t=t.split(")")).forEach(function(t){""!==(t=t.trim())&&e.push({args:t.split("(")[1].split(",").map(function(t){return t.trim()}),method:t.match(/[a-z]+/)[0]})}),e}},f.parseTransform=function(e,i){if(Array.isArray(e.transform))return e.transform;var r=[1,0,0,1,0,0];"attributes"===e.transform?(e.transformOrder||"translate rotate scale skew").split(" ").forEach(function(t){e[t]!==o&&(r=f.transforms[t](r,e[t],i))}):e.transform.split(")").forEach(function(t){if(""!==(t=t.trim())){var e=t.match(/[a-z]+/),s=t.split("(")[1].split(",").map(function(t){return t.trim()});r=f.transforms[e](r,s,i)}});return r},f.transforms={translate:function(t,e){return t[4]+=+e[0],t[5]+=+e[1],t},scale:function(t,e,s){+e===e?e=[e,e]:+e[1]!==e[1]&&(e=[e[0],e[0],e[1]]);var i=s.corner(e[2]||"center");return t=f.transform(t,[1,0,0,1,i[0],i[1]]),t=f.transform(t,[e[0],0,0,e[1],0,0]),t=f.transform(t,[1,0,0,1,-i[0],-i[1]])},skew:function(t,e,s){+e===e?e=[e,e]:+e[1]!==e[1]&&(e=[e[0],e[0],e[1]]),e[0]=+e[0]/180*Math.PI,e[1]=+e[1]/180*Math.PI;var i=s.corner(e[2]||"center");return t=f.transform(t,[1,0,0,1,i[0],i[1]]),t=f.transform(t,[1,Math.tan(e[1]),Math.tan(e[0]),1,0,0]),t=f.transform(t,[1,0,0,1,-i[0],-i[1]])},rotate:function(t,e,s){+e===e&&(e=[e]),e[0]=+e[0]/180*Math.PI;var i=s.corner(e[1]||"center");return t=f.transform(t,[1,0,0,1,i[0],i[1]]),t=f.transform(t,[Math.cos(e[0]),Math.sin(e[0]),-Math.sin(e[0]),Math.cos(e[0]),0,0]),t=f.transform(t,[1,0,0,1,-i[0],-i[1]])}},f.isIdentityTransform=function(t){return 0===t[5]&&0===t[4]&&1===t[3]&&0===t[2]&&0===t[1]&&1===t[0]},f.transform=function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},f.transformPoint=function(t,e){return[t[0]*e[0]+t[2]*e[1]+t[4],t[1]*e[0]+t[3]*e[1]+t[5]]},f.inverseTransform=function(t){var e=t[0]*t[3]-t[2]*t[1];return 0===e?null:[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,-(t[3]*t[4]-t[2]*t[5])/e,(t[1]*t[4]-t[0]*t[5])/e]},f.color=function(t){if(t!==o){if(Array.isArray(t))return t.slice(0,4);if(t+""!==t)throw"Not a color: "+t.toString();if(0!==t.indexOf("rgb"))return"#"===t[0]?(3===(t=t.substring(1)).length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16),1]):t in f.colors?f.color("#"+f.colors[t]):"rand"===t?[Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random()),1]:[0,0,0,0];var e=(t=t.substring(t.indexOf("(")+1,t.length-1).replace(/\s/g,"").split(","))[3];return t=t.slice(0,3).map(function(t,e){return 0<t.indexOf("%")?Math.round(2.55*parseInt(t)):parseInt(t)}),e===o&&(e=1),t.push(Number(e)),t}},f.angleUnit="grad",f.unit="px";var T,H="pt em in cm mm pc ex ch rem v wvh vmin vmax".split(" "),E={px:1,ch:8,cm:37.78125,em:16,ex:7.15625,in:96,mm:3.765625,pc:16,pt:1.328125,rem:16,v:16,vmax:13.65625,vmin:4.78125,wvh:16};function j(r,t){t||(t=r,r=null);var e=function(){return this.initialize&&this.initialize.apply(this,arguments)};if(r){var s=function(){};s.prototype=r.prototype,(e.prototype=new s).superclass=r.prototype,(e.prototype.constructor=e).prototype.super=function(t,e){if(!this.superclass.superclass||!this.superclass.superclass[t])return this.superclass[t].apply(this,e);var s=this.superclass;this.superclass=this.superclass.superclass;var i=s[t].apply(this,e);return this.superclass=r.prototype,i}}return t.mixins&&t.mixins.forEach(function(t){v(e.prototype,j.mixins[t])}),v(e.prototype,t),e}function C(t){this.attrs.matrix="dirty",this.update()}f.snapToPixels=1,f.lastDistanceObject=null,f.distance=function(t,e){if(t!==o){if(!t)return 0;if(f.snapToPixels&&!e)return Math.round(f.distance(t,!0)/f.snapToPixels)*f.snapToPixels;if(t.constructor===Number)return"px"!==f.unit?f.distance(t+""+f.unit):t;if((t+="").indexOf("px")===t.length-2)return parseInt(t);if(t.constructor!==String)return f.lastDistanceObject=t;var s=t.replace(/[\d\.]+?/g,"");if(t=t.replace(/[^\d\.]+?/g,""),""===s)return t;if(!f.units)if(d){var i=d.createElement("div");d.body.appendChild(i),f.units={},H.forEach(function(t){i.style.width="1"+t,f.units[t]=parseFloat(getComputedStyle(i).width)}),d.body.removeChild(i)}else f.units=E;return 1===f.snapToPixels?Math.round(f.units[s]*t):f.units[s]*t}},j.mixins={AttrMixin:{attrs:{},attrHooks:{},attr:function(e,t){return e.constructor===Array?e.map(function(t){return this.attr(t)},this):e.constructor!==String?(Object.keys(e).forEach(function(t){this.attr(t,e[t])},this),this):t===o?this.attrHooks[e]&&this.attrHooks[e].get?this.attrHooks[e].get.call(this):this.attrs[e]:(this.attrs[e]=t,this.attrHooks[e]&&this.attrHooks[e].set&&this.attrHooks[e].set.call(this,t),this)}},TransformableMixin:{attrHooks:{transform:{set:function(t){this.attrs.matrix=null===t?null:"dirty",this.update()}},transformOrder:{set:C},pivot:{set:C},translate:{get:function(){return this.attrs.translate||[0,0]},set:C},rotate:{get:function(){return this.attrs.rotate||0},set:C},scale:{get:function(){return this.attrs.scale||[1,1]},set:C},skew:{get:function(){return this.attrs.skew||[0,0]},set:C}},calcMatrix:function(){var s,t=this.attrs.transform;return t.constructor===Array?s=new Float32Array(t):"attributes"===t?(s=new Float32Array([1,0,0,1,0,0]),(this.attrs.transformOrder||f.transformOrder).split(" ").forEach(function(t){var e=this.attrs[t];e&&this.transformFunctions[t].call(this,s,e.constructor===Array?e:[e])},this)):(s=new Float32Array([1,0,0,1,0,0]),f.strParse.functions(t).forEach(function(t){this.transformFunctions[t.method].call(this,s,t.args)},this)),this.attrs.matrix=s},transformFunctions:{pivot:function(t){return t&&-1<t.indexOf(";")?(t=t.split(";"),[Number(t[0].trim()),Number(t[1].trim())]):this.corner(t||this.attrs.pivot,{transform:"none"})},translate:function(t,e){var s=Number(e[0]),i=Number(e[1]);e[2]?(t[4]+=s,t[5]+=i):(t[4]=t[0]*s+t[2]*i+t[4],t[5]=t[1]*s+t[3]*i+t[5])},matrix:function(t,e){var s=t[0],i=t[1],r=t[2],n=t[3],a=t[4],o=t[5];t[0]=s*e[0]+r*e[1],t[1]=i*e[0]+n*e[1],t[2]=s*e[2]+r*e[3],t[3]=i*e[2]+n*e[3],t[4]=s*e[4]+r*e[5]+a,t[5]=i*e[4]+n*e[5]+o},lmatrix:function(t,e){this.transformFunctions.matrix.call(this,e,t)},rotate:function(t,e){var s=this.transformFunctions.pivot.call(this,e[1]),i=Number(e[0])*Math.PI/180,r=Math.cos(i),n=Math.sin(i);this.transformFunctions.matrix.call(this,t,[r,n,-n,r,-s[0]*r+s[1]*n+s[0],-s[0]*n-s[1]*r+s[1]])},scale:function(t,e){isNaN(e[1])&&(e[2]=e[1],e[1]=e[0]);var s=Number(e[0]),i=Number(e[1]),r=this.transformFunctions.pivot.call(this,e[2]);this.transformFunctions.matrix.call(this,t,[s,0,0,i,-r[0]*s+r[0],-r[1]*i+r[1]])},skew:function(t,e){isNaN(e[1])&&(e[2]=e[1],e[1]=e[0]);var s=Math.tan(Number(e[0])*Math.PI/180),i=Math.tan(Number(e[1])*Math.PI/180),r=this.transformFunctions.pivot.call(this,e[2]);this.transformFunctions.matrix.call(this,t,[1,i,s,1,-r[1]*s,-r[0]*i])}}},EventMixin:{listeners:{},eventHooks:{},on:function(e,t,s){return e.constructor!==String?Object.keys(e).forEach(function(t){this.on(t,e[t])},this):(t&&(t.constructor===Function?(s=t,t=null):t.constructor===String&&Array.prototype.splice.call(arguments,1,0,null)),s.constructor===String&&(r=(i=arguments)[2],s=function(){return this[r].apply(this,Array.prototype.slice.call(i,3))}),this.listeners[e]||(this.listeners[e]=[],this.eventHooks[e]&&this.eventHooks[e].init&&this.eventHooks[e].init.call(this,e)),this.listeners[e].push({callback:s,options:t})),this;var i,r},off:function(t,e){var s=this.listeners[t],i=this.eventHooks[t];if(s)if(e){for(var r=0;r<s.length;r++)if(s[r].callback===e){s.splice(r,1);break}i&&!s.length&&i.teardown&&(this.listeners[t]=null,i.teardown.call(this,t))}else this.listeners[t]=null,i&&i.teardown&&i.teardown.call(this,t);return this},fire:function(t,e,s){var i=this.listeners[t];return i&&(s&&(i=i.filter(s,this)),i.forEach(function(t){t.callback.call(this,e)},this)),this}},LinkMixin:{links:[],pushLink:function(){},callLinks:function(t){}}},f.transformOrder="translate rotate scale skew",j.attr=function(e,t){if(Array.isArray(e))return e.map(function(t){return this.attr(t)},this);if(e+""!==e)return Object.keys(e).forEach(function(t){this.attr(t,e[t])},this),this;if(1===arguments.length)return this.attrHooks[e]&&this.attrHooks[e].get?this.attrHooks[e].get.call(this):this.attrs[e];if(this.attrHooks[e]&&this.attrHooks[e].set){var s=this.attrHooks[e].set.call(this,t);null!==s&&(this.attrs[e]=s===o?t:s)}else this.attrs[e]=t;return this},(a=new j({initialize:function(t,e,s){if(this.duration=t||a.default.duration,e.constructor===String){var i=e.indexOf("(");-1!==i&&(this.easingParam=e.substring(i+1,e.length-1),e=e.substring(0,i)),this.easing=a.easing[e]}else this.easing=e||a.default.easing;this.callback=s},play:function(t,e){this.prePlay&&this.prePlay(),t&&(this.tick=t),e&&(this.tickContext=e),this.startTime=Date.now(),this.endTime=this.startTime+this.duration,a.queue.length||k(a.do),a.queue.push(this)},pause:function(){this.pauseTime=Date.now(),a.queue.splice(a.queue.indexOf(this),1)},continue:function(){var t=this.pauseTime-this.startTime;this.startTime=Date.now()-t,this.endTime=this.startTime+this.duration,a.queue.length||k(a.do),a.queue.push(this)}})).queue=[],a.do=function(){for(var t,e,s=Date.now(),i=0;i<a.queue.length;i++)(e=(s-(t=a.queue[i]).startTime)/t.duration)<0||(1<e&&(e=1),t.now=s,t.pos=t.easing(e,t.easingParam),t.tick.call(t.tickContext,t),1===e&&(t.callback&&t.callback.call(t.tickContext,t),a.queue.splice(a.queue.indexOf(t),1)));a.queue.length&&k(a.do)},j.mixins.AnimatableMixin={animate:function(e,t,s,i,r){var n;return e.constructor!==String&&(r=i,i=s,s=t,t=null),s&&s.constructor===Object||(s&&s.constructor===Function&&(r=s,s=null),s={duration:s||a.default.duration,easing:i||a.default.easing,callback:r}),e instanceof a?(n=e,Object.assign(n,s)):(n=new a(s.duration,s.easing,s.callback),e.constructor===String?(n.prop=e,n.tick=this.attrHooks[e].anim,n.prePlay=function(){this.attrHooks[e].preAnim.call(this,n,t),this.attrs.animation=n}.bind(this)):(n.prop=Object.keys(e).map(function(t){var e=new a;return e.prop=t,e.tick=this.attrHooks[t].anim,e.tickContext=this,e},this),n.tick=function(e){e.prop.forEach(function(t){t.now=e.now,t.pos=e.pos,this.attrHooks[t.prop].anim.call(this,t)},this)},n.tickContext=this,n.prePlay=function(){n.prop.forEach(function(t){this.attrHooks[t.prop].preAnim.call(this,t,e[t.prop])}),this.attrs.animation=n}.bind(this)),n.tickContext=this),n.elem=this,s.name&&(n.name=s.name),this},pause:function(e){return this._paused||(this._paused=[]),a.queue.slice().forEach(function(t){t.elem!==this||t.name!==e&&e||(t.pause(),this._paused.push(t))},this),this},continue:function(s){if(this._paused)return this._paused.slice().forEach(function(t,e){s&&t.name!==s||(t.continue(),this._paused.splice(e,1))},this),this}},a.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},sqrt:function(t){return Math.sqrt(t)},pow:function(t,e){return Math.pow(t,e||6)},expo:function(t,e){return Math.pow(e||2,8*t-8)},sigmoid:function(t,e){return e=-(e||5),(1+Math.exp(e/2))/(1+Math.exp(e*(t-.5)))},circ:function(t){return 1-Math.sin(Math.acos(t))},sine:function(t){return 1-Math.cos(t*Math.PI/2)},back:function(t,e){return Math.pow(t,2)*((e||1.618)*(t-1)+t)},bounce:function(t){for(var e=0,s=1;;e+=s,s/=2)if((7-4*e)/11<=t)return s*s-Math.pow((11-6*e-11*t)/4,2)},elastic:function(t,e){return Math.pow(2,10*--t)*Math.cos(20*t*Math.PI*(e||1)/3)},bezier:function(t,e){}},a.easing.default=a.easing.swing,["quad","cubic","quart","quint"].forEach(function(t,e){a.easing[t]=function(t){return Math.pow(t,e+2)}}),Object.keys(a.easing).forEach(function(s){a.easing[s+"In"]=a.easing[s],a.easing[s+"Out"]=function(t,e){return 1-a.easing[s](1-t,e)},a.easing[s+"InOut"]=function(t,e){return.5<=t?a.easing[s](2*t,e)/2:(2-a.easing[s](2*(1-t),e))/2}}),a.default={duration:500,easing:"swing"},f.animation=function(t,e,s){return new a(t,e,s)},(T=function(t){this.canvas=t,this.context=t.getContext("2d"),this.elements=[],this.listeners={},this.attrs={transform:"attributes",pivot:"center"},this.cache={},this.updateNow=this.updateNow.bind(this)}).prototype={object:function(t){return t.constructor===Function&&(t={draw:t}),this.push(v(new e,t))},rect:function(){return this.push(new t(arguments))},circle:function(){return this.push(new s(arguments))},path:function(){return this.push(new r(arguments))},image:function(){return this.push(new h(arguments))},text:function(){return this.push(new c(arguments))},line:function(t,e,s,i,r){return this.path([[t,e],[s,i]],null,r)},quadratic:function(t,e,s,i,r,n,a){return this.path([[t,e],[s,i,r,n]],null,a)},bezier:function(t,e,s,i,r,n,a,o,h){return this.path([[t,e],[s,i,r,n,a,o]],null,h)},arcTo:function(t,e,s,i,r,n,a){return this.path([[t,e],["arcTo",t,e,s,i,r,n]],null,a)},useCache:!1,gradient:function(t,e,s,i){return new u(t,e,s,i,this)},pattern:function(t,e){return new l(t,e,this)},push:function(t){if((t.context=this).elements.push(t),t.draw){var e=this.context;if(e.save(),this.attrs.matrix){var s="dirty"!==this.attrs.matrix?this.attrs.matrix:this.calcMatrix();e.setTransform(s[0],s[1],s[2],s[3],s[4],s[5])}else e.setTransform(1,0,0,1,0,0);t.draw(e),e.restore()}return t.update=t.updateFunction,t},update:function(){this._willUpdate||0===this.elements.length||(this._willUpdate=!0,k(this.updateNow))},updateNow:function(){var e=this.context;if(e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),this.attrs.matrix){var t="dirty"!==this.attrs.matrix?this.attrs.matrix:this.calcMatrix();e.setTransform(t[0],t[1],t[2],t[3],t[4],t[5])}this.elements.forEach(function(t){t.draw(e)}),e.restore(),this._willUpdate=!1},getObjectInPoint:function(t,e,s){for(var i=this.elements,r=i.length;r--;)if(i[r].isPointIn&&(i[r].attrs.interaction||!s)&&i[r].isPointIn(t,e,"mouse"))return i[r];return null},each:function(t){if(t+""===t){var e=m.call(arguments,1),s=t;t=function(t){t[s].apply(t,e)}}return this.elements.slice().forEach(t,this),this},contextCoords:function(t,e){var s=f.coordsOfElement(this.canvas);return[t-s.x,e-s.y]},getTransform:function(){if(this.cache.transform)return this.cache.transform;var t=f.parseTransform(this.attrs,this);return this.cache.transform=t},corner:function(t){return[this.canvas.width*f.corners[t][0],this.canvas.height*f.corners[t][1]]}},Object.assign(T.prototype,j.mixins.EventMixin,{hoverElement:null,eventHooks:{}}),f.browserCommonEvent={init:function(t){this.eventHooks[t].canvas&&this.canvas.addEventListener(t,this.listeners["_canvasListener_"+t]=this.eventHooks[t].canvas.bind(this))},teardown:function(t){k(function(){this.listeners[t]||this.canvas.removeEventListener(t,this.listeners["_canvasListener_"+t])}.bind(this))},canvas:function(t){t.cancelContextPropagation=function(){},this.fire(t.type,t)}},f.browserMouseEvent=Object.assign({},f.browserCommonEvent,{canvas:function(t){var e=!0;t.cancelContextPropagation=function(){e=!1};var s=this.contextCoords(t.clientX,t.clientY);t.contextX=s[0],t.contextY=s[1],t.targetObject=this.getObjectInPoint(t.contextX,t.contextY,!0),t.targetObject&&t.targetObject.fire&&t.targetObject.fire(t.type,t),e&&this.fire(t.type,t)}}),f.browserTouchEvent=Object.assign({},f.browserCommonEvent,{canvas:function(e){var t=!0;e.cancelContextPropagation=function(){t=!1},["touches","changedTouches","targetTouches"].forEach(function(t){e[t]&&Array.prototype.forEach.call(e[t],function(t){var e=this.contextCoords(t.clientX,t.clientY);t.contextX=e[0],t.contextY=e[1],t.targetObject=this.getObjectInPoint(t.contextX,t.contextY,!0)},this)},this),Array.prototype.forEach.call(e.touches,function(t){t.targetObject&&t.targetObject.fire&&e.targetObject.fire(e.type,e)},this),t&&this.fire(e.type,e)}});var P,I,F=i.document?{mouse:f.browserMouseEvent,touch:f.browserTouchEvent,pointer:f.browserCommonEvent,keyboard:f.browserCommonEvent}:{};function q(t,e){return P||(P=d.createElement("canvas")),P.width=t,P.height=e,P}function z(t){v(this,t)}function S(){this.update()}function e(t){this.listeners={},this.styles={},this.cache={},this.attrs={interaction:!0,visible:!0,transform:"attributes",pivot:"center"},this.argsOrder&&this.processArguments(t,this.argsOrder)}function R(t){v(this,t)}function L(t){for(var e=new R({}),s=0;s<t.length;s++);return e}function N(e){return["mozImageSmoothingEnabled","webkitImageSmoothingEnabled","msImageSmoothingEnabled","imageSmoothingEnabled"].forEach(function(t){t in e&&(I=t)}),N=function(){return I},I}Object.keys(w).forEach(function(t){w[t].forEach(function(e){T.prototype.eventHooks[e]=F[t],T.prototype[e]=function(t){return t.constructor===Function?this.on(e,t):t.constructor===String?this.on.apply(this,[e].concat(m.call(arguments))):this.fire(t)}})}),Object.assign(T.prototype,j.mixins.AttrMixin,j.mixins.TransformableMixin,{attrHooks:Object.assign({},j.mixins.TransformableMixin.attrHooks,{width:{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t,this.canvas.style.width=this.canvas.width/(this.attrs.dpi||1)+"px",this.update()}},height:{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t,this.canvas.style.height=this.canvas.height/(this.attrs.dpi||1)+"px",this.update()}},dpi:{get:function(){return this.attrs.dpi||1},set:function(t){this.canvas.style.width=this.canvas.width/t+"px",this.canvas.style.height=this.canvas.height/t+"px",this.update()}},smooth:{get:function(t){var e=this.canvas.style.imageRendering;return"pixelated"!==e&&"crisp-edges"!==e},set:function(t){this.canvas.style.imageRendering=t?"initial":"pixelated"}}})}),f.Context=T,f.contexts={"2d":T},e.prototype={initialize:e,updateFunction:function(){return this.context&&this.context.update(),this},update:function(){return this},clone:function(t,e,s){var i=new this.constructor([],this.context);return i.attrs=!1===t?this.attrs:v({},this.attrs),!1===e?(i.styles=this.styles,i.matrix=this.matrix):(i.styles=v({},this.styles),this.matrix&&(i.matrix=this.matrix.slice())),i.listeners=!1===s?this.listeners:v({},this.listeners),this.context.push(i)},remove:function(){return this.context.elements.splice(this.context.elements.indexOf(this),1),this.update(),this.context=null,this},getTransform:function(){if(this.cache.transform)return this.cache.transform;var t=f.parseTransform(this.attrs,this);return this.cache.transform=t},processObject:function(e,t){return["opacity","composite","clip","visible","interaction","shadow","z","transform","transformOrder","rotate","skew","scale"].forEach(function(t){e[t]!==o&&this.attr(t,e[t])},this),t.map(function(t){return e[t]})},processArguments:function(s,t){if(s[0].constructor===Object)this.attr(s[0]);else{var i={};t.forEach(function(t,e){s[e]!==o&&(i[t]=s[e])},this),this.attr(i)}},isPointInBefore:function(t,e,s){if(s&&!1!==s.transform){var i=this.getTransform();if(!f.isIdentityTransform(i)){var r=f.inverseTransform(i);return f.transformPoint(r,[t,e])}}return[t,e,s]},boundsReducers:{order:"accuracy transform stroke tight",accuracy:function(t){return"precise"===t?(this.preciseBounds||this.roughBounds).call(this):"rough"===t?(this.roughBounds||this.preciseBounds).call(this):void 0},stroke:function(t,e){var s=this.styles.lineWidth;return s&&"ignore"!==t&&(s/=2,"-"===t&&(s=-s),e.lt[0]-=s,e.lt[1]-=s,e.lb[0]-=s,e.rt[1]-=s,e.lb[1]+=s,e.rt[0]+=s,e.rb[0]+=s,e.rb[1]+=s),e},transform:function(t,e){var s,i=this.context&&this.context.attrs.matrix,r=this.attrs.matrix;return"full"===t&&i&&r?("dirty"===i&&(i=this.context.calcMatrix()),"dirty"===r&&(r=this.calcMatrix()),s=f.transform(i,r)):"context"!==t&&"full"!==t||!i?"self"!==t&&"full"!==t||!r||(s="dirty"===r?this.calcMatrix():r):s="dirty"===i?this.context.calcMatrix():i,"none"!==t&&s?{lt:f.transformPoint(s,[e.x1,e.y1]),lb:f.transformPoint(s,[e.x1,e.y2]),rt:f.transformPoint(s,[e.x2,e.y1]),rb:f.transformPoint(s,[e.x2,e.y2])}:{lt:[e.x1,e.y1],lb:[e.x1,e.y2],rt:[e.x2,e.y1],rb:[e.x2,e.y2]}},tight:function(t,e){if(t)return e;var s=Math.min(e.lt[0],e.lb[0],e.rt[0],e.rb[0]),i=Math.min(e.lt[1],e.lb[1],e.rt[1],e.rb[1]);return new O(s,i,Math.max(e.lt[0],e.lb[0],e.rt[0],e.rb[0])-s,Math.max(e.lt[1],e.lb[1],e.rt[1],e.rb[1])-i)}},bounds:function(s){return s=Object.assign({accuracy:"precise",transform:"full",stroke:"ignore",tight:!1},s),this.boundsReducers.order.split(" ").reduce(function(t,e){return s[e]===o?t:this.boundsReducers[e].call(this,s[e],t,s)}.bind(this),null)},corner:function(t,e){return[(e=e instanceof O?e:this.bounds(e)).x+e.w*f.corners[t][0],e.y+e.h*f.corners[t][1]]},preDraw:function(e){if(e.save(),Object.keys(this.styles).forEach(function(t){e[t]=this.styles[t]},this),this.attrs.matrix){var t="dirty"!==this.attrs.matrix?this.attrs.matrix:this.calcMatrix();e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}},postDraw:function(t){this.styles;this.attrs.fill&&t.fill(this.attrs.fillRule),this.attrs.stroke&&t.stroke(),t.restore()},toDataURL:function(t,e){if(e===o){if("function"!=typeof this.bounds)throw"Object #"+this.attr("z")+" can't be rasterized: need the bounds.";e=this.bounds()}t===o?t="image/png":t in f.fileTypes&&(t=f.fileTypes[t]);var s=q(e.width,e.height),i=s.getContext("2d");return i.setTransform(1,0,0,1,-e.x,-e.y),this.draw(i),s.toDataURL(t.type||t,t.quality||1)},toBlob:function(t,e,s,i){},toImageData:function(t){if(t===o){if("function"!=typeof this.bounds)throw"Object #"+this.z()+" can't be rasterized: need the bounds.";t=this.bounds()}var e=q(t.width,t.height).getContext("2d");return e.setTransform(1,0,0,1,-t.x,-t.y),this.draw(e),e.getImageData(0,0,t.width,t.height)}},e.AttrHooks=z,e.processStroke=function(t,e){if(t+""===t){for(var s,i=(t=t.replace(/\s*\,\s*/g,",").split(" ")).length,r=!1,n=!1;i--;)b.test(t[i])?s=parseFloat(t[i]):A(t[i])?e.lineWidth=f.distance(t[i]):"round"===t[i]?(r||(e.lineJoin="round"),n||(e.lineCap=e.lineCap||"round")):"miter"===t[i]||"bevel"===t[i]?(r=!0,e.lineJoin=t[i]):"butt"===t[i]||"square"===t[i]?(n=!0,e.lineCap=t[i]):"["===t[i][0]?e.lineDash=t[i].substr(1,t[i].length-2).split(","):t[i]in f.dashes?e.lineDash=f.dashes[t[i]]:t[i].lastIndexOf("ml")===t[i].length-2?e.miterLimit=+t[i].slice(0,t[i].length-2):0===t[i].indexOf("do")?e.lineDashOffset=f.distance(t[i].slice(2)):e.strokeStyle=t[i];s&&((t=f.color(e.strokeStyle))[3]=s,e.strokeStyle="rgba("+t.join(",")+")")}else{if(t.color!==o&&(e.strokeStyle=t.color),t.opacity!==o&&e.strokeStyle){var a=f.color(e.strokeStyle);a[3]=t.opacity,e.strokeStyle="rgba("+a.join(",")+")"}t.width!==o&&(e.lineWidth=f.distance(t.width)),t.join!==o&&(e.lineJoin=t.join),t.cap!==o&&(e.lineCap=t.cap),t.miterLimit!==o&&(e.miterLimit=t.miterLimit),t.dash!==o&&(t.dash in f.dashes?e.lineDash=f.dashes[t.dash]:e.lineDash=t.dash),t.dashOffset!==o&&(e.lineDashOffset=f.distance(t.dashOffset))}},e.processShadow=function(t,e){if(t+""===t){var s=["shadowOffsetX","shadowOffsetY","shadowBlur"];t=t.replace(/\s*\,\s*/g,",").split(" ");for(var i=0;i<t.length;i++)isNaN(+t[i][0])?e.shadowColor=t[i]:e[s.shift()]=f.distance(t[i])}else t.x!==o&&(e.shadowOffsetX=f.distance(t.x)),t.y!==o&&(e.shadowOffsetY=f.distance(t.y)),t.blur!==o&&(e.shadowBlur=f.distance(t.blur||0)),t.color&&(e.shadowColor=t.color)},Object.assign(e.prototype,j.mixins.EventMixin,{eventHooks:{}}),e.browserCommonEvent={init:function(t){this.context&&this.context.eventHooks[t].init.call(this.context,t)},teardown:function(t){this.context&&this.context.eventHooks[t].teardown.call(this.context,t)}},Array.prototype.concat.call(w.mouse,w.touch,w.pointer,w.keyboard).forEach(function(t){e.prototype.eventHooks[t]=e.browserCommonEvent,e.prototype[t]=T.prototype[t]}),e.browserMouseOverOut=function(t){if(this.hoverElement!==t.targetObject){var e=this.hoverElement;this.hoverElement=t.targetObject,e&&e.fire&&e.fire("mouseout",t),t.targetObject&&t.targetObject.fire&&t.targetObject.fire("mouseover",t)}},e.prototype.eventHooks.mouseover=e.prototype.eventHooks.mouseout={init:function(t){this.context&&!this.context.listeners._specialMouseOverOutHook_&&(this.context.listeners._specialMouseOverOutHook_=e.browserMouseOverOut,this.context.on("mousemove",e.browserMouseOverOut))},teardown:function(t){this.context&&(this.context.listeners._specialMouseOverOutHook_=null,this.context.off("mousemove",e.browserMouseOverOut))}},Object.assign(e.prototype,j.mixins.AttrMixin,j.mixins.TransformableMixin,j.mixins.AnimatableMixin,{attrHooks:z.prototype=Object.assign({},j.mixins.TransformableMixin.attrHooks,{z:{get:function(){return this.context.elements.indexOf(this)},set:function(t){var e=this.context.elements;"top"===t&&(t=e.length),e.splice(this.context.elements.indexOf(this),1),e.splice(t,0,this),this.update()}},visible:{set:S},clip:{set:S},fill:{set:function(t){this.styles.fillStyle=t,this.update()}},fillRule:{set:S},stroke:{set:function(t){if(t.constructor===String){for(var e,s,i=(t=t.replace(/\s*\,\s*/g,",").split(" ")).length,r=!1,n=!1;i--;)b.test(t[i])?e=parseFloat(t[i]):A(t[i])?this.styles.lineWidth=f.distance(t[i]):"round"===t[i]?(r||(this.styles.lineJoin="round"),n||(this.styles.lineCap="round")):"miter"===t[i]||"bevel"===t[i]?(r=!0,this.styles.lineJoin=t[i]):"butt"===t[i]||"square"===t[i]?(n=!0,this.styles.lineCap=t[i]):"["===t[i][0]||f.dashes[t[i]]||t[i].lastIndexOf("ml")===t[i].length-2||(t[i].lastIndexOf("do")===t[i].length-2?this.styles.lineDashOffset=f.distance(t[i].slice(0,t[i].length-2)):s=t[i]);s&&(e&&((s=f.color(s))[3]=e,s="rgba("+s.join(",")+")"),this.styles.strokeStyle=s)}}},opacity:{get:function(){return this.attrs.opacity===o?1:this.attrs.opacity},set:function(t){this.styles.globalAlpha=+t,this.update()}},composite:{set:function(t){this.styles.globalCompositeOperation=t,this.update()}}})}),f.Drawable=e,(t=new j(e,{argsOrder:["x","y","width","height","fill","stroke"],attrHooks:new z({x:{set:S},y:{set:S},width:{set:S},height:{set:S},x1:{get:function(){return this.attrs.x},set:function(t){return this.attrs.width+=this.attrs.x-t,this.attrs.x=t,this.update(),null}},y1:{get:function(){return this.attrs.y},set:function(t){return this.attrs.height+=this.attrs.y-t,this.attrs.y=t,this.update(),null}},x2:{get:function(){return this.attrs.x+this.attrs.width},set:function(t){return this.attrs.width=t-this.attrs.x,this.update(),null}},y2:{get:function(){return this.attrs.y+this.attrs.height},set:function(t){return this.attrs.height=t-this.attrs.y,this.update(),null}}}),isPointIn:function(t,e,s){var i=this.isPointInBefore(t,e,s);return t=i[0],e=i[1],t>this.attrs.x&&e>this.attrs.y&&t<this.attrs.x+this.attrs.width&&e<this.attrs.y+this.attrs.height},preciseBounds:function(){return new O(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height)},draw:function(t){this.attrs.visible&&(this.preDraw(t),this.attrs.fill&&t.fillRect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height),this.attrs.stroke&&t.strokeRect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height),t.restore())},processPath:function(t){t.beginPath(),t.rect(this.attrs.x,this.attrs.y,this.attrs.width,this.attrs.height)}})).prototype.attrHooks.x.preAnim=function(t,e){t.startValue=this.attr(t.prop),t.delta=e-t.startValue,e+""===e&&(0===e.indexOf("+=")?t.delta=+e.substr(2):0===e.indexOf("-=")&&(t.delta=-e.substr(2)))},t.prototype.attrHooks.x.anim=function(t){this.attrs[t.prop]=t.startValue+t.delta*t.pos,this.update()},f.rect=function(){return new t(arguments)},f.Rect=t,(s=new j(e,{argsOrder:["cx","cy","radius","fill","stroke"],attrHooks:new z({cx:{set:S},cy:{set:S},radius:{set:S}}),isPointIn:function(t,e,s){s=("mouse"===s?this.attrs.interactionProps:s)||{};var i=this.isPointInBefore(t,e,s);t=i[0],e=i[1];var r=s.stroke?(this.styles.lineWidth||0)/2:0;return Math.pow(t-this.attrs.cx,2)+Math.pow(e-this.attrs.cy,2)<=Math.pow(this.attrs.radius+r,2)},preciseBounds:function(){return new O(this.attrs.cx-this.attrs.radius,this.attrs.cy-this.attrs.radius,2*this.attrs.radius,2*this.attrs.radius)},draw:function(t){this.attrs.visible&&(this.preDraw(t),t.beginPath(),t.arc(this.attrs.cx,this.attrs.cy,Math.abs(this.attrs.radius),0,2*Math.PI,!0),this.postDraw(t))},processPath:function(t){t.beginPath(),t.arc(this.attrs.cx,this.attrs.cy,Math.abs(this.attrs.radius),0,2*Math.PI,!0)}})).prototype.roughBounds=s.prototype.preciseBounds,s.args=["cx","cy","radius","fill","stroke"],f.circle=function(){return new s(arguments)},f.Circle=s,(n=new j({initialize:function(t,e,s){this.method=t,this.path=s,this.attrs={},this.attrs.args=e,n.canvasFunctions[t]&&(this.attrHooks=n.canvasFunctions[t].attrHooks)},attrHooks:R.prototype={args:{set:function(){this.update()}}},attr:j.attr,clone:function(){var t=f.curve(this.method,this.attrs.args);return v(t.attrs,this.attrs),t},startAt:function(){var t=this.path.attrs.d.indexOf(this);return 0===t?[0,0]:this.path.attrs.d[t-1].endAt()},endAt:function(){return n.canvasFunctions[this.method].endAt?n.canvasFunctions[this.method].endAt(this.attrs.args):null},update:function(){return this.path&&this.path.update(),this},bounds:function(t){return n.canvasFunctions[this.method].bounds?(t||(t=this.startAt()),n.canvasFunctions[this.method].bounds(t,this.attrs.args)):null},process:function(t){t[this.method].apply(t,this.attrs.args)}})).AttrHooks=R,n.canvasFunctions={moveTo:{attrHooks:L(["x","y"]),endAt:function(t){return t.slice()}},lineTo:{attrHooks:L(["x","y"]),bounds:function(t,e){return[t[0],t[1],e[0],e[1]]},endAt:function(t){return t.slice()}},quadraticCurveTo:{attrHooks:L(["hx","hy","x","y"]),bounds:function(t,e){return[Math.min(t[0],e[0],e[2]),Math.min(t[1],e[1],e[3]),Math.max(t[0],e[0],e[2]),Math.max(t[1],e[1],e[3])]},endAt:function(t){return t.slice(2)}},bezierCurveTo:{attrHooks:L(["h1x","h1y","h2x","h2y","x","y"]),bounds:function(t,e){return[Math.min(t[0],e[0],e[2],e[4]),Math.min(t[1],e[1],e[3],e[5]),Math.max(t[0],e[0],e[2],e[4]),Math.max(t[1],e[1],e[3],e[5])]},endAt:function(t){return t.slice(4)}},arc:{attrHooks:L(["x","y","radius","start","end","clockwise"]),bounds:function(t,e){var s=e[0],i=e[1],r=e[2];e[3],e[4],e[5];return[s-r,i-r,s+r,i+r]},endAt:function(t){var e=t[0],s=t[1],i=t[2],r=t[4]-t[3];return t[5]&&(r=-r),[e+Math.cos(r)*i,s+Math.sin(r)*i]}},arcTo:{attrHooks:L(["x1","y1","x2","y2","radius","clockwise"])}},n.fromArray=function(t,e){return!0===t?closePath:t[0]in f.curves?f.curve(t[0],t.slice(1),e):new n({2:"lineTo",4:"quadraticCurveTo",6:"bezierCurveTo"}[t.length],t,e)},f.curves={moveTo:n,lineTo:n,quadraticCurveTo:n,bezierCurveTo:n,arc:n,arcTo:n,closePath:n},f.Curve=n,f.curve=function(t,e,s){return new f.curves[t](t,e,s)},(r=new j(e,{initialize:function(t){t[0].constructor!==Object&&t[1].constructor!==Number&&(t[3]=t[1],t[4]=t[2],t[1]=t[2]=o),this.super("initialize",arguments)},argsOrder:["d","x","y","fill","stroke"],attrHooks:new z({d:{set:S},x:{set:S},y:{set:S}}),curve:function(t,e){return e===o?this.attrs.d[t]:(isNaN(e[0])||(e=[e]),e=r.parse(e,this,0!==t),this.attrs.d.splice.apply(this.attrs.d,[t,1].concat(e)),this.update())},curves:function(t){return t===o?this.attrs.d:(this.attrs.d=r.parse(t,this,!0),this.update())},before:function(t,e,s){return 0===t&&!1!==turnToLine&&(this.attrs.d[0].method="lineTo"),isNaN(e[0])||(e=[e]),e=r.parse(e,this,0!==t),this.attrs.d.splice.apply(this.attrs.d,[t,0].concat(e)),this.update()},after:function(t,e){return this.before(t+1,e)},remove:function(t){return t===o?this.super("remove"):(this.attrs.d[t].path=null,this.attrs.d.splice(t,1),this.update())},push:function(t,e){return e?this.attrs.d.push(f.curve(t,e,this)):this.attrs.d=this.attrs.d.concat(r.parse(t,this,0!==this.attrs.d.length)),this.update()},each:function(){return this.attrs.d.forEach.apply(this.attrs.d,arguments),this},map:function(){return this.attrs.d.map.apply(this.attrs.d,arguments)},moveTo:function(t,e){return this.push("moveTo",[t,e])},lineTo:function(t,e){return this.push("lineTo",[t,e])},quadraticCurveTo:function(t,e,s,i){return this.push("quadraticCurveTo",[t,e,s,i])},bezierCurveTo:function(t,e,s,i,r,n){return this.push("bezierCurveTo",[t,e,s,i,r,n])},arcTo:function(t,e,s,i,r,n){return this.push("arcTo",[t,e,s,i,r,!!n])},arc:function(t,e,s,i,r,n){return this.push("arc",[t,e,s,i,r,!!n])},closePath:function(){return this.push("closePath",[])},isPointIn:function(t,e,s){var i=this.isPointInBefore(t,e,s);t=i[0],e=i[1];var r=this.context.context;r.save();var n=this.getTransform();f.isIdentityTransform(n)||r.transform(n[0],n[1],n[2],n[3],n[4],n[5]),(this.attrs.x||this.attrs.y)&&r.translate(this.attrs.x||0,this.attrs.y||0),this.attrs.d.forEach(function(t){t.process(r)});var a=r.isPointInPath(t,e);return r.restore(),a},bounds:function(t,e){for(var s,i=1/0,r=1/0,n=-1/0,a=-1/0,o=[0,0],h=0;h<this.attrs.d.length;h++)s=this.attrs.d[h].bounds(o),o=this.attrs.d[h].endAt()||o,s&&(i=Math.min(i,s[0],s[2]),n=Math.max(n,s[0],s[2]),r=Math.min(r,s[1],s[3]),a=Math.max(a,s[1],s[3]));return this.super("bounds",[[i,r,n-i,a-r],t,e])},process:function(e){e.beginPath(),this.attrs.d.forEach(function(t){t.process(e)})},draw:function(t){}})).args=["d","x","y","fill","stroke"],r.parse=function(t,e,s){if(!t)return[];if(t instanceof n)return t.path=e,[t];t[0]===o||+t[0]!==t[0]&&t[0]+""!==t[0]||(t=[t]);var i=[];if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]instanceof n?(i.push(t[r]),t[r].path=e):0!==r||s?i.push(n.fromArray(t[r],e)):i.push(new n("moveTo",isNaN(t[r][0])?t[r].slice(1):t[r],e));return i},f.path=function(){return new r(arguments)},f.Path=r,(h=new j(e,{initialize:function(t){this.super("initialize",arguments),M(t[0])&&(t=this.processObject(t[0],h.args)),this.attrs.image=h.parse(t[0]),this.attrs.x=t[1],this.attrs.y=t[2],this.attrs.width=t[3]===o?"auto":t[3],this.attrs.height=t[4]===o?"auto":t[4],t[5]&&(this.attrs.crop=t[5]),this.attrs.image.addEventListener("load",function(t){this.update(),this.fire("load",t)}.bind(this)),this.attrs.image.addEventListener("error",function(t){this.fire("error",event)}.bind(this))},attrHooks:new z({image:{set:function(t){return(t=h.parse(t)).complete&&this.update(),t.addEventListener("load",function(t){this.update(),this.fire("load",t)}.bind(this)),t}},x:{set:function(t){this.attrs.x=t,this.update()}},y:{set:function(t){this.attrs.y=t,this.update()}},width:{set:function(t){this.attrs.width=t,this.update()}},height:{set:function(t){this.attrs.height=t,this.update()}},crop:{set:function(t){this.attrs.crop=t,this.update()}},smooth:{get:function(){return this.styles[N(this.context.context)]||this.context.context[N(this.context.context)]},set:function(t){this.styles[N(this.context.context)]=!!t,this.update()}}}),remove:function(){this.super("remove"),this.attrs.image.blob&&x.revokeObjectURL(this.attrs.image.blob)},getRealSize:function(){var t=this.attrs.width,e=this.attrs.height;return"auto"===t&&"auto"===e&&(t=e="native"),"auto"===t?t=this.attrs.image.width*(e/this.attrs.image.height):"native"===t&&(t=this.attrs.image.width),"auto"===e?e=this.attrs.image.height*(t/this.attrs.image.width):"native"===e&&(e=this.attrs.image.height),[t,e]},bounds:function(t,e){var s=this.getRealSize();return this.super("bounds",[[this.attrs.x,this.attrs.y,s[0],s[1]],t,e])},isPointIn:function(t,e){var s=this.isPointInBefore(t,e,options);t=s[0],e=s[1];var i=this.getRealSize();return t>this.attrs.x&&e>this.attrs.y&&t<this.attrs.x+i[0]&&e<this.attrs.y+i[1]},draw:function(t){if(this.attrs.visible&&this.attrs.image.complete){this.context.renderer.pre(t,this.styles,this.matrix,this);this.attrs.image,this.attrs.x,this.attrs.y;var e=this.attrs.width,s=this.attrs.height,i=this.attrs.crop;if("auto"===this.attrs.width||"native"===this.attrs.width||"auto"===this.attrs.height||"native"===this.attrs.height){var r=this.getRealSize();e=r[0],s=r[1]}i?t.drawImage(this.attrs.image,i[0],i[1],i[2],i[3],this.attrs.x,this.attrs.y,e,s):"auto"!==this.attrs.width&&"native"!==this.attrs.width||"auto"!==this.attrs.height&&"native"!==this.attrs.height?t.drawImage(this.attrs.image,this.attrs.x,this.attrs.y,e,s):t.drawImage(this.attrs.image,this.attrs.x,this.attrs.y),t.restore()}}})).args=["image","x","y","width","height","crop"],h.parse=function(t){if(t+""===t){if("#"===t[0])return d.getElementById(t.substr(1));if("<svg"!==t[0]){var e=new Image;return e.src=t,e}var s=new Blob([t],{type:"image/svg+xml;charset=utf-8"});(t=new Image).src=x.createObjectURL(s),t.blob=s}return t},f.image=function(){return new h(arguments)},f.Image=h;(c=new j(e,{argsOrder:["text","x","y","font","fill","stroke"],attrHooks:new z({text:{set:function(t){return this.lines=null,this.update(),t+""}},x:{set:S},y:{set:S},font:{set:function(t){}},align:{get:function(){return this.styles.textAlign||"left"},set:function(t){return this.styles.textAlign=t,this.update(),null}},baseline:{get:function(){return this.styles.textBaseline},set:function(t){return this.styles.textBaseline=t,this.update(),null}},breaklines:{set:function(){this.update()}},lineHeight:{set:function(){this.lines=null,this.update()}},maxStringWidth:{set:function(){this.update()}},blockWidth:{set:function(){this.lines=null,this.update()}}}),lines:null,processLines:function(t){var e=this.attrs.text,n=this.lines=[],a="auto"===this.attrs.lineHeight?this.attrs.font.size:this.attrs.lineHeight,o=this.attrs.blockWidth,h=("center"===this.styles.textAlign||this.styles.textAlign,this.context.renderer);return h.preMeasure(this.styles.font),e.split("\n").forEach(function(t){if(h.measure(t)>o){for(var e,s=t.split(" "),i="",r=0;r<s.length;r++)e=i+s[r]+" ",i=h.measure(e)>o?(n.push({text:i,y:a*n.length}),s[r]+" "):e;n.push({text:i,y:a*n.length})}else n.push({text:t,y:a*n.length})},this),h.postMeasure(),this},draw:function(t){},isPointIn:function(t,e,s){var i=this.isPointInBefore(t,e,s);t=i[0],e=i[1];var r=this.bounds(!1);return t>r.x1&&e>r.y1&&t<r.x2&&e<r.y2},measure:function(){var t;return t=this.attrs.breaklines?(this.lines||this.processLines(this.context.context),this.context.renderer.preMeasure(this.styles.font),this.lines.reduce(function(t,e){return t<(e=this.context.renderer.measure(e.text))?e:t}.bind(this),0)):(this.context.renderer.preMeasure(this.styles.font),this.context.renderer.measure(this.attrs.text)),this.context.renderer.postMeasure(),t},bounds:function(t,e){var s,i=this.attrs.x,r=this.attrs.y,n="auto"===this.attrs.lineHeight?this.attrs.font.size:this.attrs.lineHeight;this.attrs.breaklines?(s=this.attrs.blockWidth,"inline"!==this.attrs.boundsMode&&isFinite(s)||(s=this.measure()),this.lines||this.processLines(),n*=this.lines.length):(s=this.measure(),this.attrs.maxStringWidth<s&&(s=this.attrs.maxStringWidth));var a=this.styles.textBaseline,o=this.styles.textAlign;return"middle"===a?r-=this.attrs.font.size/2:"bottom"===a||"ideographic"===a?r-=this.attrs.font.size:"alphabetic"===a&&(r-=.8*this.attrs.font.size),"center"===o?i-=s/2:"right"===o&&(i-=s),this.super("bounds",[[i,r,s,n],t,e])}})).font="10px sans-serif",c.args=["text","x","y","font","fill","stroke"],c.parseFont=function(t){if(t+""!==t)return t;var e={family:""};return t.split(" ").forEach(function(t){"bold"===t?e.bold=!0:"italic"===t?e.italic=!0:y.test(t)?e.size=f.distance(t):e.family+=" "+t}),e.family=e.family.trim(),e},c.genFont=function(t){var e="";return t.italic&&(e+="italic "),t.bold&&(e+="bold "),e+(t.size||10)+"px "+(t.family||"sans-serif")},f.text=function(){return new c(arguments)},f.Text=c,(u=new j({initialize:function(t,e,s,i,r){if(this.context=r,t+""!==t&&(i=s,s=e,e=t,t="linear"),!u.types[t])throw'Unknown gradient type "'+t+'"';this.type=t,this.attrs={from:s,to:i,colors:u.parseColors(e)},this.binds=[],u.types[this.type]&&(this.attrHooks=v(v({},this.attrHooks),u.types[this.type].attrHooks),u.types[this.type].initialize&&u.types[this.type].initialize.call(this))},attr:j.attr,attrHooks:{colors:{set:function(t){return this.update(),u.parseColors(t)}}},color:function(t,e){if(e!==o)return this.attrs.colors[t]=e,this.update();if(this.attrs.colors[t])return f.color(this.attrs.colors[t]);var s=this.attrs.colors,i=Object.keys(s).sort();if(t<i[0])return f.color(s[i[0]]);if(t>i[i.length-1])return f.color(s[i[i.length-1]]);for(var r=0;r<i.length;r++)if(+i[r]>t){var n=f.color(s[i[r-1]]),a=f.color(s[i[r]]);return t=(t-+i[r-1])/(+i[r]-+i[r-1]),[n[0]+(a[0]-n[0])*t+.5|0,n[1]+(a[1]-n[1])*t+.5|0,n[2]+(a[2]-n[2])*t+.5|0,+(n[3]+(a[3]-n[3])*t).toFixed(2)]}},update:function(){return this.context.update(),this},toCanvasStyle:function(t,e){return u.types[this.type].toCanvasStyle.call(this,t,e)}})).parseColors=function(t){if(!Array.isArray(t))return t;var s={},i=1/(t.length-1);return t.forEach(function(t,e){s[i*e]=t}),s},u.types={linear:{attrHooks:{from:{set:function(t){return this.update(),t}},to:{set:function(t){return this.update(),t}}},toCanvasStyle:function(t,e){return this.context.renderer.makeGradient(this.context,"linear",e.corner(this.attrs.from),e.corner(this.attrs.to),this.attrs.colors)}},radial:{initialize:function(){this.attrs.from&&Array.isArray(this.attrs.from)?(this.attrs.startRadius=this.attrs.from[2]||0,this.attrs.from=this.attrs.from.slice(0,2)):(this.attrs.from||(this.attrs.from="center"),this.attrs.startRadius=0),this.attrs.to&&Array.isArray(this.attrs.to)?(this.attrs.radius=this.attrs.to[2]||"auto",this.attrs.to=this.attrs.to.slice(0,2)):(this.attrs.to||(this.attrs.to=this.attrs.from),this.attrs.radius="auto")},attrHooks:{from:{set:function(t){return Array.isArray(t)&&2<t.length&&(this.attrs.startRadius=t[2],t=t.slice(0,2)),this.update(),t}},to:{set:function(t){return Array.isArray(t)&&2<t.length&&(this.attrs.radius=t[2],t=t.slice(0,2)),this.update(),t}},radius:{set:function(t){return this.update(),t}},startRadius:{set:function(t){return this.update(),t}}},toCanvasStyle:function(t,e){var s=e.corner(this.attrs.from),i=e.corner(this.attrs.to);return this.context.renderer.makeGradient(this.context,"radial",[s[0],s[1],this.attrs.startRadius],[i[0],i[1],"auto"===this.attrs.radius?e.bounds().height:this.attrs.radius],this.attrs.colors)}}},f.Gradient=u,l=new j({initialize:function(t,e,s){this.image=h.parse(t),this.repeat=e,this.context=s,this.image.addEventListener("load",function(t){this.update(),this.image.blob&&x.revokeObjectURL(blob)}.bind(this))},update:function(){return this.context.update(),this},toCanvasStyle:function(t){return this.image.complete?t.createPattern(this.image,this.repeat||"repeat"):"transparent"}}),f.Pattern=l,f.version="1.9.0",f.query=function(t,e,s,i){return t+""===t&&(t=(i||d).querySelectorAll(t)[s||0]),new f.contexts[e||"2d"](t.canvas||t)},f.id=function(t,e){return new f.contexts[e||"2d"](d.getElementById(t))},"object"==typeof module&&"object"==typeof module.exports?module.exports=f:"function"==typeof define&&define.amd?define("Delta",[],function(){return f}):i&&(i.Delta=f)}("undefined"!=typeof window?window:this);